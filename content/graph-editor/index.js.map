{
  "version": 3,
  "sources": ["../../../../node_modules/rbush/rbush.min.js", "../../../../node_modules/preact/src/constants.js", "../../../../node_modules/preact/src/util.js", "../../../../node_modules/preact/src/options.js", "../../../../node_modules/preact/src/create-element.js", "../../../../node_modules/preact/src/component.js", "../../../../node_modules/preact/src/create-context.js", "../../../../node_modules/preact/src/diff/children.js", "../../../../node_modules/preact/src/diff/props.js", "../../../../node_modules/preact/src/diff/index.js", "../../../../node_modules/preact/src/render.js", "../../../../node_modules/preact/src/clone-element.js", "../../../../node_modules/preact/src/diff/catch-error.js", "../../../../node_modules/@calmdownval/intl/src/TranslationError.ts", "../../../../node_modules/@calmdownval/intl/src/utils/placeholder.ts", "../../../../node_modules/@calmdownval/intl/src/utils/validation.ts", "../../../../node_modules/@calmdownval/intl/src/format/select.ts", "../../../../node_modules/@calmdownval/intl/src/format/variable.ts", "../../../../node_modules/@calmdownval/intl/src/parser/ParseError.ts", "../../../../node_modules/@calmdownval/intl/src/parser/parser.ts", "../../../../node_modules/@calmdownval/intl/src/utils/mapping.ts", "../../../../node_modules/@calmdownval/intl/src/DefaultInterpreter.ts", "../../../../node_modules/@calmdownval/intl/src/MappedFormatProvider.ts", "../../../../node_modules/@calmdownval/intl/src/CachedTranslationProvider.ts", "../../../../node_modules/preact/hooks/src/index.js", "../../../../node_modules/@calmdownval/intl-preact/src/IntlProvider.ts", "../../../../node_modules/@calmdownval/intl-preact/src/useIntl.ts", "../../src/components/BoxDecorator/BoxDecorator.tsx", "../../src/utils/style.ts", "../../src/components/FieldSetEditor/useUiValue.ts", "../../src/components/FieldSetEditor/NumberField/decimal.ts", "../../src/components/FieldSetEditor/NumberField/NumberField.tsx", "../../src/shapes.ts", "../../src/components/FieldSetEditor/NodeShapeField/ShapePreview.tsx", "../../src/components/FieldSetEditor/NodeShapeField/NodeShapeField.tsx", "../../src/components/FieldSetEditor/TextField/TextField.tsx", "../../src/components/FieldSetEditor/FieldSet.ts", "../../src/components/FieldSetEditor/FieldSetEditor.tsx", "../../src/components/App/FieldSetTestApp.tsx", "../../../../node_modules/@calmdownval/signal/src/backend/ArrayBackend.js", "../../../../node_modules/@calmdownval/signal/src/backend/SetBackend.js", "../../../../node_modules/@calmdownval/signal/src/dispatcher/asyncDispatcher.ts", "../../../../node_modules/@calmdownval/signal/src/methods.ts", "../../../../node_modules/@calmdownval/signal/src/dispatcher/syncDispatcher.ts", "../../src/utils/math.ts", "../../src/components/EditorView/gestures/PressGesture.ts", "../../src/components/EditorView/gestures/DragGesture.ts", "../../src/components/EditorView/gestures/PanAndZoomGesture.ts", "../../src/components/EditorView/EditorView.tsx", "../../src/utils/quicksort.ts", "../../src/components/GraphEditor/Transitions.ts", "../../src/components/GraphEditor/operations/endMove/CachedGridAccessor.ts", "../../src/components/GraphEditor/operations/endMove/endMove.ts", "../../src/components/GraphEditor/constants.ts", "../../src/components/GraphEditor/renderer/AutoBuffer.ts", "../../src/components/GraphEditor/renderer/utils.ts", "../../src/components/GraphEditor/renderer/edge/EdgeRenderer.ts", "../../src/components/GraphEditor/renderer/grid/GridRenderer.ts", "../../src/components/GraphEditor/renderer/node/ShapeTextureRenderer.ts", "../../src/components/GraphEditor/renderer/node/NodeRenderer.ts", "../../src/components/GraphEditor/renderer/selection/SelectionRenderer.ts", "../../src/components/GraphEditor/renderer/GLRenderer.ts", "../../src/components/GraphEditor/GraphEditor.tsx", "../../src/state/IncrementingIdentityProvider.ts", "../../src/utils/array.ts", "../../src/state/GraphEdgeRTree.ts", "../../src/state/PointRTree.ts", "../../src/state/GraphBase.ts", "../../src/state/OrientedGraph.ts", "../../src/components/App/GraphTestApp.tsx", "../../src/index.tsx"],
  "sourcesContent": ["!function(t,i){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=i():\"function\"==typeof define&&define.amd?define(i):(t=t||self).RBush=i()}(this,function(){\"use strict\";function t(t,r,e,a,h){!function t(n,r,e,a,h){for(;a>e;){if(a-e>600){var o=a-e+1,s=r-e+1,l=Math.log(o),f=.5*Math.exp(2*l/3),u=.5*Math.sqrt(l*f*(o-f)/o)*(s-o/2<0?-1:1),m=Math.max(e,Math.floor(r-s*f/o+u)),c=Math.min(a,Math.floor(r+(o-s)*f/o+u));t(n,r,m,c,h)}var p=n[r],d=e,x=a;for(i(n,e,r),h(n[a],p)>0&&i(n,e,a);d<x;){for(i(n,d,x),d++,x--;h(n[d],p)<0;)d++;for(;h(n[x],p)>0;)x--}0===h(n[e],p)?i(n,e,x):i(n,++x,a),x<=r&&(e=x+1),r<=x&&(a=x-1)}}(t,r,e||0,a||t.length-1,h||n)}function i(t,i,n){var r=t[i];t[i]=t[n],t[n]=r}function n(t,i){return t<i?-1:t>i?1:0}var r=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function e(t,i,n){if(!n)return i.indexOf(t);for(var r=0;r<i.length;r++)if(n(t,i[r]))return r;return-1}function a(t,i){h(t,0,t.children.length,i,t)}function h(t,i,n,r,e){e||(e=p(null)),e.minX=1/0,e.minY=1/0,e.maxX=-1/0,e.maxY=-1/0;for(var a=i;a<n;a++){var h=t.children[a];o(e,t.leaf?r(h):h)}return e}function o(t,i){return t.minX=Math.min(t.minX,i.minX),t.minY=Math.min(t.minY,i.minY),t.maxX=Math.max(t.maxX,i.maxX),t.maxY=Math.max(t.maxY,i.maxY),t}function s(t,i){return t.minX-i.minX}function l(t,i){return t.minY-i.minY}function f(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function u(t){return t.maxX-t.minX+(t.maxY-t.minY)}function m(t,i){return t.minX<=i.minX&&t.minY<=i.minY&&i.maxX<=t.maxX&&i.maxY<=t.maxY}function c(t,i){return i.minX<=t.maxX&&i.minY<=t.maxY&&i.maxX>=t.minX&&i.maxY>=t.minY}function p(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function d(i,n,r,e,a){for(var h=[n,r];h.length;)if(!((r=h.pop())-(n=h.pop())<=e)){var o=n+Math.ceil((r-n)/e/2)*e;t(i,o,n,r,a),h.push(n,o,o,r)}}return r.prototype.all=function(){return this._all(this.data,[])},r.prototype.search=function(t){var i=this.data,n=[];if(!c(t,i))return n;for(var r=this.toBBox,e=[];i;){for(var a=0;a<i.children.length;a++){var h=i.children[a],o=i.leaf?r(h):h;c(t,o)&&(i.leaf?n.push(h):m(t,o)?this._all(h,n):e.push(h))}i=e.pop()}return n},r.prototype.collides=function(t){var i=this.data;if(!c(t,i))return!1;for(var n=[];i;){for(var r=0;r<i.children.length;r++){var e=i.children[r],a=i.leaf?this.toBBox(e):e;if(c(t,a)){if(i.leaf||m(t,a))return!0;n.push(e)}}i=n.pop()}return!1},r.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var i=0;i<t.length;i++)this.insert(t[i]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},r.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},r.prototype.clear=function(){return this.data=p([]),this},r.prototype.remove=function(t,i){if(!t)return this;for(var n,r,a,h=this.data,o=this.toBBox(t),s=[],l=[];h||s.length;){if(h||(h=s.pop(),r=s[s.length-1],n=l.pop(),a=!0),h.leaf){var f=e(t,h.children,i);if(-1!==f)return h.children.splice(f,1),s.push(h),this._condense(s),this}a||h.leaf||!m(h,o)?r?(n++,h=r.children[n],a=!1):h=null:(s.push(h),l.push(n),n=0,r=h,h=h.children[0])}return this},r.prototype.toBBox=function(t){return t},r.prototype.compareMinX=function(t,i){return t.minX-i.minX},r.prototype.compareMinY=function(t,i){return t.minY-i.minY},r.prototype.toJSON=function(){return this.data},r.prototype.fromJSON=function(t){return this.data=t,this},r.prototype._all=function(t,i){for(var n=[];t;)t.leaf?i.push.apply(i,t.children):n.push.apply(n,t.children),t=n.pop();return i},r.prototype._build=function(t,i,n,r){var e,h=n-i+1,o=this._maxEntries;if(h<=o)return a(e=p(t.slice(i,n+1)),this.toBBox),e;r||(r=Math.ceil(Math.log(h)/Math.log(o)),o=Math.ceil(h/Math.pow(o,r-1))),(e=p([])).leaf=!1,e.height=r;var s=Math.ceil(h/o),l=s*Math.ceil(Math.sqrt(o));d(t,i,n,l,this.compareMinX);for(var f=i;f<=n;f+=l){var u=Math.min(f+l-1,n);d(t,f,u,s,this.compareMinY);for(var m=f;m<=u;m+=s){var c=Math.min(m+s-1,u);e.children.push(this._build(t,m,c,r-1))}}return a(e,this.toBBox),e},r.prototype._chooseSubtree=function(t,i,n,r){for(;r.push(i),!i.leaf&&r.length-1!==n;){for(var e=1/0,a=1/0,h=void 0,o=0;o<i.children.length;o++){var s=i.children[o],l=f(s),u=(m=t,c=s,(Math.max(c.maxX,m.maxX)-Math.min(c.minX,m.minX))*(Math.max(c.maxY,m.maxY)-Math.min(c.minY,m.minY))-l);u<a?(a=u,e=l<e?l:e,h=s):u===a&&l<e&&(e=l,h=s)}i=h||i.children[0]}var m,c;return i},r.prototype._insert=function(t,i,n){var r=n?t:this.toBBox(t),e=[],a=this._chooseSubtree(r,this.data,i,e);for(a.children.push(t),o(a,r);i>=0&&e[i].children.length>this._maxEntries;)this._split(e,i),i--;this._adjustParentBBoxes(r,e,i)},r.prototype._split=function(t,i){var n=t[i],r=n.children.length,e=this._minEntries;this._chooseSplitAxis(n,e,r);var h=this._chooseSplitIndex(n,e,r),o=p(n.children.splice(h,n.children.length-h));o.height=n.height,o.leaf=n.leaf,a(n,this.toBBox),a(o,this.toBBox),i?t[i-1].children.push(o):this._splitRoot(n,o)},r.prototype._splitRoot=function(t,i){this.data=p([t,i]),this.data.height=t.height+1,this.data.leaf=!1,a(this.data,this.toBBox)},r.prototype._chooseSplitIndex=function(t,i,n){for(var r,e,a,o,s,l,u,m=1/0,c=1/0,p=i;p<=n-i;p++){var d=h(t,0,p,this.toBBox),x=h(t,p,n,this.toBBox),v=(e=d,a=x,o=void 0,s=void 0,l=void 0,u=void 0,o=Math.max(e.minX,a.minX),s=Math.max(e.minY,a.minY),l=Math.min(e.maxX,a.maxX),u=Math.min(e.maxY,a.maxY),Math.max(0,l-o)*Math.max(0,u-s)),M=f(d)+f(x);v<m?(m=v,r=p,c=M<c?M:c):v===m&&M<c&&(c=M,r=p)}return r||n-i},r.prototype._chooseSplitAxis=function(t,i,n){var r=t.leaf?this.compareMinX:s,e=t.leaf?this.compareMinY:l;this._allDistMargin(t,i,n,r)<this._allDistMargin(t,i,n,e)&&t.children.sort(r)},r.prototype._allDistMargin=function(t,i,n,r){t.children.sort(r);for(var e=this.toBBox,a=h(t,0,i,e),s=h(t,n-i,n,e),l=u(a)+u(s),f=i;f<n-i;f++){var m=t.children[f];o(a,t.leaf?e(m):m),l+=u(a)}for(var c=n-i-1;c>=i;c--){var p=t.children[c];o(s,t.leaf?e(p):p),l+=u(s)}return l},r.prototype._adjustParentBBoxes=function(t,i,n){for(var r=n;r>=0;r--)o(i[r],t)},r.prototype._condense=function(t){for(var i=t.length-1,n=void 0;i>=0;i--)0===t[i].children.length?i>0?(n=t[i-1].children).splice(n.indexOf(t[i]),1):this.clear():a(t[i],this.toBBox)},r});\n", "export const EMPTY_OBJ = {};\nexport const EMPTY_ARR = [];\nexport const IS_NON_DIMENSIONAL = /acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;\n", "import { EMPTY_ARR } from \"./constants\";\n\n/**\n * Assign properties from `props` to `obj`\n * @template O, P The obj and props types\n * @param {O} obj The object to copy properties to\n * @param {P} props The object to copy properties from\n * @returns {O & P}\n */\nexport function assign(obj, props) {\n\t// @ts-ignore We change the type of `obj` to be `O & P`\n\tfor (let i in props) obj[i] = props[i];\n\treturn /** @type {O & P} */ (obj);\n}\n\n/**\n * Remove a child node from its parent if attached. This is a workaround for\n * IE11 which doesn't support `Element.prototype.remove()`. Using this function\n * is smaller than including a dedicated polyfill.\n * @param {Node} node The node to remove\n */\nexport function removeNode(node) {\n\tlet parentNode = node.parentNode;\n\tif (parentNode) parentNode.removeChild(node);\n}\n\nexport const slice = EMPTY_ARR.slice;\n", "import { _catchError } from './diff/catch-error';\n\n/**\n * The `option` object can potentially contain callback functions\n * that are called during various stages of our renderer. This is the\n * foundation on which all our addons like `preact/debug`, `preact/compat`,\n * and `preact/hooks` are based on. See the `Options` type in `internal.d.ts`\n * for a full list of available option hooks (most editors/IDEs allow you to\n * ctrl+click or cmd+click on mac the type definition below).\n * @type {import('./internal').Options}\n */\nconst options = {\n\t_catchError\n};\n\nexport default options;\n", "import { slice } from './util';\nimport options from './options';\n\nlet vnodeId = 0;\n\n/**\n * Create an virtual node (used for JSX)\n * @param {import('./internal').VNode[\"type\"]} type The node name or Component\n * constructor for this virtual node\n * @param {object | null | undefined} [props] The properties of the virtual node\n * @param {Array<import('.').ComponentChildren>} [children] The children of the virtual node\n * @returns {import('./internal').VNode}\n */\nexport function createElement(type, props, children) {\n\tlet normalizedProps = {},\n\t\tkey,\n\t\tref,\n\t\ti;\n\tfor (i in props) {\n\t\tif (i == 'key') key = props[i];\n\t\telse if (i == 'ref') ref = props[i];\n\t\telse normalizedProps[i] = props[i];\n\t}\n\n\tif (arguments.length > 2) {\n\t\tnormalizedProps.children =\n\t\t\targuments.length > 3 ? slice.call(arguments, 2) : children;\n\t}\n\n\t// If a Component VNode, check for and apply defaultProps\n\t// Note: type may be undefined in development, must never error here.\n\tif (typeof type == 'function' && type.defaultProps != null) {\n\t\tfor (i in type.defaultProps) {\n\t\t\tif (normalizedProps[i] === undefined) {\n\t\t\t\tnormalizedProps[i] = type.defaultProps[i];\n\t\t\t}\n\t\t}\n\t}\n\n\treturn createVNode(type, normalizedProps, key, ref, null);\n}\n\n/**\n * Create a VNode (used internally by Preact)\n * @param {import('./internal').VNode[\"type\"]} type The node name or Component\n * Constructor for this virtual node\n * @param {object | string | number | null} props The properties of this virtual node.\n * If this virtual node represents a text node, this is the text of the node (string or number).\n * @param {string | number | null} key The key for this virtual node, used when\n * diffing it against its children\n * @param {import('./internal').VNode[\"ref\"]} ref The ref property that will\n * receive a reference to its created child\n * @returns {import('./internal').VNode}\n */\nexport function createVNode(type, props, key, ref, original) {\n\t// V8 seems to be better at detecting type shapes if the object is allocated from the same call site\n\t// Do not inline into createElement and coerceToVNode!\n\tconst vnode = {\n\t\ttype,\n\t\tprops,\n\t\tkey,\n\t\tref,\n\t\t_children: null,\n\t\t_parent: null,\n\t\t_depth: 0,\n\t\t_dom: null,\n\t\t// _nextDom must be initialized to undefined b/c it will eventually\n\t\t// be set to dom.nextSibling which can return `null` and it is important\n\t\t// to be able to distinguish between an uninitialized _nextDom and\n\t\t// a _nextDom that has been set to `null`\n\t\t_nextDom: undefined,\n\t\t_component: null,\n\t\t_hydrating: null,\n\t\tconstructor: undefined,\n\t\t_original: original == null ? ++vnodeId : original\n\t};\n\n\t// Only invoke the vnode hook if this was *not* a direct copy:\n\tif (original == null && options.vnode != null) options.vnode(vnode);\n\n\treturn vnode;\n}\n\nexport function createRef() {\n\treturn { current: null };\n}\n\nexport function Fragment(props) {\n\treturn props.children;\n}\n\n/**\n * Check if a the argument is a valid Preact VNode.\n * @param {*} vnode\n * @returns {vnode is import('./internal').VNode}\n */\nexport const isValidElement = vnode =>\n\tvnode != null && vnode.constructor === undefined;\n", "import { assign } from './util';\nimport { diff, commitRoot } from './diff/index';\nimport options from './options';\nimport { Fragment } from './create-element';\n\n/**\n * Base Component class. Provides `setState()` and `forceUpdate()`, which\n * trigger rendering\n * @param {object} props The initial component props\n * @param {object} context The initial context from parent components'\n * getChildContext\n */\nexport function Component(props, context) {\n\tthis.props = props;\n\tthis.context = context;\n}\n\n/**\n * Update component state and schedule a re-render.\n * @this {import('./internal').Component}\n * @param {object | ((s: object, p: object) => object)} update A hash of state\n * properties to update with new values or a function that given the current\n * state and props returns a new partial state\n * @param {() => void} [callback] A function to be called once component state is\n * updated\n */\nComponent.prototype.setState = function(update, callback) {\n\t// only clone state when copying to nextState the first time.\n\tlet s;\n\tif (this._nextState != null && this._nextState !== this.state) {\n\t\ts = this._nextState;\n\t} else {\n\t\ts = this._nextState = assign({}, this.state);\n\t}\n\n\tif (typeof update == 'function') {\n\t\t// Some libraries like `immer` mark the current state as readonly,\n\t\t// preventing us from mutating it, so we need to clone it. See #2716\n\t\tupdate = update(assign({}, s), this.props);\n\t}\n\n\tif (update) {\n\t\tassign(s, update);\n\t}\n\n\t// Skip update if updater function returned null\n\tif (update == null) return;\n\n\tif (this._vnode) {\n\t\tif (callback) this._renderCallbacks.push(callback);\n\t\tenqueueRender(this);\n\t}\n};\n\n/**\n * Immediately perform a synchronous re-render of the component\n * @this {import('./internal').Component}\n * @param {() => void} [callback] A function to be called after component is\n * re-rendered\n */\nComponent.prototype.forceUpdate = function(callback) {\n\tif (this._vnode) {\n\t\t// Set render mode so that we can differentiate where the render request\n\t\t// is coming from. We need this because forceUpdate should never call\n\t\t// shouldComponentUpdate\n\t\tthis._force = true;\n\t\tif (callback) this._renderCallbacks.push(callback);\n\t\tenqueueRender(this);\n\t}\n};\n\n/**\n * Accepts `props` and `state`, and returns a new Virtual DOM tree to build.\n * Virtual DOM is generally constructed via [JSX](http://jasonformat.com/wtf-is-jsx).\n * @param {object} props Props (eg: JSX attributes) received from parent\n * element/component\n * @param {object} state The component's current state\n * @param {object} context Context object, as returned by the nearest\n * ancestor's `getChildContext()`\n * @returns {import('./index').ComponentChildren | void}\n */\nComponent.prototype.render = Fragment;\n\n/**\n * @param {import('./internal').VNode} vnode\n * @param {number | null} [childIndex]\n */\nexport function getDomSibling(vnode, childIndex) {\n\tif (childIndex == null) {\n\t\t// Use childIndex==null as a signal to resume the search from the vnode's sibling\n\t\treturn vnode._parent\n\t\t\t? getDomSibling(vnode._parent, vnode._parent._children.indexOf(vnode) + 1)\n\t\t\t: null;\n\t}\n\n\tlet sibling;\n\tfor (; childIndex < vnode._children.length; childIndex++) {\n\t\tsibling = vnode._children[childIndex];\n\n\t\tif (sibling != null && sibling._dom != null) {\n\t\t\t// Since updateParentDomPointers keeps _dom pointer correct,\n\t\t\t// we can rely on _dom to tell us if this subtree contains a\n\t\t\t// rendered DOM node, and what the first rendered DOM node is\n\t\t\treturn sibling._dom;\n\t\t}\n\t}\n\n\t// If we get here, we have not found a DOM node in this vnode's children.\n\t// We must resume from this vnode's sibling (in it's parent _children array)\n\t// Only climb up and search the parent if we aren't searching through a DOM\n\t// VNode (meaning we reached the DOM parent of the original vnode that began\n\t// the search)\n\treturn typeof vnode.type == 'function' ? getDomSibling(vnode) : null;\n}\n\n/**\n * Trigger in-place re-rendering of a component.\n * @param {import('./internal').Component} component The component to rerender\n */\nfunction renderComponent(component) {\n\tlet vnode = component._vnode,\n\t\toldDom = vnode._dom,\n\t\tparentDom = component._parentDom;\n\n\tif (parentDom) {\n\t\tlet commitQueue = [];\n\t\tconst oldVNode = assign({}, vnode);\n\t\toldVNode._original = vnode._original + 1;\n\n\t\tdiff(\n\t\t\tparentDom,\n\t\t\tvnode,\n\t\t\toldVNode,\n\t\t\tcomponent._globalContext,\n\t\t\tparentDom.ownerSVGElement !== undefined,\n\t\t\tvnode._hydrating != null ? [oldDom] : null,\n\t\t\tcommitQueue,\n\t\t\toldDom == null ? getDomSibling(vnode) : oldDom,\n\t\t\tvnode._hydrating\n\t\t);\n\t\tcommitRoot(commitQueue, vnode);\n\n\t\tif (vnode._dom != oldDom) {\n\t\t\tupdateParentDomPointers(vnode);\n\t\t}\n\t}\n}\n\n/**\n * @param {import('./internal').VNode} vnode\n */\nfunction updateParentDomPointers(vnode) {\n\tif ((vnode = vnode._parent) != null && vnode._component != null) {\n\t\tvnode._dom = vnode._component.base = null;\n\t\tfor (let i = 0; i < vnode._children.length; i++) {\n\t\t\tlet child = vnode._children[i];\n\t\t\tif (child != null && child._dom != null) {\n\t\t\t\tvnode._dom = vnode._component.base = child._dom;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn updateParentDomPointers(vnode);\n\t}\n}\n\n/**\n * The render queue\n * @type {Array<import('./internal').Component>}\n */\nlet rerenderQueue = [];\n\n/**\n * Asynchronously schedule a callback\n * @type {(cb: () => void) => void}\n */\n/* istanbul ignore next */\n// Note the following line isn't tree-shaken by rollup cuz of rollup/rollup#2566\nconst defer =\n\ttypeof Promise == 'function'\n\t\t? Promise.prototype.then.bind(Promise.resolve())\n\t\t: setTimeout;\n\n/*\n * The value of `Component.debounce` must asynchronously invoke the passed in callback. It is\n * important that contributors to Preact can consistently reason about what calls to `setState`, etc.\n * do, and when their effects will be applied. See the links below for some further reading on designing\n * asynchronous APIs.\n * * [Designing APIs for Asynchrony](https://blog.izs.me/2013/08/designing-apis-for-asynchrony)\n * * [Callbacks synchronous and asynchronous](https://blog.ometer.com/2011/07/24/callbacks-synchronous-and-asynchronous/)\n */\n\nlet prevDebounce;\n\n/**\n * Enqueue a rerender of a component\n * @param {import('./internal').Component} c The component to rerender\n */\nexport function enqueueRender(c) {\n\tif (\n\t\t(!c._dirty &&\n\t\t\t(c._dirty = true) &&\n\t\t\trerenderQueue.push(c) &&\n\t\t\t!process._rerenderCount++) ||\n\t\tprevDebounce !== options.debounceRendering\n\t) {\n\t\tprevDebounce = options.debounceRendering;\n\t\t(prevDebounce || defer)(process);\n\t}\n}\n\n/** Flush the render queue by rerendering all queued components */\nfunction process() {\n\tlet queue;\n\twhile ((process._rerenderCount = rerenderQueue.length)) {\n\t\tqueue = rerenderQueue.sort((a, b) => a._vnode._depth - b._vnode._depth);\n\t\trerenderQueue = [];\n\t\t// Don't update `renderCount` yet. Keep its value non-zero to prevent unnecessary\n\t\t// process() calls from getting scheduled while `queue` is still being consumed.\n\t\tqueue.some(c => {\n\t\t\tif (c._dirty) renderComponent(c);\n\t\t});\n\t}\n}\nprocess._rerenderCount = 0;\n", "import { enqueueRender } from './component';\n\nexport let i = 0;\n\nexport function createContext(defaultValue, contextId) {\n\tcontextId = '__cC' + i++;\n\n\tconst context = {\n\t\t_id: contextId,\n\t\t_defaultValue: defaultValue,\n\t\t/** @type {import('./internal').FunctionComponent} */\n\t\tConsumer(props, contextValue) {\n\t\t\t// return props.children(\n\t\t\t// \tcontext[contextId] ? context[contextId].props.value : defaultValue\n\t\t\t// );\n\t\t\treturn props.children(contextValue);\n\t\t},\n\t\t/** @type {import('./internal').FunctionComponent} */\n\t\tProvider(props) {\n\t\t\tif (!this.getChildContext) {\n\t\t\t\tlet subs = [];\n\t\t\t\tlet ctx = {};\n\t\t\t\tctx[contextId] = this;\n\n\t\t\t\tthis.getChildContext = () => ctx;\n\n\t\t\t\tthis.shouldComponentUpdate = function(_props) {\n\t\t\t\t\tif (this.props.value !== _props.value) {\n\t\t\t\t\t\t// I think the forced value propagation here was only needed when `options.debounceRendering` was being bypassed:\n\t\t\t\t\t\t// https://github.com/preactjs/preact/commit/4d339fb803bea09e9f198abf38ca1bf8ea4b7771#diff-54682ce380935a717e41b8bfc54737f6R358\n\t\t\t\t\t\t// In those cases though, even with the value corrected, we're double-rendering all nodes.\n\t\t\t\t\t\t// It might be better to just tell folks not to use force-sync mode.\n\t\t\t\t\t\t// Currently, using `useContext()` in a class component will overwrite its `this.context` value.\n\t\t\t\t\t\t// subs.some(c => {\n\t\t\t\t\t\t// \tc.context = _props.value;\n\t\t\t\t\t\t// \tenqueueRender(c);\n\t\t\t\t\t\t// });\n\n\t\t\t\t\t\t// subs.some(c => {\n\t\t\t\t\t\t// \tc.context[contextId] = _props.value;\n\t\t\t\t\t\t// \tenqueueRender(c);\n\t\t\t\t\t\t// });\n\t\t\t\t\t\tsubs.some(enqueueRender);\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tthis.sub = c => {\n\t\t\t\t\tsubs.push(c);\n\t\t\t\t\tlet old = c.componentWillUnmount;\n\t\t\t\t\tc.componentWillUnmount = () => {\n\t\t\t\t\t\tsubs.splice(subs.indexOf(c), 1);\n\t\t\t\t\t\tif (old) old.call(c);\n\t\t\t\t\t};\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn props.children;\n\t\t}\n\t};\n\n\t// Devtools needs access to the context object when it\n\t// encounters a Provider. This is necessary to support\n\t// setting `displayName` on the context object instead\n\t// of on the component itself. See:\n\t// https://reactjs.org/docs/context.html#contextdisplayname\n\n\treturn (context.Provider._contextRef = context.Consumer.contextType = context);\n}\n", "import { diff, unmount, applyRef } from './index';\nimport { createVNode, Fragment } from '../create-element';\nimport { EMPTY_OBJ, EMPTY_ARR } from '../constants';\nimport { getDomSibling } from '../component';\n\n/**\n * Diff the children of a virtual node\n * @param {import('../internal').PreactElement} parentDom The DOM element whose\n * children are being diffed\n * @param {import('../internal').ComponentChildren[]} renderResult\n * @param {import('../internal').VNode} newParentVNode The new virtual\n * node whose children should be diff'ed against oldParentVNode\n * @param {import('../internal').VNode} oldParentVNode The old virtual\n * node whose children should be diff'ed against newParentVNode\n * @param {object} globalContext The current context object - modified by getChildContext\n * @param {boolean} isSvg Whether or not this DOM node is an SVG node\n * @param {Array<import('../internal').PreactElement>} excessDomChildren\n * @param {Array<import('../internal').Component>} commitQueue List of components\n * which have callbacks to invoke in commitRoot\n * @param {import('../internal').PreactElement} oldDom The current attached DOM\n * element any new dom elements should be placed around. Likely `null` on first\n * render (except when hydrating). Can be a sibling DOM element when diffing\n * Fragments that have siblings. In most cases, it starts out as `oldChildren[0]._dom`.\n * @param {boolean} isHydrating Whether or not we are in hydration\n */\nexport function diffChildren(\n\tparentDom,\n\trenderResult,\n\tnewParentVNode,\n\toldParentVNode,\n\tglobalContext,\n\tisSvg,\n\texcessDomChildren,\n\tcommitQueue,\n\toldDom,\n\tisHydrating\n) {\n\tlet i, j, oldVNode, childVNode, newDom, firstChildDom, refs;\n\n\t// This is a compression of oldParentVNode!=null && oldParentVNode != EMPTY_OBJ && oldParentVNode._children || EMPTY_ARR\n\t// as EMPTY_OBJ._children should be `undefined`.\n\tlet oldChildren = (oldParentVNode && oldParentVNode._children) || EMPTY_ARR;\n\n\tlet oldChildrenLength = oldChildren.length;\n\n\tnewParentVNode._children = [];\n\tfor (i = 0; i < renderResult.length; i++) {\n\t\tchildVNode = renderResult[i];\n\n\t\tif (childVNode == null || typeof childVNode == 'boolean') {\n\t\t\tchildVNode = newParentVNode._children[i] = null;\n\t\t}\n\t\t// If this newVNode is being reused (e.g. <div>{reuse}{reuse}</div>) in the same diff,\n\t\t// or we are rendering a component (e.g. setState) copy the oldVNodes so it can have\n\t\t// it's own DOM & etc. pointers\n\t\telse if (\n\t\t\ttypeof childVNode == 'string' ||\n\t\t\ttypeof childVNode == 'number' ||\n\t\t\t// eslint-disable-next-line valid-typeof\n\t\t\ttypeof childVNode == 'bigint'\n\t\t) {\n\t\t\tchildVNode = newParentVNode._children[i] = createVNode(\n\t\t\t\tnull,\n\t\t\t\tchildVNode,\n\t\t\t\tnull,\n\t\t\t\tnull,\n\t\t\t\tchildVNode\n\t\t\t);\n\t\t} else if (Array.isArray(childVNode)) {\n\t\t\tchildVNode = newParentVNode._children[i] = createVNode(\n\t\t\t\tFragment,\n\t\t\t\t{ children: childVNode },\n\t\t\t\tnull,\n\t\t\t\tnull,\n\t\t\t\tnull\n\t\t\t);\n\t\t} else if (childVNode._depth > 0) {\n\t\t\t// VNode is already in use, clone it. This can happen in the following\n\t\t\t// scenario:\n\t\t\t//   const reuse = <div />\n\t\t\t//   <div>{reuse}<span />{reuse}</div>\n\t\t\tchildVNode = newParentVNode._children[i] = createVNode(\n\t\t\t\tchildVNode.type,\n\t\t\t\tchildVNode.props,\n\t\t\t\tchildVNode.key,\n\t\t\t\tnull,\n\t\t\t\tchildVNode._original\n\t\t\t);\n\t\t} else {\n\t\t\tchildVNode = newParentVNode._children[i] = childVNode;\n\t\t}\n\n\t\t// Terser removes the `continue` here and wraps the loop body\n\t\t// in a `if (childVNode) { ... } condition\n\t\tif (childVNode == null) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tchildVNode._parent = newParentVNode;\n\t\tchildVNode._depth = newParentVNode._depth + 1;\n\n\t\t// Check if we find a corresponding element in oldChildren.\n\t\t// If found, delete the array item by setting to `undefined`.\n\t\t// We use `undefined`, as `null` is reserved for empty placeholders\n\t\t// (holes).\n\t\toldVNode = oldChildren[i];\n\n\t\tif (\n\t\t\toldVNode === null ||\n\t\t\t(oldVNode &&\n\t\t\t\tchildVNode.key == oldVNode.key &&\n\t\t\t\tchildVNode.type === oldVNode.type)\n\t\t) {\n\t\t\toldChildren[i] = undefined;\n\t\t} else {\n\t\t\t// Either oldVNode === undefined or oldChildrenLength > 0,\n\t\t\t// so after this loop oldVNode == null or oldVNode is a valid value.\n\t\t\tfor (j = 0; j < oldChildrenLength; j++) {\n\t\t\t\toldVNode = oldChildren[j];\n\t\t\t\t// If childVNode is unkeyed, we only match similarly unkeyed nodes, otherwise we match by key.\n\t\t\t\t// We always match by type (in either case).\n\t\t\t\tif (\n\t\t\t\t\toldVNode &&\n\t\t\t\t\tchildVNode.key == oldVNode.key &&\n\t\t\t\t\tchildVNode.type === oldVNode.type\n\t\t\t\t) {\n\t\t\t\t\toldChildren[j] = undefined;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\toldVNode = null;\n\t\t\t}\n\t\t}\n\n\t\toldVNode = oldVNode || EMPTY_OBJ;\n\n\t\t// Morph the old element into the new one, but don't append it to the dom yet\n\t\tdiff(\n\t\t\tparentDom,\n\t\t\tchildVNode,\n\t\t\toldVNode,\n\t\t\tglobalContext,\n\t\t\tisSvg,\n\t\t\texcessDomChildren,\n\t\t\tcommitQueue,\n\t\t\toldDom,\n\t\t\tisHydrating\n\t\t);\n\n\t\tnewDom = childVNode._dom;\n\n\t\tif ((j = childVNode.ref) && oldVNode.ref != j) {\n\t\t\tif (!refs) refs = [];\n\t\t\tif (oldVNode.ref) refs.push(oldVNode.ref, null, childVNode);\n\t\t\trefs.push(j, childVNode._component || newDom, childVNode);\n\t\t}\n\n\t\tif (newDom != null) {\n\t\t\tif (firstChildDom == null) {\n\t\t\t\tfirstChildDom = newDom;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\ttypeof childVNode.type == 'function' &&\n\t\t\t\tchildVNode._children === oldVNode._children\n\t\t\t) {\n\t\t\t\tchildVNode._nextDom = oldDom = reorderChildren(\n\t\t\t\t\tchildVNode,\n\t\t\t\t\toldDom,\n\t\t\t\t\tparentDom\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\toldDom = placeChild(\n\t\t\t\t\tparentDom,\n\t\t\t\t\tchildVNode,\n\t\t\t\t\toldVNode,\n\t\t\t\t\toldChildren,\n\t\t\t\t\tnewDom,\n\t\t\t\t\toldDom\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif (typeof newParentVNode.type == 'function') {\n\t\t\t\t// Because the newParentVNode is Fragment-like, we need to set it's\n\t\t\t\t// _nextDom property to the nextSibling of its last child DOM node.\n\t\t\t\t//\n\t\t\t\t// `oldDom` contains the correct value here because if the last child\n\t\t\t\t// is a Fragment-like, then oldDom has already been set to that child's _nextDom.\n\t\t\t\t// If the last child is a DOM VNode, then oldDom will be set to that DOM\n\t\t\t\t// node's nextSibling.\n\t\t\t\tnewParentVNode._nextDom = oldDom;\n\t\t\t}\n\t\t} else if (\n\t\t\toldDom &&\n\t\t\toldVNode._dom == oldDom &&\n\t\t\toldDom.parentNode != parentDom\n\t\t) {\n\t\t\t// The above condition is to handle null placeholders. See test in placeholder.test.js:\n\t\t\t// `efficiently replace null placeholders in parent rerenders`\n\t\t\toldDom = getDomSibling(oldVNode);\n\t\t}\n\t}\n\n\tnewParentVNode._dom = firstChildDom;\n\n\t// Remove remaining oldChildren if there are any.\n\tfor (i = oldChildrenLength; i--; ) {\n\t\tif (oldChildren[i] != null) {\n\t\t\tif (\n\t\t\t\ttypeof newParentVNode.type == 'function' &&\n\t\t\t\toldChildren[i]._dom != null &&\n\t\t\t\toldChildren[i]._dom == newParentVNode._nextDom\n\t\t\t) {\n\t\t\t\t// If the newParentVNode.__nextDom points to a dom node that is about to\n\t\t\t\t// be unmounted, then get the next sibling of that vnode and set\n\t\t\t\t// _nextDom to it\n\t\t\t\tnewParentVNode._nextDom = getDomSibling(oldParentVNode, i + 1);\n\t\t\t}\n\n\t\t\tunmount(oldChildren[i], oldChildren[i]);\n\t\t}\n\t}\n\n\t// Set refs only after unmount\n\tif (refs) {\n\t\tfor (i = 0; i < refs.length; i++) {\n\t\t\tapplyRef(refs[i], refs[++i], refs[++i]);\n\t\t}\n\t}\n}\n\nfunction reorderChildren(childVNode, oldDom, parentDom) {\n\t// Note: VNodes in nested suspended trees may be missing _children.\n\tlet c = childVNode._children;\n\tlet tmp = 0;\n\tfor (; c && tmp < c.length; tmp++) {\n\t\tlet vnode = c[tmp];\n\t\tif (vnode) {\n\t\t\t// We typically enter this code path on sCU bailout, where we copy\n\t\t\t// oldVNode._children to newVNode._children. If that is the case, we need\n\t\t\t// to update the old children's _parent pointer to point to the newVNode\n\t\t\t// (childVNode here).\n\t\t\tvnode._parent = childVNode;\n\n\t\t\tif (typeof vnode.type == 'function') {\n\t\t\t\toldDom = reorderChildren(vnode, oldDom, parentDom);\n\t\t\t} else {\n\t\t\t\toldDom = placeChild(\n\t\t\t\t\tparentDom,\n\t\t\t\t\tvnode,\n\t\t\t\t\tvnode,\n\t\t\t\t\tc,\n\t\t\t\t\tvnode._dom,\n\t\t\t\t\toldDom\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn oldDom;\n}\n\n/**\n * Flatten and loop through the children of a virtual node\n * @param {import('../index').ComponentChildren} children The unflattened\n * children of a virtual node\n * @returns {import('../internal').VNode[]}\n */\nexport function toChildArray(children, out) {\n\tout = out || [];\n\tif (children == null || typeof children == 'boolean') {\n\t} else if (Array.isArray(children)) {\n\t\tchildren.some(child => {\n\t\t\ttoChildArray(child, out);\n\t\t});\n\t} else {\n\t\tout.push(children);\n\t}\n\treturn out;\n}\n\nfunction placeChild(\n\tparentDom,\n\tchildVNode,\n\toldVNode,\n\toldChildren,\n\tnewDom,\n\toldDom\n) {\n\tlet nextDom;\n\tif (childVNode._nextDom !== undefined) {\n\t\t// Only Fragments or components that return Fragment like VNodes will\n\t\t// have a non-undefined _nextDom. Continue the diff from the sibling\n\t\t// of last DOM child of this child VNode\n\t\tnextDom = childVNode._nextDom;\n\n\t\t// Eagerly cleanup _nextDom. We don't need to persist the value because\n\t\t// it is only used by `diffChildren` to determine where to resume the diff after\n\t\t// diffing Components and Fragments. Once we store it the nextDOM local var, we\n\t\t// can clean up the property\n\t\tchildVNode._nextDom = undefined;\n\t} else if (\n\t\toldVNode == null ||\n\t\tnewDom != oldDom ||\n\t\tnewDom.parentNode == null\n\t) {\n\t\touter: if (oldDom == null || oldDom.parentNode !== parentDom) {\n\t\t\tparentDom.appendChild(newDom);\n\t\t\tnextDom = null;\n\t\t} else {\n\t\t\t// `j<oldChildrenLength; j+=2` is an alternative to `j++<oldChildrenLength/2`\n\t\t\tfor (\n\t\t\t\tlet sibDom = oldDom, j = 0;\n\t\t\t\t(sibDom = sibDom.nextSibling) && j < oldChildren.length;\n\t\t\t\tj += 2\n\t\t\t) {\n\t\t\t\tif (sibDom == newDom) {\n\t\t\t\t\tbreak outer;\n\t\t\t\t}\n\t\t\t}\n\t\t\tparentDom.insertBefore(newDom, oldDom);\n\t\t\tnextDom = oldDom;\n\t\t}\n\t}\n\n\t// If we have pre-calculated the nextDOM node, use it. Else calculate it now\n\t// Strictly check for `undefined` here cuz `null` is a valid value of `nextDom`.\n\t// See more detail in create-element.js:createVNode\n\tif (nextDom !== undefined) {\n\t\toldDom = nextDom;\n\t} else {\n\t\toldDom = newDom.nextSibling;\n\t}\n\n\treturn oldDom;\n}\n", "import { IS_NON_DIMENSIONAL } from '../constants';\nimport options from '../options';\n\n/**\n * Diff the old and new properties of a VNode and apply changes to the DOM node\n * @param {import('../internal').PreactElement} dom The DOM node to apply\n * changes to\n * @param {object} newProps The new props\n * @param {object} oldProps The old props\n * @param {boolean} isSvg Whether or not this node is an SVG node\n * @param {boolean} hydrate Whether or not we are in hydration mode\n */\nexport function diffProps(dom, newProps, oldProps, isSvg, hydrate) {\n\tlet i;\n\n\tfor (i in oldProps) {\n\t\tif (i !== 'children' && i !== 'key' && !(i in newProps)) {\n\t\t\tsetProperty(dom, i, null, oldProps[i], isSvg);\n\t\t}\n\t}\n\n\tfor (i in newProps) {\n\t\tif (\n\t\t\t(!hydrate || typeof newProps[i] == 'function') &&\n\t\t\ti !== 'children' &&\n\t\t\ti !== 'key' &&\n\t\t\ti !== 'value' &&\n\t\t\ti !== 'checked' &&\n\t\t\toldProps[i] !== newProps[i]\n\t\t) {\n\t\t\tsetProperty(dom, i, newProps[i], oldProps[i], isSvg);\n\t\t}\n\t}\n}\n\nfunction setStyle(style, key, value) {\n\tif (key[0] === '-') {\n\t\tstyle.setProperty(key, value);\n\t} else if (value == null) {\n\t\tstyle[key] = '';\n\t} else if (typeof value != 'number' || IS_NON_DIMENSIONAL.test(key)) {\n\t\tstyle[key] = value;\n\t} else {\n\t\tstyle[key] = value + 'px';\n\t}\n}\n\n/**\n * Set a property value on a DOM node\n * @param {import('../internal').PreactElement} dom The DOM node to modify\n * @param {string} name The name of the property to set\n * @param {*} value The value to set the property to\n * @param {*} oldValue The old value the property had\n * @param {boolean} isSvg Whether or not this DOM node is an SVG node or not\n */\nexport function setProperty(dom, name, value, oldValue, isSvg) {\n\tlet useCapture;\n\n\to: if (name === 'style') {\n\t\tif (typeof value == 'string') {\n\t\t\tdom.style.cssText = value;\n\t\t} else {\n\t\t\tif (typeof oldValue == 'string') {\n\t\t\t\tdom.style.cssText = oldValue = '';\n\t\t\t}\n\n\t\t\tif (oldValue) {\n\t\t\t\tfor (name in oldValue) {\n\t\t\t\t\tif (!(value && name in value)) {\n\t\t\t\t\t\tsetStyle(dom.style, name, '');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (value) {\n\t\t\t\tfor (name in value) {\n\t\t\t\t\tif (!oldValue || value[name] !== oldValue[name]) {\n\t\t\t\t\t\tsetStyle(dom.style, name, value[name]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t// Benchmark for comparison: https://esbench.com/bench/574c954bdb965b9a00965ac6\n\telse if (name[0] === 'o' && name[1] === 'n') {\n\t\tuseCapture = name !== (name = name.replace(/Capture$/, ''));\n\n\t\t// Infer correct casing for DOM built-in events:\n\t\tif (name.toLowerCase() in dom) name = name.toLowerCase().slice(2);\n\t\telse name = name.slice(2);\n\n\t\tif (!dom._listeners) dom._listeners = {};\n\t\tdom._listeners[name + useCapture] = value;\n\n\t\tif (value) {\n\t\t\tif (!oldValue) {\n\t\t\t\tconst handler = useCapture ? eventProxyCapture : eventProxy;\n\t\t\t\tdom.addEventListener(name, handler, useCapture);\n\t\t\t}\n\t\t} else {\n\t\t\tconst handler = useCapture ? eventProxyCapture : eventProxy;\n\t\t\tdom.removeEventListener(name, handler, useCapture);\n\t\t}\n\t} else if (name !== 'dangerouslySetInnerHTML') {\n\t\tif (isSvg) {\n\t\t\t// Normalize incorrect prop usage for SVG:\n\t\t\t// - xlink:href / xlinkHref --> href (xlink:href was removed from SVG and isn't needed)\n\t\t\t// - className --> class\n\t\t\tname = name.replace(/xlink[H:h]/, 'h').replace(/sName$/, 's');\n\t\t} else if (\n\t\t\tname !== 'href' &&\n\t\t\tname !== 'list' &&\n\t\t\tname !== 'form' &&\n\t\t\t// Default value in browsers is `-1` and an empty string is\n\t\t\t// cast to `0` instead\n\t\t\tname !== 'tabIndex' &&\n\t\t\tname !== 'download' &&\n\t\t\tname in dom\n\t\t) {\n\t\t\ttry {\n\t\t\t\tdom[name] = value == null ? '' : value;\n\t\t\t\t// labelled break is 1b smaller here than a return statement (sorry)\n\t\t\t\tbreak o;\n\t\t\t} catch (e) {}\n\t\t}\n\n\t\t// ARIA-attributes have a different notion of boolean values.\n\t\t// The value `false` is different from the attribute not\n\t\t// existing on the DOM, so we can't remove it. For non-boolean\n\t\t// ARIA-attributes we could treat false as a removal, but the\n\t\t// amount of exceptions would cost us too many bytes. On top of\n\t\t// that other VDOM frameworks also always stringify `false`.\n\n\t\tif (typeof value === 'function') {\n\t\t\t// never serialize functions as attribute values\n\t\t} else if (\n\t\t\tvalue != null &&\n\t\t\t(value !== false || (name[0] === 'a' && name[1] === 'r'))\n\t\t) {\n\t\t\tdom.setAttribute(name, value);\n\t\t} else {\n\t\t\tdom.removeAttribute(name);\n\t\t}\n\t}\n}\n\n/**\n * Proxy an event to hooked event handlers\n * @param {Event} e The event object from the browser\n * @private\n */\nfunction eventProxy(e) {\n\tthis._listeners[e.type + false](options.event ? options.event(e) : e);\n}\n\nfunction eventProxyCapture(e) {\n\tthis._listeners[e.type + true](options.event ? options.event(e) : e);\n}\n", "import { EMPTY_OBJ } from '../constants';\nimport { Component, getDomSibling } from '../component';\nimport { Fragment } from '../create-element';\nimport { diffChildren } from './children';\nimport { diffProps, setProperty } from './props';\nimport { assign, removeNode, slice } from '../util';\nimport options from '../options';\n\n/**\n * Diff two virtual nodes and apply proper changes to the DOM\n * @param {import('../internal').PreactElement} parentDom The parent of the DOM element\n * @param {import('../internal').VNode} newVNode The new virtual node\n * @param {import('../internal').VNode} oldVNode The old virtual node\n * @param {object} globalContext The current context object. Modified by getChildContext\n * @param {boolean} isSvg Whether or not this element is an SVG node\n * @param {Array<import('../internal').PreactElement>} excessDomChildren\n * @param {Array<import('../internal').Component>} commitQueue List of components\n * which have callbacks to invoke in commitRoot\n * @param {import('../internal').PreactElement} oldDom The current attached DOM\n * element any new dom elements should be placed around. Likely `null` on first\n * render (except when hydrating). Can be a sibling DOM element when diffing\n * Fragments that have siblings. In most cases, it starts out as `oldChildren[0]._dom`.\n * @param {boolean} [isHydrating] Whether or not we are in hydration\n */\nexport function diff(\n\tparentDom,\n\tnewVNode,\n\toldVNode,\n\tglobalContext,\n\tisSvg,\n\texcessDomChildren,\n\tcommitQueue,\n\toldDom,\n\tisHydrating\n) {\n\tlet tmp,\n\t\tnewType = newVNode.type;\n\n\t// When passing through createElement it assigns the object\n\t// constructor as undefined. This to prevent JSON-injection.\n\tif (newVNode.constructor !== undefined) return null;\n\n\t// If the previous diff bailed out, resume creating/hydrating.\n\tif (oldVNode._hydrating != null) {\n\t\tisHydrating = oldVNode._hydrating;\n\t\toldDom = newVNode._dom = oldVNode._dom;\n\t\t// if we resume, we want the tree to be \"unlocked\"\n\t\tnewVNode._hydrating = null;\n\t\texcessDomChildren = [oldDom];\n\t}\n\n\tif ((tmp = options._diff)) tmp(newVNode);\n\n\ttry {\n\t\touter: if (typeof newType == 'function') {\n\t\t\tlet c, isNew, oldProps, oldState, snapshot, clearProcessingException;\n\t\t\tlet newProps = newVNode.props;\n\n\t\t\t// Necessary for createContext api. Setting this property will pass\n\t\t\t// the context value as `this.context` just for this component.\n\t\t\ttmp = newType.contextType;\n\t\t\tlet provider = tmp && globalContext[tmp._id];\n\t\t\tlet componentContext = tmp\n\t\t\t\t? provider\n\t\t\t\t\t? provider.props.value\n\t\t\t\t\t: tmp._defaultValue\n\t\t\t\t: globalContext;\n\n\t\t\t// Get component and set it to `c`\n\t\t\tif (oldVNode._component) {\n\t\t\t\tc = newVNode._component = oldVNode._component;\n\t\t\t\tclearProcessingException = c._processingException = c._pendingError;\n\t\t\t} else {\n\t\t\t\t// Instantiate the new component\n\t\t\t\tif ('prototype' in newType && newType.prototype.render) {\n\t\t\t\t\t// @ts-ignore The check above verifies that newType is suppose to be constructed\n\t\t\t\t\tnewVNode._component = c = new newType(newProps, componentContext); // eslint-disable-line new-cap\n\t\t\t\t} else {\n\t\t\t\t\t// @ts-ignore Trust me, Component implements the interface we want\n\t\t\t\t\tnewVNode._component = c = new Component(newProps, componentContext);\n\t\t\t\t\tc.constructor = newType;\n\t\t\t\t\tc.render = doRender;\n\t\t\t\t}\n\t\t\t\tif (provider) provider.sub(c);\n\n\t\t\t\tc.props = newProps;\n\t\t\t\tif (!c.state) c.state = {};\n\t\t\t\tc.context = componentContext;\n\t\t\t\tc._globalContext = globalContext;\n\t\t\t\tisNew = c._dirty = true;\n\t\t\t\tc._renderCallbacks = [];\n\t\t\t}\n\n\t\t\t// Invoke getDerivedStateFromProps\n\t\t\tif (c._nextState == null) {\n\t\t\t\tc._nextState = c.state;\n\t\t\t}\n\t\t\tif (newType.getDerivedStateFromProps != null) {\n\t\t\t\tif (c._nextState == c.state) {\n\t\t\t\t\tc._nextState = assign({}, c._nextState);\n\t\t\t\t}\n\n\t\t\t\tassign(\n\t\t\t\t\tc._nextState,\n\t\t\t\t\tnewType.getDerivedStateFromProps(newProps, c._nextState)\n\t\t\t\t);\n\t\t\t}\n\n\t\t\toldProps = c.props;\n\t\t\toldState = c.state;\n\n\t\t\t// Invoke pre-render lifecycle methods\n\t\t\tif (isNew) {\n\t\t\t\tif (\n\t\t\t\t\tnewType.getDerivedStateFromProps == null &&\n\t\t\t\t\tc.componentWillMount != null\n\t\t\t\t) {\n\t\t\t\t\tc.componentWillMount();\n\t\t\t\t}\n\n\t\t\t\tif (c.componentDidMount != null) {\n\t\t\t\t\tc._renderCallbacks.push(c.componentDidMount);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (\n\t\t\t\t\tnewType.getDerivedStateFromProps == null &&\n\t\t\t\t\tnewProps !== oldProps &&\n\t\t\t\t\tc.componentWillReceiveProps != null\n\t\t\t\t) {\n\t\t\t\t\tc.componentWillReceiveProps(newProps, componentContext);\n\t\t\t\t}\n\n\t\t\t\tif (\n\t\t\t\t\t(!c._force &&\n\t\t\t\t\t\tc.shouldComponentUpdate != null &&\n\t\t\t\t\t\tc.shouldComponentUpdate(\n\t\t\t\t\t\t\tnewProps,\n\t\t\t\t\t\t\tc._nextState,\n\t\t\t\t\t\t\tcomponentContext\n\t\t\t\t\t\t) === false) ||\n\t\t\t\t\tnewVNode._original === oldVNode._original\n\t\t\t\t) {\n\t\t\t\t\tc.props = newProps;\n\t\t\t\t\tc.state = c._nextState;\n\t\t\t\t\t// More info about this here: https://gist.github.com/JoviDeCroock/bec5f2ce93544d2e6070ef8e0036e4e8\n\t\t\t\t\tif (newVNode._original !== oldVNode._original) c._dirty = false;\n\t\t\t\t\tc._vnode = newVNode;\n\t\t\t\t\tnewVNode._dom = oldVNode._dom;\n\t\t\t\t\tnewVNode._children = oldVNode._children;\n\t\t\t\t\tnewVNode._children.forEach(vnode => {\n\t\t\t\t\t\tif (vnode) vnode._parent = newVNode;\n\t\t\t\t\t});\n\t\t\t\t\tif (c._renderCallbacks.length) {\n\t\t\t\t\t\tcommitQueue.push(c);\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak outer;\n\t\t\t\t}\n\n\t\t\t\tif (c.componentWillUpdate != null) {\n\t\t\t\t\tc.componentWillUpdate(newProps, c._nextState, componentContext);\n\t\t\t\t}\n\n\t\t\t\tif (c.componentDidUpdate != null) {\n\t\t\t\t\tc._renderCallbacks.push(() => {\n\t\t\t\t\t\tc.componentDidUpdate(oldProps, oldState, snapshot);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tc.context = componentContext;\n\t\t\tc.props = newProps;\n\t\t\tc.state = c._nextState;\n\n\t\t\tif ((tmp = options._render)) tmp(newVNode);\n\n\t\t\tc._dirty = false;\n\t\t\tc._vnode = newVNode;\n\t\t\tc._parentDom = parentDom;\n\n\t\t\ttmp = c.render(c.props, c.state, c.context);\n\n\t\t\t// Handle setState called in render, see #2553\n\t\t\tc.state = c._nextState;\n\n\t\t\tif (c.getChildContext != null) {\n\t\t\t\tglobalContext = assign(assign({}, globalContext), c.getChildContext());\n\t\t\t}\n\n\t\t\tif (!isNew && c.getSnapshotBeforeUpdate != null) {\n\t\t\t\tsnapshot = c.getSnapshotBeforeUpdate(oldProps, oldState);\n\t\t\t}\n\n\t\t\tlet isTopLevelFragment =\n\t\t\t\ttmp != null && tmp.type === Fragment && tmp.key == null;\n\t\t\tlet renderResult = isTopLevelFragment ? tmp.props.children : tmp;\n\n\t\t\tdiffChildren(\n\t\t\t\tparentDom,\n\t\t\t\tArray.isArray(renderResult) ? renderResult : [renderResult],\n\t\t\t\tnewVNode,\n\t\t\t\toldVNode,\n\t\t\t\tglobalContext,\n\t\t\t\tisSvg,\n\t\t\t\texcessDomChildren,\n\t\t\t\tcommitQueue,\n\t\t\t\toldDom,\n\t\t\t\tisHydrating\n\t\t\t);\n\n\t\t\tc.base = newVNode._dom;\n\n\t\t\t// We successfully rendered this VNode, unset any stored hydration/bailout state:\n\t\t\tnewVNode._hydrating = null;\n\n\t\t\tif (c._renderCallbacks.length) {\n\t\t\t\tcommitQueue.push(c);\n\t\t\t}\n\n\t\t\tif (clearProcessingException) {\n\t\t\t\tc._pendingError = c._processingException = null;\n\t\t\t}\n\n\t\t\tc._force = false;\n\t\t} else if (\n\t\t\texcessDomChildren == null &&\n\t\t\tnewVNode._original === oldVNode._original\n\t\t) {\n\t\t\tnewVNode._children = oldVNode._children;\n\t\t\tnewVNode._dom = oldVNode._dom;\n\t\t} else {\n\t\t\tnewVNode._dom = diffElementNodes(\n\t\t\t\toldVNode._dom,\n\t\t\t\tnewVNode,\n\t\t\t\toldVNode,\n\t\t\t\tglobalContext,\n\t\t\t\tisSvg,\n\t\t\t\texcessDomChildren,\n\t\t\t\tcommitQueue,\n\t\t\t\tisHydrating\n\t\t\t);\n\t\t}\n\n\t\tif ((tmp = options.diffed)) tmp(newVNode);\n\t} catch (e) {\n\t\tnewVNode._original = null;\n\t\t// if hydrating or creating initial tree, bailout preserves DOM:\n\t\tif (isHydrating || excessDomChildren != null) {\n\t\t\tnewVNode._dom = oldDom;\n\t\t\tnewVNode._hydrating = !!isHydrating;\n\t\t\texcessDomChildren[excessDomChildren.indexOf(oldDom)] = null;\n\t\t\t// ^ could possibly be simplified to:\n\t\t\t// excessDomChildren.length = 0;\n\t\t}\n\t\toptions._catchError(e, newVNode, oldVNode);\n\t}\n}\n\n/**\n * @param {Array<import('../internal').Component>} commitQueue List of components\n * which have callbacks to invoke in commitRoot\n * @param {import('../internal').VNode} root\n */\nexport function commitRoot(commitQueue, root) {\n\tif (options._commit) options._commit(root, commitQueue);\n\n\tcommitQueue.some(c => {\n\t\ttry {\n\t\t\t// @ts-ignore Reuse the commitQueue variable here so the type changes\n\t\t\tcommitQueue = c._renderCallbacks;\n\t\t\tc._renderCallbacks = [];\n\t\t\tcommitQueue.some(cb => {\n\t\t\t\t// @ts-ignore See above ts-ignore on commitQueue\n\t\t\t\tcb.call(c);\n\t\t\t});\n\t\t} catch (e) {\n\t\t\toptions._catchError(e, c._vnode);\n\t\t}\n\t});\n}\n\n/**\n * Diff two virtual nodes representing DOM element\n * @param {import('../internal').PreactElement} dom The DOM element representing\n * the virtual nodes being diffed\n * @param {import('../internal').VNode} newVNode The new virtual node\n * @param {import('../internal').VNode} oldVNode The old virtual node\n * @param {object} globalContext The current context object\n * @param {boolean} isSvg Whether or not this DOM node is an SVG node\n * @param {*} excessDomChildren\n * @param {Array<import('../internal').Component>} commitQueue List of components\n * which have callbacks to invoke in commitRoot\n * @param {boolean} isHydrating Whether or not we are in hydration\n * @returns {import('../internal').PreactElement}\n */\nfunction diffElementNodes(\n\tdom,\n\tnewVNode,\n\toldVNode,\n\tglobalContext,\n\tisSvg,\n\texcessDomChildren,\n\tcommitQueue,\n\tisHydrating\n) {\n\tlet oldProps = oldVNode.props;\n\tlet newProps = newVNode.props;\n\tlet nodeType = newVNode.type;\n\tlet i = 0;\n\n\t// Tracks entering and exiting SVG namespace when descending through the tree.\n\tif (nodeType === 'svg') isSvg = true;\n\n\tif (excessDomChildren != null) {\n\t\tfor (; i < excessDomChildren.length; i++) {\n\t\t\tconst child = excessDomChildren[i];\n\n\t\t\t// if newVNode matches an element in excessDomChildren or the `dom`\n\t\t\t// argument matches an element in excessDomChildren, remove it from\n\t\t\t// excessDomChildren so it isn't later removed in diffChildren\n\t\t\tif (\n\t\t\t\tchild &&\n\t\t\t\t'setAttribute' in child === !!nodeType &&\n\t\t\t\t(nodeType ? child.localName === nodeType : child.nodeType === 3)\n\t\t\t) {\n\t\t\t\tdom = child;\n\t\t\t\texcessDomChildren[i] = null;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (dom == null) {\n\t\tif (nodeType === null) {\n\t\t\t// @ts-ignore createTextNode returns Text, we expect PreactElement\n\t\t\treturn document.createTextNode(newProps);\n\t\t}\n\n\t\tif (isSvg) {\n\t\t\tdom = document.createElementNS(\n\t\t\t\t'http://www.w3.org/2000/svg',\n\t\t\t\t// @ts-ignore We know `newVNode.type` is a string\n\t\t\t\tnodeType\n\t\t\t);\n\t\t} else {\n\t\t\tdom = document.createElement(\n\t\t\t\t// @ts-ignore We know `newVNode.type` is a string\n\t\t\t\tnodeType,\n\t\t\t\tnewProps.is && newProps\n\t\t\t);\n\t\t}\n\n\t\t// we created a new parent, so none of the previously attached children can be reused:\n\t\texcessDomChildren = null;\n\t\t// we are creating a new node, so we can assume this is a new subtree (in case we are hydrating), this deopts the hydrate\n\t\tisHydrating = false;\n\t}\n\n\tif (nodeType === null) {\n\t\t// During hydration, we still have to split merged text from SSR'd HTML.\n\t\tif (oldProps !== newProps && (!isHydrating || dom.data !== newProps)) {\n\t\t\tdom.data = newProps;\n\t\t}\n\t} else {\n\t\t// If excessDomChildren was not null, repopulate it with the current element's children:\n\t\texcessDomChildren = excessDomChildren && slice.call(dom.childNodes);\n\n\t\toldProps = oldVNode.props || EMPTY_OBJ;\n\n\t\tlet oldHtml = oldProps.dangerouslySetInnerHTML;\n\t\tlet newHtml = newProps.dangerouslySetInnerHTML;\n\n\t\t// During hydration, props are not diffed at all (including dangerouslySetInnerHTML)\n\t\t// @TODO we should warn in debug mode when props don't match here.\n\t\tif (!isHydrating) {\n\t\t\t// But, if we are in a situation where we are using existing DOM (e.g. replaceNode)\n\t\t\t// we should read the existing DOM attributes to diff them\n\t\t\tif (excessDomChildren != null) {\n\t\t\t\toldProps = {};\n\t\t\t\tfor (i = 0; i < dom.attributes.length; i++) {\n\t\t\t\t\toldProps[dom.attributes[i].name] = dom.attributes[i].value;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (newHtml || oldHtml) {\n\t\t\t\t// Avoid re-applying the same '__html' if it did not changed between re-render\n\t\t\t\tif (\n\t\t\t\t\t!newHtml ||\n\t\t\t\t\t((!oldHtml || newHtml.__html != oldHtml.__html) &&\n\t\t\t\t\t\tnewHtml.__html !== dom.innerHTML)\n\t\t\t\t) {\n\t\t\t\t\tdom.innerHTML = (newHtml && newHtml.__html) || '';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tdiffProps(dom, newProps, oldProps, isSvg, isHydrating);\n\n\t\t// If the new vnode didn't have dangerouslySetInnerHTML, diff its children\n\t\tif (newHtml) {\n\t\t\tnewVNode._children = [];\n\t\t} else {\n\t\t\ti = newVNode.props.children;\n\t\t\tdiffChildren(\n\t\t\t\tdom,\n\t\t\t\tArray.isArray(i) ? i : [i],\n\t\t\t\tnewVNode,\n\t\t\t\toldVNode,\n\t\t\t\tglobalContext,\n\t\t\t\tisSvg && nodeType !== 'foreignObject',\n\t\t\t\texcessDomChildren,\n\t\t\t\tcommitQueue,\n\t\t\t\texcessDomChildren\n\t\t\t\t\t? excessDomChildren[0]\n\t\t\t\t\t: oldVNode._children && getDomSibling(oldVNode, 0),\n\t\t\t\tisHydrating\n\t\t\t);\n\n\t\t\t// Remove children that are not part of any vnode.\n\t\t\tif (excessDomChildren != null) {\n\t\t\t\tfor (i = excessDomChildren.length; i--; ) {\n\t\t\t\t\tif (excessDomChildren[i] != null) removeNode(excessDomChildren[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// (as above, don't diff props during hydration)\n\t\tif (!isHydrating) {\n\t\t\tif (\n\t\t\t\t'value' in newProps &&\n\t\t\t\t(i = newProps.value) !== undefined &&\n\t\t\t\t// #2756 For the <progress>-element the initial value is 0,\n\t\t\t\t// despite the attribute not being present. When the attribute\n\t\t\t\t// is missing the progress bar is treated as indeterminate.\n\t\t\t\t// To fix that we'll always update it when it is 0 for progress elements\n\t\t\t\t(i !== dom.value ||\n\t\t\t\t\t(nodeType === 'progress' && !i) ||\n\t\t\t\t\t// This is only for IE 11 to fix <select> value not being updated.\n\t\t\t\t\t// To avoid a stale select value we need to set the option.value\n\t\t\t\t\t// again, which triggers IE11 to re-evaluate the select value\n\t\t\t\t\t(nodeType === 'option' && i !== oldProps.value))\n\t\t\t) {\n\t\t\t\tsetProperty(dom, 'value', i, oldProps.value, false);\n\t\t\t}\n\t\t\tif (\n\t\t\t\t'checked' in newProps &&\n\t\t\t\t(i = newProps.checked) !== undefined &&\n\t\t\t\ti !== dom.checked\n\t\t\t) {\n\t\t\t\tsetProperty(dom, 'checked', i, oldProps.checked, false);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn dom;\n}\n\n/**\n * Invoke or update a ref, depending on whether it is a function or object ref.\n * @param {object|function} ref\n * @param {any} value\n * @param {import('../internal').VNode} vnode\n */\nexport function applyRef(ref, value, vnode) {\n\ttry {\n\t\tif (typeof ref == 'function') ref(value);\n\t\telse ref.current = value;\n\t} catch (e) {\n\t\toptions._catchError(e, vnode);\n\t}\n}\n\n/**\n * Unmount a virtual node from the tree and apply DOM changes\n * @param {import('../internal').VNode} vnode The virtual node to unmount\n * @param {import('../internal').VNode} parentVNode The parent of the VNode that\n * initiated the unmount\n * @param {boolean} [skipRemove] Flag that indicates that a parent node of the\n * current element is already detached from the DOM.\n */\nexport function unmount(vnode, parentVNode, skipRemove) {\n\tlet r;\n\tif (options.unmount) options.unmount(vnode);\n\n\tif ((r = vnode.ref)) {\n\t\tif (!r.current || r.current === vnode._dom) applyRef(r, null, parentVNode);\n\t}\n\n\tif ((r = vnode._component) != null) {\n\t\tif (r.componentWillUnmount) {\n\t\t\ttry {\n\t\t\t\tr.componentWillUnmount();\n\t\t\t} catch (e) {\n\t\t\t\toptions._catchError(e, parentVNode);\n\t\t\t}\n\t\t}\n\n\t\tr.base = r._parentDom = null;\n\t}\n\n\tif ((r = vnode._children)) {\n\t\tfor (let i = 0; i < r.length; i++) {\n\t\t\tif (r[i]) {\n\t\t\t\tunmount(r[i], parentVNode, typeof vnode.type != 'function');\n\t\t\t}\n\t\t}\n\t}\n\n\tif (!skipRemove && vnode._dom != null) removeNode(vnode._dom);\n\n\t// Must be set to `undefined` to properly clean up `_nextDom`\n\t// for which `null` is a valid value. See comment in `create-element.js`\n\tvnode._dom = vnode._nextDom = undefined;\n}\n\n/** The `.render()` method for a PFC backing instance. */\nfunction doRender(props, state, context) {\n\treturn this.constructor(props, context);\n}\n", "import { EMPTY_OBJ } from './constants';\nimport { commitRoot, diff } from './diff/index';\nimport { createElement, Fragment } from './create-element';\nimport options from './options';\nimport { slice } from './util';\n\n/**\n * Render a Preact virtual node into a DOM element\n * @param {import('./internal').ComponentChild} vnode The virtual node to render\n * @param {import('./internal').PreactElement} parentDom The DOM element to\n * render into\n * @param {import('./internal').PreactElement | object} [replaceNode] Optional: Attempt to re-use an\n * existing DOM tree rooted at `replaceNode`\n */\nexport function render(vnode, parentDom, replaceNode) {\n\tif (options._root) options._root(vnode, parentDom);\n\n\t// We abuse the `replaceNode` parameter in `hydrate()` to signal if we are in\n\t// hydration mode or not by passing the `hydrate` function instead of a DOM\n\t// element..\n\tlet isHydrating = typeof replaceNode === 'function';\n\n\t// To be able to support calling `render()` multiple times on the same\n\t// DOM node, we need to obtain a reference to the previous tree. We do\n\t// this by assigning a new `_children` property to DOM nodes which points\n\t// to the last rendered tree. By default this property is not present, which\n\t// means that we are mounting a new tree for the first time.\n\tlet oldVNode = isHydrating\n\t\t? null\n\t\t: (replaceNode && replaceNode._children) || parentDom._children;\n\n\tvnode = (\n\t\t(!isHydrating && replaceNode) ||\n\t\tparentDom\n\t)._children = createElement(Fragment, null, [vnode]);\n\n\t// List of effects that need to be called after diffing.\n\tlet commitQueue = [];\n\tdiff(\n\t\tparentDom,\n\t\t// Determine the new vnode tree and store it on the DOM element on\n\t\t// our custom `_children` property.\n\t\tvnode,\n\t\toldVNode || EMPTY_OBJ,\n\t\tEMPTY_OBJ,\n\t\tparentDom.ownerSVGElement !== undefined,\n\t\t!isHydrating && replaceNode\n\t\t\t? [replaceNode]\n\t\t\t: oldVNode\n\t\t\t? null\n\t\t\t: parentDom.firstChild\n\t\t\t? slice.call(parentDom.childNodes)\n\t\t\t: null,\n\t\tcommitQueue,\n\t\t!isHydrating && replaceNode\n\t\t\t? replaceNode\n\t\t\t: oldVNode\n\t\t\t? oldVNode._dom\n\t\t\t: parentDom.firstChild,\n\t\tisHydrating\n\t);\n\n\t// Flush all queued effects\n\tcommitRoot(commitQueue, vnode);\n}\n\n/**\n * Update an existing DOM element with data from a Preact virtual node\n * @param {import('./internal').ComponentChild} vnode The virtual node to render\n * @param {import('./internal').PreactElement} parentDom The DOM element to\n * update\n */\nexport function hydrate(vnode, parentDom) {\n\trender(vnode, parentDom, hydrate);\n}\n", "import { assign, slice } from './util';\nimport { createVNode } from './create-element';\n\n/**\n * Clones the given VNode, optionally adding attributes/props and replacing its children.\n * @param {import('./internal').VNode} vnode The virtual DOM element to clone\n * @param {object} props Attributes/props to add when cloning\n * @param {Array<import('./internal').ComponentChildren>} rest Any additional arguments will be used as replacement children.\n * @returns {import('./internal').VNode}\n */\nexport function cloneElement(vnode, props, children) {\n\tlet normalizedProps = assign({}, vnode.props),\n\t\tkey,\n\t\tref,\n\t\ti;\n\tfor (i in props) {\n\t\tif (i == 'key') key = props[i];\n\t\telse if (i == 'ref') ref = props[i];\n\t\telse normalizedProps[i] = props[i];\n\t}\n\n\tif (arguments.length > 2) {\n\t\tnormalizedProps.children =\n\t\t\targuments.length > 3 ? slice.call(arguments, 2) : children;\n\t}\n\n\treturn createVNode(\n\t\tvnode.type,\n\t\tnormalizedProps,\n\t\tkey || vnode.key,\n\t\tref || vnode.ref,\n\t\tnull\n\t);\n}\n", "/**\n * Find the closest error boundary to a thrown error and call it\n * @param {object} error The thrown value\n * @param {import('../internal').VNode} vnode The vnode that threw\n * the error that was caught (except for unmounting when this parameter\n * is the highest parent that was being unmounted)\n */\nexport function _catchError(error, vnode) {\n\t/** @type {import('../internal').Component} */\n\tlet component, ctor, handled;\n\n\tfor (; (vnode = vnode._parent); ) {\n\t\tif ((component = vnode._component) && !component._processingException) {\n\t\t\ttry {\n\t\t\t\tctor = component.constructor;\n\n\t\t\t\tif (ctor && ctor.getDerivedStateFromError != null) {\n\t\t\t\t\tcomponent.setState(ctor.getDerivedStateFromError(error));\n\t\t\t\t\thandled = component._dirty;\n\t\t\t\t}\n\n\t\t\t\tif (component.componentDidCatch != null) {\n\t\t\t\t\tcomponent.componentDidCatch(error);\n\t\t\t\t\thandled = component._dirty;\n\t\t\t\t}\n\n\t\t\t\t// This is an error boundary. Mark it as having bailed out, and whether it was mid-hydration.\n\t\t\t\tif (handled) {\n\t\t\t\t\treturn (component._pendingError = component);\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\terror = e;\n\t\t\t}\n\t\t}\n\t}\n\n\tthrow error;\n}\n", "export class TranslationError extends Error {\n\tprivate readonly isTranslationError = true;\n\n\tpublic constructor(\n\t\tpublic readonly code: string,\n\t\textra: string\n\t) {\n\t\tsuper(`${code} ${extra}`);\n\t}\n\n\tpublic static readonly FORMAT_UNAVAILABLE = 'FormatUnavailable';\n\tpublic static readonly INVALID_PARAMETER = 'InvalidParameter';\n\tpublic static readonly KEY_NOT_FOUND = 'KeyNotFound';\n\n\tpublic static is(obj: unknown): obj is TranslationError {\n\t\treturn (obj as TranslationError | undefined)?.isTranslationError === true;\n\t}\n}\n", "import type { Placeholder } from '~/parser/parser';\nimport type { Vars } from '~/types';\n\nexport function getFormatName(placeholder: Placeholder) {\n\treturn placeholder[1] ?? 'variable';\n}\n\nexport function expand(placeholder: Placeholder, vars?: Vars) {\n\tconst varName = placeholder[0];\n\tif (vars === undefined || !Object.prototype.hasOwnProperty.call(vars, varName)) {\n\t\treturn varName;\n\t}\n\n\treturn '' + vars[varName];\n}\n", "import type { Attributes, Messages, Placeholder } from '~/parser/parser';\nimport { TranslationError } from '~/TranslationError';\n\nimport { getFormatName } from './placeholder';\n\ntype Validator<T> = (value: unknown, type: string, index: number) => asserts value is T;\ntype ValidatedTypes<V extends readonly any[]> = { [I in keyof V]: V[I] extends Validator<infer T> ? T : never };\n\nexport function assertParamsValid<TValidators extends readonly Validator<any>[]>(\n\tplaceholder: readonly any[],\n\tvalidators: TValidators\n): asserts placeholder is [ string, string?, ...ValidatedTypes<TValidators> ] {\n\tconst { length } = validators;\n\tconst formatName = getFormatName(placeholder as Placeholder);\n\n\tif (placeholder.length - 2 > length) {\n\t\tthrow new TranslationError(\n\t\t\tTranslationError.INVALID_PARAMETER,\n\t\t\t`too many parameters for format '${formatName}'`\n\t\t);\n\t}\n\n\tfor (let paramIndex = 0; paramIndex < length; ++paramIndex) {\n\t\tvalidators[paramIndex].call(null, placeholder[2 + paramIndex], formatName, paramIndex);\n\t}\n}\n\n\nexport function assertIdentifier(value: unknown, formatName: string, paramIndex: number): asserts value is string {\n\tif (typeof value !== 'string') {\n\t\tfail('an identifier', formatName, paramIndex);\n\t}\n}\n\nexport function assertMessages(obj: unknown, formatName: string, paramIndex: number): asserts obj is Messages {\n\tif (!(isObject(obj) && Array.isArray(getAnyValue(obj)))) {\n\t\tfail('a map of messages', formatName, paramIndex);\n\t}\n}\n\nexport function assertAttributes(obj: unknown, formatName: string, paramIndex: number): asserts obj is Attributes {\n\tif (!(isObject(obj) && typeof getAnyValue(obj) === 'string')) {\n\t\tfail('a map of attributes', formatName, paramIndex);\n\t}\n}\n\nexport function optional<T>(validator: Validator<T>): Validator<T | undefined> {\n\treturn (value, format, index): asserts value is T | undefined => {\n\t\tif (value === null || value === undefined) {\n\t\t\treturn;\n\t\t}\n\n\t\tvalidator(value, format, index);\n\t};\n}\n\n\nfunction isObject(value: unknown): value is {} {\n\treturn value !== null && typeof value === 'object';\n}\n\nfunction getAnyValue(obj: {}): unknown {\n\tfor (const key in obj) {\n\t\tif (Object.prototype.hasOwnProperty.call(obj, key)) {\n\t\t\treturn obj[key as never];\n\t\t}\n\t}\n\n\treturn undefined;\n}\n\nfunction fail(expected: string, formatName: string, paramIndex: number) {\n\tthrow new TranslationError(\n\t\tTranslationError.INVALID_PARAMETER,\n\t\t`expected parameter ${paramIndex + 1} of format '${formatName}' to be ${expected}`\n\t);\n}\n", "import { TranslationError } from '~/TranslationError';\nimport type { FormatFactory, PlaceholderExpansion } from '~/types';\nimport { expand, getFormatName } from '~/utils/placeholder';\nimport { assertMessages, assertParamsValid } from '~/utils/validation';\n\nconst paramTypes = [ assertMessages ] as const;\n\nexport const select: FormatFactory = () => (placeholder, interpreter) => {\n\tassertParamsValid(placeholder, paramTypes);\n\n\tconst optionsAST = placeholder[2];\n\tif (!optionsAST.other) {\n\t\tthrow new TranslationError(\n\t\t\tTranslationError.INVALID_PARAMETER,\n\t\t\t`messages of format '${getFormatName(placeholder)}' must contain the key 'other'`\n\t\t);\n\t}\n\n\tconst options: Record<string, PlaceholderExpansion | undefined> = {};\n\tfor (const key in optionsAST) {\n\t\toptions[key] = interpreter.interpret(optionsAST[key]!);\n\t}\n\n\treturn vars => (options[expand(placeholder, vars)] ?? options.other!)(vars);\n};\n", "import type { FormatFactory } from '~/types';\nimport { expand } from '~/utils/placeholder';\nimport { assertParamsValid } from '~/utils/validation';\n\nconst paramTypes = [] as const;\n\nexport const variable: FormatFactory = () => placeholder => {\n\tassertParamsValid(placeholder, paramTypes);\n\treturn vars => expand(placeholder, vars);\n};\n", "export class ParseError extends Error {\n\tprivate readonly isParseError = true;\n\n\tpublic constructor(\n\t\tmessage: string,\n\t\tpublic readonly input: string,\n\t\tpublic readonly at: number\n\t) {\n\t\tsuper(message);\n\t}\n\n\tpublic toString() {\n\t\tconst trimStart = Math.max(this.input.lastIndexOf('\\n', this.at - 1), 0) + 1;\n\n\t\tlet trimEnd = this.input.indexOf('\\n', this.at + 1);\n\t\tif (trimEnd === -1) {\n\t\t\ttrimEnd = this.input.length;\n\t\t}\n\t\telse if (this.input[trimEnd - 1] === '\\r') {\n\t\t\t// prevent slicing through CRLF pairs\n\t\t\t--trimEnd;\n\t\t}\n\n\t\tconst snippet = `${this.input.slice(trimStart, trimEnd)}\\n${' '.repeat(this.at - trimStart)}^`;\n\t\treturn `${this.message} at pos ${this.at}:\\n\\n${snippet}\\n\\n${this.stack}`;\n\t}\n\n\tpublic static is(obj: unknown): obj is ParseError {\n\t\treturn (obj as ParseError | undefined)?.isParseError === true;\n\t}\n}\n", "/* eslint-disable max-depth */\nimport { ParseError } from './ParseError';\n\nexport interface Messages {\n\t[name: string]: AST | undefined;\n}\n\nexport interface Attributes {\n\t[name: string]: string | undefined;\n}\n\nexport type Placeholder = [ varName: string, formatName?: string, ...params: (string | Messages | Attributes)[] ];\nexport type Element = string | Placeholder;\nexport type AST = Element[];\n\nconst C_ATTRIBUTE = ':';\nconst C_ESCAPE = \"'\";\nconst C_OCTOTHORPE = '#';\nconst C_PLACEHOLDER_OPEN = '{';\nconst C_PLACEHOLDER_CLOSE = '}';\nconst C_SEPARATOR = ',';\n\nfunction isWhitespace(code: number) {\n\treturn (\n\t\tcode === 0x20 ||\n\t\t(code >= 0x09 && code <= 0x0D) ||\n\t\tcode === 0x85 ||\n\t\tcode === 0xA0 ||\n\t\tcode === 0x180E ||\n\t\t(code >= 0x2000 && code <= 0x200D) ||\n\t\tcode === 0x2028 ||\n\t\tcode === 0x2029 ||\n\t\tcode === 0x202F ||\n\t\tcode === 0x205F ||\n\t\tcode === 0x2060 ||\n\t\tcode === 0x3000 ||\n\t\tcode === 0xFEFF\n\t);\n}\n\nfunction skipWhitespace(input: string, offset: number) {\n\tconst { length } = input;\n\n\tlet index = offset;\n\twhile (index < length && isWhitespace(input.charCodeAt(index))) {\n\t\t++index;\n\t}\n\n\treturn index;\n}\n\nfunction parseIdentifier(input: string, offset: number) {\n\tconst { length } = input;\n\n\tlet index = offset;\n\tlet char;\n\n\twhile (index < length) {\n\t\tchar = input[index];\n\t\tif (\n\t\t\tchar === C_PLACEHOLDER_OPEN ||\n\t\t\tchar === C_PLACEHOLDER_CLOSE ||\n\t\t\tchar === C_SEPARATOR ||\n\t\t\tchar === C_OCTOTHORPE ||\n\t\t\tchar === C_ESCAPE ||\n\t\t\tchar === C_ATTRIBUTE ||\n\t\t\tisWhitespace(char.charCodeAt(0))\n\t\t) {\n\t\t\tbreak;\n\t\t}\n\n\t\t++index;\n\t}\n\n\tif (offset === index) {\n\t\tthrow new ParseError(`expected an identifier but ${char ? `saw '${char}'` : 'saw the end of pattern'} instead`, input, offset);\n\t}\n\n\treturn input.slice(offset, index);\n}\n\nfunction parseText(input: string, offset: number, isWithinPlaceholder: boolean) {\n\tconst { length } = input;\n\n\tlet anchor = offset;\n\tlet index = offset;\n\tlet char;\n\tlet text = '';\n\n\twhile (index < length) {\n\t\tchar = input[index];\n\t\tif (\n\t\t\tchar === C_PLACEHOLDER_OPEN ||\n\t\t\tchar === C_PLACEHOLDER_CLOSE ||\n\t\t\t(isWithinPlaceholder && char === C_OCTOTHORPE)\n\t\t) {\n\t\t\tbreak;\n\t\t}\n\n\t\tif (char === C_ESCAPE) {\n\t\t\tchar = input[++index];\n\n\t\t\t// double escape is always transformed into a single char\n\t\t\tif (char === C_ESCAPE) {\n\t\t\t\ttext += input.slice(anchor, index);\n\t\t\t\tanchor = index + 1;\n\t\t\t}\n\n\t\t\t// an escape sequence is only started when directly followed by a special\n\t\t\telse if (\n\t\t\t\tchar === C_PLACEHOLDER_OPEN ||\n\t\t\t\tchar === C_PLACEHOLDER_CLOSE ||\n\t\t\t\t(isWithinPlaceholder && char === C_OCTOTHORPE)\n\t\t\t) {\n\t\t\t\ttext += input.slice(anchor, index - 1);\n\t\t\t\tanchor = index;\n\n\t\t\t\twhile (++index < length) {\n\t\t\t\t\tchar = input[index];\n\t\t\t\t\tif (char === C_ESCAPE) {\n\t\t\t\t\t\tchar = input[index + 1];\n\t\t\t\t\t\tif (char === C_ESCAPE) {\n\t\t\t\t\t\t\ttext += input.slice(anchor, ++index);\n\t\t\t\t\t\t\tanchor = index + 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\ttext += input.slice(anchor, index);\n\t\t\t\tanchor = ++index;\n\t\t\t}\n\t\t}\n\n\t\t++index;\n\t}\n\n\ttext += input.slice(anchor, index);\n\treturn text;\n}\n\nfunction parseMessages(input: string, offset: number, placeholder: Placeholder, firstKey: string) {\n\tconst { length } = input;\n\tconst messages: Messages = {};\n\tplaceholder.push(messages);\n\n\tlet key = firstKey;\n\tlet char;\n\tlet ast: AST = [];\n\tlet index = parseAST(input, offset, ast, true);\n\tmessages[key] = ast;\n\n\twhile (index < length) {\n\t\tindex = skipWhitespace(input, index);\n\t\tchar = input[index];\n\t\tif (char === C_SEPARATOR || char === C_PLACEHOLDER_CLOSE) {\n\t\t\tbreak;\n\t\t}\n\n\t\tkey = parseIdentifier(input, index);\n\t\tindex = skipWhitespace(input, index + key.length);\n\n\t\tchar = input[index];\n\t\tif (char !== C_PLACEHOLDER_OPEN) {\n\t\t\tthrow new ParseError(`expected '${C_PLACEHOLDER_OPEN}'`, input, index);\n\t\t}\n\n\t\tast = [];\n\t\tindex = parseAST(input, index + 1, ast, true);\n\t\tmessages[key] = ast;\n\t}\n\n\treturn index;\n}\n\nfunction parseMessagesWithAttributes(input: string, offset: number, placeholder: Placeholder, firstKey: string) {\n\tconst { length } = input;\n\tconst attributes: Attributes = {};\n\tplaceholder.push(attributes);\n\n\tlet key = firstKey;\n\tlet char;\n\tlet index = skipWhitespace(input, offset);\n\tlet value = parseIdentifier(input, index);\n\tindex += value.length;\n\tattributes[key] = value;\n\n\twhile (index < length) {\n\t\tindex = skipWhitespace(input, index);\n\t\tchar = input[index];\n\t\tif (char === C_SEPARATOR || char === C_PLACEHOLDER_CLOSE) {\n\t\t\tbreak;\n\t\t}\n\n\t\tkey = parseIdentifier(input, index);\n\t\tindex = skipWhitespace(input, index + key.length);\n\n\t\tchar = input[index];\n\t\tif (char === C_PLACEHOLDER_OPEN) {\n\t\t\treturn parseMessages(input, index + 1, placeholder, key);\n\t\t}\n\n\t\tif (char !== C_ATTRIBUTE) {\n\t\t\tthrow new ParseError(`expected '${C_ATTRIBUTE}' or '${C_PLACEHOLDER_OPEN}'`, input, index);\n\t\t}\n\n\t\tindex = skipWhitespace(input, index + 1);\n\t\tvalue = parseIdentifier(input, index);\n\t\tindex += value.length;\n\n\t\tattributes[key] = value;\n\t}\n\n\treturn index;\n}\n\nfunction parsePlaceholder(input: string, offset: number, placeholder: Placeholder) {\n\tlet index = offset;\n\tlet char = input[index];\n\n\tif (char === C_OCTOTHORPE) {\n\t\tplaceholder.push('#');\n\t\treturn index + 1;\n\t}\n\n\tif (char !== C_PLACEHOLDER_OPEN) {\n\t\tthrow new ParseError(`expected '${C_OCTOTHORPE}' or '${C_PLACEHOLDER_OPEN}'`, input, index);\n\t}\n\n\tconst { length } = input;\n\n\tdo {\n\t\tindex = skipWhitespace(input, index + 1);\n\t\tconst id = parseIdentifier(input, index);\n\t\tindex = skipWhitespace(input, index + id.length);\n\n\t\tchar = input[index];\n\t\tswitch (char) {\n\t\t\tcase C_SEPARATOR:\n\t\t\tcase C_PLACEHOLDER_CLOSE:\n\t\t\t\tplaceholder.push(id);\n\t\t\t\tbreak;\n\n\t\t\tcase C_PLACEHOLDER_OPEN:\n\t\t\t\tif (placeholder.length < 2) {\n\t\t\t\t\tthrow new ParseError('expected an identifier but saw a message instead', input, index);\n\t\t\t\t}\n\n\t\t\t\tindex = parseMessages(input, index + 1, placeholder, id);\n\t\t\t\tchar = input[index];\n\t\t\t\tbreak;\n\n\t\t\tcase C_ATTRIBUTE:\n\t\t\t\tif (placeholder.length < 2) {\n\t\t\t\t\tthrow new ParseError('expected an identifier but saw an attribute instead', input, index);\n\t\t\t\t}\n\n\t\t\t\tindex = parseMessagesWithAttributes(input, index + 1, placeholder, id);\n\t\t\t\tchar = input[index];\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tthrow new ParseError(`unexpected character '${char}'`, input, index);\n\t\t}\n\t}\n\twhile (index < length && char !== C_PLACEHOLDER_CLOSE);\n\n\treturn index + 1;\n}\n\nfunction parseAST(input: string, offset: number, ast: AST, isWithinPlaceholder: boolean) {\n\tlet char;\n\tlet index = offset;\n\tlet text = parseText(input, index, isWithinPlaceholder);\n\n\tif (text) {\n\t\tast.push(text);\n\t\tindex += text.length;\n\t}\n\n\tconst { length } = input;\n\twhile (index < length) {\n\t\tchar = input[index];\n\t\tif (char === C_PLACEHOLDER_CLOSE) {\n\t\t\tif (!isWithinPlaceholder) {\n\t\t\t\tthrow new ParseError(`unexpected '${C_PLACEHOLDER_CLOSE}'`, input, index);\n\t\t\t}\n\n\t\t\t++index;\n\t\t\tbreak;\n\t\t}\n\n\t\tconst placeholder: any = [];\n\t\tindex = parsePlaceholder(input, index, placeholder);\n\t\tast.push(placeholder);\n\n\t\ttext = parseText(input, index, isWithinPlaceholder);\n\t\tif (text) {\n\t\t\tast.push(text);\n\t\t\tindex += text.length;\n\t\t}\n\t}\n\n\treturn index;\n}\n\nexport function parse(input: string) {\n\tconst ast: AST = [];\n\tparseAST(input, 0, ast, false);\n\treturn ast;\n}\n", "import type { TranslationMap } from '~/types';\n\nfunction flattenTranslationMapInto(\n\tsource: TranslationMap,\n\tdestination: Record<string, string | undefined>,\n\tprefix: string\n) {\n\tfor (const key in source) {\n\t\tif (key.startsWith('$')) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tconst value = source[key];\n\t\tswitch (typeof value) {\n\t\t\tcase 'string':\n\t\t\t\tdestination[prefix + key] = value;\n\t\t\t\tbreak;\n\n\t\t\tcase 'object':\n\t\t\t\tif (value !== null) {\n\t\t\t\t\tflattenTranslationMapInto(value, destination, `${prefix}${key}.`);\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn destination;\n}\n\nexport function flattenTranslationMap(map: TranslationMap): Record<string, string | undefined> {\n\treturn flattenTranslationMapInto(map, {}, '');\n}\n\nexport function mapObjectValues<TKey extends keyof any, TIn, TOut>(source: Record<TKey, TIn>, callback: (value: TIn, key: TKey) => TOut) {\n\tconst result = {} as Record<TKey, TOut>;\n\tfor (const key in source) {\n\t\tif (Object.prototype.hasOwnProperty.call(source, key)) {\n\t\t\tresult[key] = callback(source[key], key);\n\t\t}\n\t}\n\n\treturn result;\n}\n", "import type { AST, Element } from './parser/parser';\nimport type { FormatProvider, Interpreter, Vars, PlaceholderExpansion } from './types';\n\nexport class DefaultInterpreter implements Interpreter {\n\tpublic constructor(\n\t\tprivate readonly formatProvider: FormatProvider\n\t) {}\n\n\tpublic interpret(ast: AST, octothorpeParam?: string): PlaceholderExpansion {\n\t\tconst { length } = ast;\n\t\tif (length === 1) {\n\t\t\treturn this.interpretElement(ast[0], octothorpeParam);\n\t\t}\n\n\t\tconst placeholders = new Array<PlaceholderExpansion>(length);\n\t\tfor (let i = 0; i < length; ++i) {\n\t\t\tplaceholders[i] = this.interpretElement(ast[i], octothorpeParam);\n\t\t}\n\n\t\treturn formatAndJoin.bind(null, placeholders);\n\t}\n\n\tprivate interpretElement(element: Element, octothorpeParam?: string) {\n\t\tif (typeof element === 'string') {\n\t\t\treturn () => element;\n\t\t}\n\n\t\tlet placeholder = element;\n\t\tif (placeholder.length === 1 && placeholder[0] === '#') {\n\t\t\tif (octothorpeParam === undefined) {\n\t\t\t\treturn () => '#';\n\t\t\t}\n\n\t\t\tplaceholder = [ octothorpeParam ];\n\t\t}\n\n\t\treturn this.formatProvider.getFormat(placeholder)(placeholder, this);\n\t}\n}\n\nfunction formatAndJoin(placeholders: readonly PlaceholderExpansion[], vars?: Vars) {\n\tlet str = '';\n\tfor (let i = 0; i < placeholders.length; ++i) {\n\t\tstr += placeholders[i](vars);\n\t}\n\n\treturn str;\n}\n", "import type { Placeholder } from './parser/parser';\nimport { TranslationError } from './TranslationError';\nimport type { Format, FormatProvider } from './types';\nimport { getFormatName } from './utils/placeholder';\n\nexport class MappedFormatProvider implements FormatProvider {\n\tpublic constructor(\n\t\tprivate readonly formatMap: Record<string, Format | undefined>\n\t) {}\n\n\tpublic getFormat(placeholder: Placeholder): Format {\n\t\tconst name = getFormatName(placeholder);\n\t\tconst format = this.formatMap[name];\n\t\tif (!format) {\n\t\t\tthrow new TranslationError(TranslationError.FORMAT_UNAVAILABLE, name);\n\t\t}\n\n\t\treturn format;\n\t}\n}\n", "import { DefaultInterpreter } from './DefaultInterpreter';\nimport * as builtInFormats from './format';\nimport { MappedFormatProvider } from './MappedFormatProvider';\nimport { parse } from './parser/parser';\nimport { TranslationError } from './TranslationError';\nimport type { FormatFactory, Interpreter, Locale, PlaceholderExpansion, TranslationMap, TranslationProvider, Vars } from './types';\nimport { flattenTranslationMap, mapObjectValues } from './utils/mapping';\n\nexport enum CacheMode {\n\t/**\n\t * All phrases are interpreted and cached immediately upon construction.\n\t *\n\t * Useful to detect any syntax errors right away and avoid parsing during\n\t * app runtime.\n\t */\n\tEager,\n\n\t/**\n\t * Phrases are interpreted on-demand, then cached. This is a balanced\n\t * compromise between the `Eager` and `Off` suitable for most apps.\n\t *\n\t * This is the default mode.\n\t */\n\tLazy,\n\n\t/**\n\t * Each time a translation is requested, it is interpreted anew; No caching\n\t * takes place.\n\t *\n\t * Useful to lower memory usage when individual phrases are only used\n\t * scarcely.\n\t */\n\tOff\n}\n\nexport interface CachedTranslationProviderArgs {\n\tcacheMode?: CacheMode;\n\tinterpreter: Interpreter;\n\ttranslations: TranslationMap;\n}\n\nexport class CachedTranslationProvider implements TranslationProvider {\n\tprivate readonly cacheMode: CacheMode;\n\tprivate readonly expansions: Record<string, PlaceholderExpansion | string | undefined>;\n\tprivate readonly interpreter: Interpreter;\n\n\tpublic constructor({ cacheMode, interpreter, translations }: CachedTranslationProviderArgs) {\n\t\tthis.cacheMode = cacheMode ?? CacheMode.Lazy;\n\t\tthis.interpreter = interpreter;\n\t\tthis.expansions = flattenTranslationMap(translations);\n\n\t\tif (cacheMode === CacheMode.Eager) {\n\t\t\tthis.expansions = mapObjectValues(this.expansions, phrase => interpreter.interpret(parse(phrase as string)));\n\t\t}\n\t}\n\n\tpublic expand(key: string, vars?: Vars) {\n\t\tlet expand = this.expansions[key];\n\t\tif (expand === undefined) {\n\t\t\tthrow new TranslationError(TranslationError.KEY_NOT_FOUND, key);\n\t\t}\n\n\t\tif (typeof expand === 'string') {\n\t\t\texpand = this.interpreter.interpret(parse(expand));\n\t\t\tif (this.cacheMode !== CacheMode.Off) {\n\t\t\t\tthis.expansions[key] = expand;\n\t\t\t}\n\t\t}\n\n\t\treturn expand(vars);\n\t}\n\n\tpublic static fromLocale(locale: Locale, formats: Record<string, FormatFactory<any>> = builtInFormats) {\n\t\tconst formatMap = mapObjectValues(formats, (factory, formatName) => factory(locale.$format?.[formatName]));\n\t\tconst formatProvider = new MappedFormatProvider(formatMap);\n\t\treturn new CachedTranslationProvider({\n\t\t\tcacheMode: CacheMode.Lazy,\n\t\t\tinterpreter: new DefaultInterpreter(formatProvider),\n\t\t\ttranslations: locale\n\t\t});\n\t}\n}\n", "import { options } from 'preact';\n\n/** @type {number} */\nlet currentIndex;\n\n/** @type {import('./internal').Component} */\nlet currentComponent;\n\n/** @type {number} */\nlet currentHook = 0;\n\n/** @type {Array<import('./internal').Component>} */\nlet afterPaintEffects = [];\n\nlet oldBeforeDiff = options._diff;\nlet oldBeforeRender = options._render;\nlet oldAfterDiff = options.diffed;\nlet oldCommit = options._commit;\nlet oldBeforeUnmount = options.unmount;\n\nconst RAF_TIMEOUT = 100;\nlet prevRaf;\n\noptions._diff = vnode => {\n\tcurrentComponent = null;\n\tif (oldBeforeDiff) oldBeforeDiff(vnode);\n};\n\noptions._render = vnode => {\n\tif (oldBeforeRender) oldBeforeRender(vnode);\n\n\tcurrentComponent = vnode._component;\n\tcurrentIndex = 0;\n\n\tconst hooks = currentComponent.__hooks;\n\tif (hooks) {\n\t\thooks._pendingEffects.forEach(invokeCleanup);\n\t\thooks._pendingEffects.forEach(invokeEffect);\n\t\thooks._pendingEffects = [];\n\t}\n};\n\noptions.diffed = vnode => {\n\tif (oldAfterDiff) oldAfterDiff(vnode);\n\n\tconst c = vnode._component;\n\tif (c && c.__hooks && c.__hooks._pendingEffects.length) {\n\t\tafterPaint(afterPaintEffects.push(c));\n\t}\n\tcurrentComponent = null;\n};\n\noptions._commit = (vnode, commitQueue) => {\n\tcommitQueue.some(component => {\n\t\ttry {\n\t\t\tcomponent._renderCallbacks.forEach(invokeCleanup);\n\t\t\tcomponent._renderCallbacks = component._renderCallbacks.filter(cb =>\n\t\t\t\tcb._value ? invokeEffect(cb) : true\n\t\t\t);\n\t\t} catch (e) {\n\t\t\tcommitQueue.some(c => {\n\t\t\t\tif (c._renderCallbacks) c._renderCallbacks = [];\n\t\t\t});\n\t\t\tcommitQueue = [];\n\t\t\toptions._catchError(e, component._vnode);\n\t\t}\n\t});\n\n\tif (oldCommit) oldCommit(vnode, commitQueue);\n};\n\noptions.unmount = vnode => {\n\tif (oldBeforeUnmount) oldBeforeUnmount(vnode);\n\n\tconst c = vnode._component;\n\tif (c && c.__hooks) {\n\t\tlet hasErrored;\n\t\tc.__hooks._list.forEach(s => {\n\t\t\ttry {\n\t\t\t\tinvokeCleanup(s);\n\t\t\t} catch (e) {\n\t\t\t\thasErrored = e;\n\t\t\t}\n\t\t});\n\t\tif (hasErrored) options._catchError(hasErrored, c._vnode);\n\t}\n};\n\n/**\n * Get a hook's state from the currentComponent\n * @param {number} index The index of the hook to get\n * @param {number} type The index of the hook to get\n * @returns {any}\n */\nfunction getHookState(index, type) {\n\tif (options._hook) {\n\t\toptions._hook(currentComponent, index, currentHook || type);\n\t}\n\tcurrentHook = 0;\n\n\t// Largely inspired by:\n\t// * https://github.com/michael-klein/funcy.js/blob/f6be73468e6ec46b0ff5aa3cc4c9baf72a29025a/src/hooks/core_hooks.mjs\n\t// * https://github.com/michael-klein/funcy.js/blob/650beaa58c43c33a74820a3c98b3c7079cf2e333/src/renderer.mjs\n\t// Other implementations to look at:\n\t// * https://codesandbox.io/s/mnox05qp8\n\tconst hooks =\n\t\tcurrentComponent.__hooks ||\n\t\t(currentComponent.__hooks = {\n\t\t\t_list: [],\n\t\t\t_pendingEffects: []\n\t\t});\n\n\tif (index >= hooks._list.length) {\n\t\thooks._list.push({});\n\t}\n\treturn hooks._list[index];\n}\n\n/**\n * @param {import('./index').StateUpdater<any>} [initialState]\n */\nexport function useState(initialState) {\n\tcurrentHook = 1;\n\treturn useReducer(invokeOrReturn, initialState);\n}\n\n/**\n * @param {import('./index').Reducer<any, any>} reducer\n * @param {import('./index').StateUpdater<any>} initialState\n * @param {(initialState: any) => void} [init]\n * @returns {[ any, (state: any) => void ]}\n */\nexport function useReducer(reducer, initialState, init) {\n\t/** @type {import('./internal').ReducerHookState} */\n\tconst hookState = getHookState(currentIndex++, 2);\n\thookState._reducer = reducer;\n\tif (!hookState._component) {\n\t\thookState._value = [\n\t\t\t!init ? invokeOrReturn(undefined, initialState) : init(initialState),\n\n\t\t\taction => {\n\t\t\t\tconst nextValue = hookState._reducer(hookState._value[0], action);\n\t\t\t\tif (hookState._value[0] !== nextValue) {\n\t\t\t\t\thookState._value = [nextValue, hookState._value[1]];\n\t\t\t\t\thookState._component.setState({});\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\n\t\thookState._component = currentComponent;\n\t}\n\n\treturn hookState._value;\n}\n\n/**\n * @param {import('./internal').Effect} callback\n * @param {any[]} args\n */\nexport function useEffect(callback, args) {\n\t/** @type {import('./internal').EffectHookState} */\n\tconst state = getHookState(currentIndex++, 3);\n\tif (!options._skipEffects && argsChanged(state._args, args)) {\n\t\tstate._value = callback;\n\t\tstate._args = args;\n\n\t\tcurrentComponent.__hooks._pendingEffects.push(state);\n\t}\n}\n\n/**\n * @param {import('./internal').Effect} callback\n * @param {any[]} args\n */\nexport function useLayoutEffect(callback, args) {\n\t/** @type {import('./internal').EffectHookState} */\n\tconst state = getHookState(currentIndex++, 4);\n\tif (!options._skipEffects && argsChanged(state._args, args)) {\n\t\tstate._value = callback;\n\t\tstate._args = args;\n\n\t\tcurrentComponent._renderCallbacks.push(state);\n\t}\n}\n\nexport function useRef(initialValue) {\n\tcurrentHook = 5;\n\treturn useMemo(() => ({ current: initialValue }), []);\n}\n\n/**\n * @param {object} ref\n * @param {() => object} createHandle\n * @param {any[]} args\n */\nexport function useImperativeHandle(ref, createHandle, args) {\n\tcurrentHook = 6;\n\tuseLayoutEffect(\n\t\t() => {\n\t\t\tif (typeof ref == 'function') ref(createHandle());\n\t\t\telse if (ref) ref.current = createHandle();\n\t\t},\n\t\targs == null ? args : args.concat(ref)\n\t);\n}\n\n/**\n * @param {() => any} factory\n * @param {any[]} args\n */\nexport function useMemo(factory, args) {\n\t/** @type {import('./internal').MemoHookState} */\n\tconst state = getHookState(currentIndex++, 7);\n\tif (argsChanged(state._args, args)) {\n\t\tstate._value = factory();\n\t\tstate._args = args;\n\t\tstate._factory = factory;\n\t}\n\n\treturn state._value;\n}\n\n/**\n * @param {() => void} callback\n * @param {any[]} args\n */\nexport function useCallback(callback, args) {\n\tcurrentHook = 8;\n\treturn useMemo(() => callback, args);\n}\n\n/**\n * @param {import('./internal').PreactContext} context\n */\nexport function useContext(context) {\n\tconst provider = currentComponent.context[context._id];\n\t// We could skip this call here, but than we'd not call\n\t// `options._hook`. We need to do that in order to make\n\t// the devtools aware of this hook.\n\t/** @type {import('./internal').ContextHookState} */\n\tconst state = getHookState(currentIndex++, 9);\n\t// The devtools needs access to the context object to\n\t// be able to pull of the default value when no provider\n\t// is present in the tree.\n\tstate._context = context;\n\tif (!provider) return context._defaultValue;\n\t// This is probably not safe to convert to \"!\"\n\tif (state._value == null) {\n\t\tstate._value = true;\n\t\tprovider.sub(currentComponent);\n\t}\n\treturn provider.props.value;\n}\n\n/**\n * Display a custom label for a custom hook for the devtools panel\n * @type {<T>(value: T, cb?: (value: T) => string | number) => void}\n */\nexport function useDebugValue(value, formatter) {\n\tif (options.useDebugValue) {\n\t\toptions.useDebugValue(formatter ? formatter(value) : value);\n\t}\n}\n\n/**\n * @param {(error: any) => void} cb\n */\nexport function useErrorBoundary(cb) {\n\t/** @type {import('./internal').ErrorBoundaryHookState} */\n\tconst state = getHookState(currentIndex++, 10);\n\tconst errState = useState();\n\tstate._value = cb;\n\tif (!currentComponent.componentDidCatch) {\n\t\tcurrentComponent.componentDidCatch = err => {\n\t\t\tif (state._value) state._value(err);\n\t\t\terrState[1](err);\n\t\t};\n\t}\n\treturn [\n\t\terrState[0],\n\t\t() => {\n\t\t\terrState[1](undefined);\n\t\t}\n\t];\n}\n\n/**\n * After paint effects consumer.\n */\nfunction flushAfterPaintEffects() {\n\tlet component;\n\twhile ((component = afterPaintEffects.shift())) {\n\t\tif (!component._parentDom) continue;\n\t\ttry {\n\t\t\tcomponent.__hooks._pendingEffects.forEach(invokeCleanup);\n\t\t\tcomponent.__hooks._pendingEffects.forEach(invokeEffect);\n\t\t\tcomponent.__hooks._pendingEffects = [];\n\t\t} catch (e) {\n\t\t\tcomponent.__hooks._pendingEffects = [];\n\t\t\toptions._catchError(e, component._vnode);\n\t\t}\n\t}\n}\n\nlet HAS_RAF = typeof requestAnimationFrame == 'function';\n\n/**\n * Schedule a callback to be invoked after the browser has a chance to paint a new frame.\n * Do this by combining requestAnimationFrame (rAF) + setTimeout to invoke a callback after\n * the next browser frame.\n *\n * Also, schedule a timeout in parallel to the the rAF to ensure the callback is invoked\n * even if RAF doesn't fire (for example if the browser tab is not visible)\n *\n * @param {() => void} callback\n */\nfunction afterNextFrame(callback) {\n\tconst done = () => {\n\t\tclearTimeout(timeout);\n\t\tif (HAS_RAF) cancelAnimationFrame(raf);\n\t\tsetTimeout(callback);\n\t};\n\tconst timeout = setTimeout(done, RAF_TIMEOUT);\n\n\tlet raf;\n\tif (HAS_RAF) {\n\t\traf = requestAnimationFrame(done);\n\t}\n}\n\n// Note: if someone used options.debounceRendering = requestAnimationFrame,\n// then effects will ALWAYS run on the NEXT frame instead of the current one, incurring a ~16ms delay.\n// Perhaps this is not such a big deal.\n/**\n * Schedule afterPaintEffects flush after the browser paints\n * @param {number} newQueueLength\n */\nfunction afterPaint(newQueueLength) {\n\tif (newQueueLength === 1 || prevRaf !== options.requestAnimationFrame) {\n\t\tprevRaf = options.requestAnimationFrame;\n\t\t(prevRaf || afterNextFrame)(flushAfterPaintEffects);\n\t}\n}\n\n/**\n * @param {import('./internal').EffectHookState} hook\n */\nfunction invokeCleanup(hook) {\n\t// A hook cleanup can introduce a call to render which creates a new root, this will call options.vnode\n\t// and move the currentComponent away.\n\tconst comp = currentComponent;\n\tlet cleanup = hook._cleanup;\n\tif (typeof cleanup == 'function') {\n\t\thook._cleanup = undefined;\n\t\tcleanup();\n\t}\n\tcurrentComponent = comp;\n}\n\n/**\n * Invoke a Hook's effect\n * @param {import('./internal').EffectHookState} hook\n */\nfunction invokeEffect(hook) {\n\t// A hook call can introduce a call to render which creates a new root, this will call options.vnode\n\t// and move the currentComponent away.\n\tconst comp = currentComponent;\n\thook._cleanup = hook._value();\n\tcurrentComponent = comp;\n}\n\n/**\n * @param {any[]} oldArgs\n * @param {any[]} newArgs\n */\nfunction argsChanged(oldArgs, newArgs) {\n\treturn (\n\t\t!oldArgs ||\n\t\toldArgs.length !== newArgs.length ||\n\t\tnewArgs.some((arg, index) => arg !== oldArgs[index])\n\t);\n}\n\nfunction invokeOrReturn(arg, f) {\n\treturn typeof f == 'function' ? f(arg) : f;\n}\n", "import { FormatFactory, ParseError, TranslationError, CachedTranslationProvider, Vars, TranslationProvider } from '@calmdownval/intl';\nimport { Component, createContext, h } from 'preact';\n\nexport interface Translation {\n\treadonly key: string;\n\treadonly vars?: Vars;\n}\n\nexport interface TranslateFn {\n\t(key: string, vars?: Vars): string;\n\t(translation: Translation): string;\n}\n\nexport interface Intl {\n\treadonly isLoading: boolean;\n\treadonly t: TranslateFn;\n}\n\nexport interface IntlProviderProps {\n\treadonly credentials?: RequestInit['credentials'];\n\treadonly formats?: Record<string, FormatFactory<any>>;\n\treadonly headers?: RequestInit['headers'];\n\treadonly onError?: (ex: Error) => void;\n\treadonly url: string;\n}\n\nconst WARNING_EMOJI = '\\u26a0\\ufe0f';\nconst INITIAL_STATE: Intl = {\n\tisLoading: true,\n\tt: () => ''\n};\n\nexport const IntlContext = createContext<Intl>(INITIAL_STATE);\n\nexport class IntlProvider extends Component<IntlProviderProps, Intl> {\n\tpublic state = INITIAL_STATE;\n\tprivate pendingFetch?: AbortController;\n\n\tpublic componentDidMount() {\n\t\tvoid this.fetchLocale();\n\t}\n\n\tpublic componentDidUpdate(prev: IntlProviderProps) {\n\t\tconst next = this.props;\n\t\tif (prev.url !== next.url) {\n\t\t\tvoid this.fetchLocale();\n\t\t}\n\t}\n\n\tpublic componentWillUnmount() {\n\t\tthis.pendingFetch?.abort();\n\t}\n\n\tpublic render() {\n\t\treturn h(IntlContext.Provider, {\n\t\t\tchildren: this.props.children,\n\t\t\tvalue: this.state\n\t\t});\n\t}\n\n\tprivate async fetchLocale() {\n\t\ttry {\n\t\t\tthis.setState(INITIAL_STATE);\n\t\t\tthis.pendingFetch = new AbortController();\n\n\t\t\tconst { credentials, headers, url } = this.props;\n\t\t\tconst response = await fetch(url, {\n\t\t\t\tcredentials,\n\t\t\t\theaders,\n\t\t\t\tmethod: 'GET',\n\t\t\t\tsignal: this.pendingFetch.signal\n\t\t\t});\n\n\t\t\tif (!response.ok) {\n\t\t\t\tthrow new Error(`unexpected HTTP response ${response.status} - ${response.statusText}`);\n\t\t\t}\n\n\t\t\tconst locale = await response.json();\n\t\t\tconst manager = CachedTranslationProvider.fromLocale(locale, this.props.formats);\n\n\t\t\tthis.setState({\n\t\t\t\tisLoading: false,\n\t\t\t\tt: translate.bind(null, manager)\n\t\t\t});\n\t\t}\n\t\tcatch (ex: any) {\n\t\t\tthis.props.onError?.(ex);\n\t\t\tthis.setState({\n\t\t\t\tisLoading: false,\n\t\t\t\tt: () => ''\n\t\t\t});\n\t\t}\n\t\tfinally {\n\t\t\tthis.pendingFetch = undefined;\n\t\t}\n\t}\n}\n\nfunction translate(provider: TranslationProvider, keyOrTranslation: string | Translation, vars?: Vars) {\n\ttry {\n\t\treturn typeof keyOrTranslation === 'string'\n\t\t\t? provider.expand(keyOrTranslation, vars)\n\t\t\t: provider.expand(keyOrTranslation.key, keyOrTranslation.vars);\n\t}\n\tcatch (ex) {\n\t\tlet message;\n\t\tif (TranslationError.is(ex)) {\n\t\t\tmessage = ex.message;\n\t\t}\n\t\telse if (ParseError.is(ex)) {\n\t\t\tmessage = 'ParseError';\n\t\t}\n\t\telse {\n\t\t\tmessage = 'UnknownError';\n\t\t}\n\n\t\treturn `${WARNING_EMOJI} ${message}`;\n\t}\n}\n", "import { useContext } from 'preact/hooks';\n\nimport { Intl, IntlContext } from './IntlProvider';\n\nexport function useIntl(): Intl {\n\treturn useContext(IntlContext);\n}\n", "import { h } from 'preact';\n\nimport './BoxDecorator.css';\n\nexport const BoxDecorator = () => (\n\t<div class='box-decorator' />\n);\n", "export function bem(componentName: string, modifiers: Record<string, boolean | null | undefined>) {\n\tlet classNames = componentName;\n\tfor (const modifier in modifiers) {\n\t\tif (modifiers[modifier]) {\n\t\t\tclassNames += ` ${componentName}--${modifier}`;\n\t\t}\n\t}\n\n\treturn classNames;\n}\n\nexport function cx(...classNames: (string | null | undefined)[]): string;\nexport function cx() {\n\tconst { length } = arguments;\n\n\tlet classNames = '';\n\tfor (let arg, i = 0; i < length; ++i) {\n\t\tif ((arg = arguments[i])) {\n\t\t\tclassNames += (classNames && ' ') + arg;\n\t\t}\n\t}\n\n\treturn classNames;\n}\n", "import { useEffect, useReducer } from 'preact/hooks';\n\nfunction wrapReducer<T>(_state: [ T ], nextValue: T): [ T ] {\n\treturn [ nextValue ];\n}\n\nexport function useUiValue<T>(logicalValue: T) {\n\tconst wrapped: [ T ] = [ logicalValue ];\n\tconst uiState = useReducer<[ T ], T>(wrapReducer, wrapped);\n\tuseEffect(() => {\n\t\tif (uiState[0][0] !== logicalValue) {\n\t\t\tuiState[1](logicalValue);\n\t\t}\n\t}, wrapped);\n\n\treturn [ uiState[0][0], uiState[1] ] as const;\n}\n", "/* eslint-disable @typescript-eslint/prefer-string-starts-ends-with */\n\n// This implementation represents arbitrarily large and/or precise numbers as\n// strings. They always conform to the format: /^-?[0-9]+(\\.[0-9]+)?$/\n\nexport interface DecimalParseInfo {\n\tisNegative: boolean;\n\tisZero: boolean;\n\tseparatorAt: number;\n}\n\nexport function normalizeDecimal(value: string, parseInfo?: DecimalParseInfo) {\n\tconst isNegative = value[0] === '-';\n\tlet i = isNegative ? 1 : 0;\n\twhile (i < value.length && value[i] === '0') {\n\t\t++i;\n\t}\n\n\tconst start = i;\n\twhile (i < value.length && value[i] !== '.') {\n\t\t++i;\n\t}\n\n\tconst sep = i;\n\ti = value.length - 1;\n\twhile (i > sep && value[i] === '0') {\n\t\t--i;\n\t}\n\n\tconst end = i === sep ? i : i + 1;\n\tconst trimmed = value.slice(start, end);\n\tif (start === end) {\n\t\tif (parseInfo) {\n\t\t\tparseInfo.isNegative = false;\n\t\t\tparseInfo.isZero = true;\n\t\t\tparseInfo.separatorAt = 1;\n\t\t}\n\n\t\treturn '0';\n\t}\n\n\tconst sign = (isNegative ? '-' : '') + (start === sep && sep !== end ? '0' : '');\n\tif (parseInfo) {\n\t\tparseInfo.isNegative = isNegative;\n\t\tparseInfo.isZero = false;\n\t\tparseInfo.separatorAt = sign.length + sep - start;\n\t}\n\n\treturn sign + trimmed;\n}\n\nexport function compareDecimal(a: string, b: string) {\n\tconst aInfo = {} as DecimalParseInfo;\n\tconst aNorm = normalizeDecimal(a, aInfo);\n\tconst bInfo = {} as DecimalParseInfo;\n\tconst bNorm = normalizeDecimal(b, bInfo);\n\tconst flip = aInfo.isNegative ? -1 : +1;\n\n\tif (aInfo.isNegative !== bInfo.isNegative) {\n\t\treturn aInfo.isZero && bInfo.isZero ? 0 : flip;\n\t}\n\n\tif (aInfo.separatorAt !== bInfo.separatorAt) {\n\t\treturn flip * (aInfo.separatorAt - bInfo.separatorAt);\n\t}\n\n\tlet i = aInfo.isNegative ? 1 : 0;\n\tlet diff;\n\tdo {\n\t\tdiff = aNorm.charCodeAt(i) - bNorm.charCodeAt(i);\n\t}\n\twhile (diff === 0 && ++i < aInfo.separatorAt);\n\n\tconst end = Math.max(aNorm.length, bNorm.length);\n\twhile (diff === 0 && ++i < end) {\n\t\tdiff = (i < aNorm.length ? aNorm.charCodeAt(i) : 48) - (i < bNorm.length ? bNorm.charCodeAt(i) : 48);\n\t}\n\n\treturn flip * diff;\n}\n", "import { h } from 'preact';\nimport { useLayoutEffect, useRef } from 'preact/hooks';\n\nimport { BoxDecorator } from '~/components/BoxDecorator';\nimport { bem, cx } from '~/utils/style';\n\nimport type { InputProps } from '../types';\nimport { useUiValue } from '../useUiValue';\nimport { compareDecimal, normalizeDecimal } from './decimal';\n\nimport './NumberField.css';\n\ninterface Caret {\n\tindex: number;\n}\n\ninterface ParsedDecimal {\n\treadonly sign: string;\n\treadonly significant: string;\n\treadonly separator: string;\n\treadonly fractional: string;\n\treadonly concat: string;\n}\n\nconst RE_DECIMAL = /^\\s*-?[0-9\\s]*(?:\\s*[.,][0-9\\s]*)?$/;\nconst FALLBACK: ParsedDecimal = {\n\tsign: '',\n\tsignificant: '0',\n\tseparator: '',\n\tfractional: '',\n\tconcat: '0'\n};\n\nfunction parseDecimal(input: string | undefined, maxSignificant: number, maxFractional: number, caret: Caret): ParsedDecimal {\n\tif (!input || !RE_DECIMAL.test(input)) {\n\t\tcaret.index = 1;\n\t\treturn FALLBACK;\n\t}\n\n\tlet sign = '';\n\tlet separator = '';\n\tlet separatorAt = -1;\n\tlet concat = '';\n\n\tlet anchor = 0;\n\tlet index = 0;\n\tlet preCaretSkipped = 0;\n\tlet totalSkipped = 0;\n\n\tconst commit = () => {\n\t\tconcat += input.slice(anchor, index);\n\t\tanchor = index + 1;\n\t};\n\n\twhile (index < input.length) {\n\t\tconst cc = input.charCodeAt(index);\n\t\tif (cc === 46 || cc === 44) {\n\t\t\tseparator = '.';\n\t\t\tseparatorAt = index - totalSkipped;\n\t\t}\n\t\telse if (cc < 48 || cc > 57) {\n\t\t\tcommit();\n\t\t\t++totalSkipped;\n\t\t\tif (cc === 45) {\n\t\t\t\tsign = '-';\n\t\t\t}\n\t\t\telse if (index < caret.index) {\n\t\t\t\t++preCaretSkipped;\n\t\t\t}\n\t\t}\n\n\t\t++index;\n\t}\n\n\tcommit();\n\tcaret.index -= preCaretSkipped;\n\n\tif (separatorAt === -1) {\n\t\tseparatorAt = concat.length;\n\t}\n\n\tlet significant = concat.slice(0, separatorAt) || '0';\n\tif (maxSignificant >= 1) {\n\t\tif (caret.index > maxSignificant) {\n\t\t\tcaret.index -= Math.max(significant.length - maxSignificant, 0);\n\t\t}\n\n\t\tsignificant = significant.slice(0, maxSignificant);\n\t}\n\n\tlet fractional = concat.slice(separatorAt + 1);\n\tif (maxFractional >= 0) {\n\t\tfractional = fractional.slice(0, maxFractional);\n\t\tif (maxFractional === 0) {\n\t\t\tseparator = '';\n\t\t}\n\t}\n\n\treturn {\n\t\tsign,\n\t\tseparator,\n\t\tsignificant,\n\t\tfractional,\n\t\tconcat\n\t};\n}\n\nfunction splitGroups(input: string, groupSize: number, groupOffset: number, caret?: Caret) {\n\tlet result = input;\n\tlet index = input.length + (groupOffset - 1) % groupSize + 1;\n\n\twhile (index > groupSize) {\n\t\tindex -= groupSize;\n\t\tresult = result.slice(0, index) + ' ' + result.slice(index);\n\t\tif (caret && index < caret.index) {\n\t\t\t++caret.index;\n\t\t}\n\t}\n\n\treturn result;\n}\n\nexport interface NumberFieldProps extends InputProps<string> {\n\treadonly minValue?: string;\n\treadonly maxValue?: string;\n\treadonly maxSignificant?: number;\n\treadonly maxFractional?: number;\n\treadonly groupBy?: number;\n}\n\nexport const NumberField = (props: NumberFieldProps) => {\n\tconst ref = useRef<HTMLInputElement | null>(null);\n\tconst [ uiValue, setUiValue ] = useUiValue(props.value ?? '');\n\n\tconst { groupBy = 0, maxFractional = -1, maxSignificant = -1 } = props;\n\tconst caret: Caret = {\n\t\tindex: ref.current?.selectionStart ?? 0\n\t};\n\n\tconst isEmpty = !uiValue || uiValue === '0' || uiValue === '-0';\n\tconst uiValueParsed = parseDecimal(uiValue, maxSignificant, maxFractional, caret);\n\tconst uiValueFormatted =\n\t\t(groupBy > 0 ? splitGroups(uiValueParsed.significant, groupBy, 0, caret) : uiValueParsed.significant) +\n\t\tuiValueParsed.separator +\n\t\tuiValueParsed.fractional;\n\n\tuseLayoutEffect(() => {\n\t\tref.current?.setSelectionRange(caret.index, caret.index);\n\t});\n\n\t//#region events\n\n\tconst onDelegateFocus = (e: PointerEvent) => {\n\t\tif (ref.current && e.target !== ref.current) {\n\t\t\te.preventDefault();\n\t\t\tref.current.focus();\n\n\t\t\tconst rect = ref.current.getBoundingClientRect();\n\t\t\tconst index = e.x < (rect.left + rect.right) / 2 ? 0 : ref.current.value.length;\n\t\t\tref.current.setSelectionRange(index, index);\n\t\t}\n\t};\n\n\tconst onLostFocus = () => {\n\t\tconst { maxValue, minValue, onChange } = props;\n\t\tconst current = uiValueParsed.sign + uiValueParsed.concat;\n\t\tlet clamped = current;\n\t\tif (minValue && compareDecimal(clamped, minValue) < 0) {\n\t\t\tclamped = minValue;\n\t\t}\n\t\telse if (maxValue && compareDecimal(clamped, maxValue) > 0) {\n\t\t\tclamped = maxValue;\n\t\t}\n\n\t\tclamped = normalizeDecimal(clamped);\n\t\tif (clamped !== current) {\n\t\t\tsetUiValue(clamped);\n\t\t}\n\n\t\tonChange(clamped);\n\t};\n\n\tconst onToggleSign = () => {\n\t\tconst value = ref.current?.value ?? '0';\n\t\tsetUiValue((uiValueParsed.sign ? '' : '-') + value);\n\t};\n\n\tconst onBeforeInput = (e: InputEvent) => {\n\t\tif (e.target !== ref.current) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst input = ref.current!;\n\t\tconst prev = input.value;\n\t\tconst start = input.selectionStart ?? prev.length;\n\t\tconst end = input.selectionEnd ?? prev.length;\n\n\t\t// removing minus sign\n\t\tif (!e.data) {\n\t\t\tif (e.inputType === 'deleteContentBackward' && uiValueParsed.sign && (start === 0 || (isEmpty && start === prev.length))) {\n\t\t\t\te.preventDefault();\n\t\t\t\tonToggleSign();\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\t// adding minus sign\n\t\tif (e.data === '-' && !uiValueParsed.sign && (start === 0 || isEmpty)) {\n\t\t\te.preventDefault();\n\t\t\tonToggleSign();\n\t\t\treturn;\n\t\t}\n\n\t\tconst next = prev.slice(0, start) + e.data + prev.slice(end);\n\t\tif (!RE_DECIMAL.test(next)) {\n\t\t\te.preventDefault();\n\t\t}\n\t};\n\n\tconst onInput = (e: Event) => {\n\t\tif (e.target !== ref.current) {\n\t\t\treturn;\n\t\t}\n\n\t\t// remove auto-inserted leading zero when appending non-zero digits or minus sign\n\t\tlet decimal = ref.current!.value;\n\t\tif (isEmpty && ref.current!.selectionStart === decimal.length && /^0[^0]/.test(decimal)) {\n\t\t\tdecimal = decimal.slice(1);\n\t\t}\n\n\t\tsetUiValue(uiValueParsed.sign + decimal);\n\t};\n\n\t//#endregion\n\n\treturn (\n\t\t<div class='field-number' onPointerDown={onDelegateFocus}>\n\t\t\t<span\n\t\t\t\tonClick={onToggleSign}\n\t\t\t\tchildren={uiValueParsed.sign ? '- ' : '+ '}\n\t\t\t\tclass={cx(\n\t\t\t\t\t'field-number__text',\n\t\t\t\t\tbem('field-number__sign', { negative: Boolean(uiValueParsed.sign) })\n\t\t\t\t)}\n\t\t\t/>\n\t\t\t{(() => {\n\t\t\t\tconst countSignificant = uiValueParsed.significant.length;\n\t\t\t\tif (countSignificant >= maxSignificant) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tconst padding = '0'.repeat(maxSignificant - countSignificant);\n\t\t\t\treturn (\n\t\t\t\t\t<span class='field-number__text'>\n\t\t\t\t\t\t{groupBy > 0 ? splitGroups(padding, groupBy, countSignificant) : padding}\n\t\t\t\t\t</span>\n\t\t\t\t);\n\t\t\t})()}\n\t\t\t<div class='field-number__input-wrapper'>\n\t\t\t\t<span class='field-number__text field-number__phantom'>{uiValueFormatted}</span>\n\t\t\t\t<input\n\t\t\t\t\tclass='field-number__input'\n\t\t\t\t\tref={ref}\n\t\t\t\t\ttype='text' // avoid spin buttons on desktop\n\t\t\t\t\tinputMode='decimal' // use decimal keyboard on mobile\n\t\t\t\t\tvalue={uiValueFormatted}\n\t\t\t\t\tonBlur={onLostFocus}\n\t\t\t\t\t// @ts-expect-error https://github.com/preactjs/preact/issues/1422\n\t\t\t\t\tonbeforeinput={onBeforeInput}\n\t\t\t\t\tonInput={onInput}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t{uiValueParsed.fractional.length < maxFractional\n\t\t\t\t? (\n\t\t\t\t\t<span class='field-number__text'>\n\t\t\t\t\t\t{(uiValueParsed.separator ? '' : '.') + '0'.repeat(maxFractional - uiValueParsed.fractional.length)}\n\t\t\t\t\t</span>\n\t\t\t\t)\n\t\t\t\t: null\n\t\t\t}\n\t\t\t<BoxDecorator />\n\t\t</div>\n\t);\n};\n", "// this is an auto-generated file, do not edit\n\nconst CIRCLE = [\n\t 0.850,  0.000,\n\t 0.821, -0.220,\n\t 0.736, -0.425,\n\t 0.601, -0.601,\n\t 0.425, -0.736,\n\t 0.220, -0.821,\n\t 0.000, -0.850,\n\t-0.220, -0.821,\n\t-0.425, -0.736,\n\t-0.601, -0.601,\n\t-0.736, -0.425,\n\t-0.821, -0.220,\n\t-0.850, -0.000,\n\t-0.821,  0.220,\n\t-0.736,  0.425,\n\t-0.601,  0.601,\n\t-0.425,  0.736,\n\t-0.220,  0.821,\n\t-0.000,  0.850,\n\t 0.220,  0.821,\n\t 0.425,  0.736,\n\t 0.601,  0.601,\n\t 0.736,  0.425,\n\t 0.821,  0.220\n];\n\nconst SQUARE = [\n\t 0.850, -0.850,\n\t-0.850, -0.850,\n\t-0.850,  0.850,\n\t 0.850,  0.850\n];\n\nconst DIAMOND = [\n\t 1.000,  0.000,\n\t 0.000, -1.000,\n\t-1.000, -0.000,\n\t-0.000,  1.000\n];\n\nconst TRIANGLE = [\n\t 1.000, -0.850,\n\t-1.000, -0.850,\n\t-0.000,  0.850\n];\n\nconst STAR = [\n\t 0.577,  0.000,\n\t 0.866, -0.500,\n\t 0.289, -0.500,\n\t 0.000, -1.000,\n\t-0.289, -0.500,\n\t-0.866, -0.500,\n\t-0.577, -0.000,\n\t-0.866,  0.500,\n\t-0.289,  0.500,\n\t-0.000,  1.000,\n\t 0.289,  0.500,\n\t 0.866,  0.500\n];\n\nexport const shapes = [\n\tCIRCLE,\n\tSQUARE,\n\tDIAMOND,\n\tTRIANGLE,\n\tSTAR\n];\n", "import { h } from 'preact';\nimport { useMemo } from 'preact/hooks';\n\nexport interface ShapePreviewProps {\n\treadonly shape: readonly number[];\n\treadonly resolution?: number;\n}\n\nexport const ShapePreview = ({ shape, resolution = 100 }: ShapePreviewProps) => {\n\tconst points = useMemo(() => {\n\t\tconst half = resolution / 2;\n\n\t\tlet concat = '';\n\t\tfor (let i = 0; i < shape.length; i += 2) {\n\t\t\tconcat += `${Math.round(half + shape[i] * half)},${Math.round(half + shape[i + 1] * half)} `;\n\t\t}\n\n\t\treturn concat;\n\t}, [ shape, resolution ]);\n\n\treturn (\n\t\t<svg class='field-shape__preview' viewBox={`0 0 ${resolution} ${resolution}`}>\n\t\t\t<polygon points={points} />\n\t\t</svg>\n\t);\n};\n", "import { h } from 'preact';\n\nimport { shapes } from '~/shapes';\nimport { bem } from '~/utils/style';\n\nimport type { InputProps } from '../types';\nimport { ShapePreview } from './ShapePreview';\n\nimport './NodeShapeField.css';\n\nexport const NodeShapeField = ({ onChange, value = 0 }: InputProps<number>) => (\n\t<div class='field-shape'>\n\t\t{shapes.map((shape, index) => (\n\t\t\t<button\n\t\t\t\tclass={bem('field-shape__button', { selected: index === value })}\n\t\t\t\ttype='button'\n\t\t\t\tkey={index}\n\t\t\t\tonClick={() => onChange(index)}\n\t\t\t>\n\t\t\t\t<ShapePreview shape={shape} />\n\t\t\t</button>\n\t\t))}\n\t</div>\n);\n", "import { h } from 'preact';\n\nimport { BoxDecorator } from '~/components/BoxDecorator';\n\nimport type { InputProps } from '../types';\nimport { useUiValue } from '../useUiValue';\n\nimport './TextField.css';\n\nexport const TextField = ({ onChange, value }: InputProps<string>) => {\n\tconst [ uiValue, setUiValue ] = useUiValue(value ?? '');\n\treturn (\n\t\t<div class='field-text'>\n\t\t\t<input\n\t\t\t\tclass='field-text__input'\n\t\t\t\ttype='text'\n\t\t\t\tvalue={uiValue}\n\t\t\t\tonInput={e => setUiValue((e.target as HTMLInputElement).value)}\n\t\t\t\tonChange={() => onChange(uiValue)}\n\t\t\t/>\n\t\t\t<BoxDecorator />\n\t\t</div>\n\t);\n};\n", "import type { FieldInfo, InputProps } from './types';\n\ntype ValueType<TProps> = TProps extends InputProps<infer TValue> ? TValue : unknown;\n\nexport class FieldSet<T = {}> {\n\tpublic readonly fields: FieldInfo<string, any>[] = [];\n\n\tpublic add<TKey extends string, TProps extends InputProps<any>>(\n\t\tinfo: FieldInfo<TKey, TProps>\n\t): FieldSet<T & { [K in TKey]: ValueType<TProps> }> {\n\t\tthis.fields.push(info);\n\t\treturn this;\n\t}\n}\n", "import { h } from 'preact';\n\nimport type { FieldSet } from './FieldSet';\nimport type { InputProps } from './types';\n\nimport './FieldSetEditor.css';\n\nexport interface FieldSetEditorProps<T extends { [K in string]?: any }> extends InputProps<T> {\n\treadonly fieldSet: FieldSet<T>;\n}\n\nexport const FieldSetEditor = <T extends { [K in string]?: any }>({ fieldSet, onChange, value }: FieldSetEditorProps<T>) => (\n\t<div class='field-set-editor'>\n\t\t{fieldSet.fields.map(field => (\n\t\t\t<div class='field-set-editor__field'>\n\t\t\t\t<span class='field-set-editor__label'>{field.title}</span>\n\t\t\t\t{h(field.kind, {\n\t\t\t\t\t...field.options,\n\t\t\t\t\tkey: field.key,\n\t\t\t\t\tvalue: value?.[field.key],\n\t\t\t\t\ttitle: field.title,\n\t\t\t\t\tonChange(subValue: T[string]) {\n\t\t\t\t\t\tif (value?.[field.key] === subValue) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tonChange({\n\t\t\t\t\t\t\t...value!,\n\t\t\t\t\t\t\t[field.key]: subValue\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t})}\n\t\t\t</div>\n\t\t))}\n\t</div>\n);\n", "import { IntlProvider } from '@calmdownval/intl-preact';\nimport { h } from 'preact';\nimport { useState } from 'preact/hooks';\n\nimport { FieldSet, FieldSetEditor, NumberField, NodeShapeField, TextField } from '~/components/FieldSetEditor';\n\nconst fs = new FieldSet()\n\t.add({\n\t\tkey: 'shape',\n\t\tkind: NodeShapeField,\n\t\ttitle: 'Shape'\n\t})\n\t.add({\n\t\tkey: 'title',\n\t\tkind: TextField,\n\t\ttitle: 'Encounter Title'\n\t})\n\t.add({\n\t\tkey: 'minLevel',\n\t\tkind: NumberField,\n\t\ttitle: 'Minimum Required Level',\n\t\toptions: {\n\t\t\tminValue: '-1000000',\n\t\t\tmaxValue: '1000000',\n\t\t\tmaxSignificant: 7,\n\t\t\tmaxFractional: 3,\n\t\t\tgroupBy: 3\n\t\t}\n\t});\n\nexport const FieldSetTestApp = () => {\n\tconst [ state, setState ] = useState<any>();\n\treturn (\n\t\t<IntlProvider url='./locale/en.json'>\n\t\t\t<FieldSetEditor\n\t\t\t\tfieldSet={fs}\n\t\t\t\tvalue={state}\n\t\t\t\tonChange={setState}\n\t\t\t/>\n\t\t</IntlProvider>\n\n\t);\n};\n", "export function ArrayBackend() {\n\tthis.$handlers = [];\n}\n\nArrayBackend.prototype.$snapshot = null;\n\nArrayBackend.prototype.$getSnapshot = function () {\n\tif (!this.$snapshot) {\n\t\tthis.$snapshot = this.$handlers.slice();\n\t}\n\n\treturn this.$snapshot;\n};\n\nArrayBackend.prototype.$add = function (handler) {\n\tthis.$handlers.push(handler);\n\tthis.$snapshot = null;\n};\n\nArrayBackend.prototype.$clear = function () {\n\tif (this.$handlers.length === 0) {\n\t\treturn false;\n\t}\n\n\tthis.$handlers = [];\n\tthis.$snapshot = null;\n\treturn true;\n};\n\nArrayBackend.prototype.$count = function () {\n\treturn this.$handlers.length;\n};\n\nArrayBackend.prototype.$delete = function (handler) {\n\tconst { $handlers } = this;\n\n\tlet index = $handlers.length - 1;\n\tlet current;\n\n\twhile (index >= 0) {\n\t\tcurrent = $handlers[index];\n\t\tif (current === handler || current.$once === handler) {\n\t\t\tbreak;\n\t\t}\n\n\t\t--index;\n\t}\n\n\tif (index === -1) {\n\t\treturn false;\n\t}\n\n\tthis.$handlers.splice(index, 1);\n\tthis.$snapshot = null;\n\treturn true;\n};\n\nArrayBackend.prototype.$deleteWrapped = function (handler) {\n\tconst index = this.$handlers.lastIndexOf(handler);\n\tif (index !== -1) {\n\t\tthis.$handlers.splice(index, 1);\n\t\tthis.$snapshot = null;\n\t}\n};\n", "export function SetBackend() {\n\t// We use Set for all persistent handlers, but we must use an array for\n\t// 'once' handlers. We assume this array will be empty most of the time.\n\tthis.$persistent = new Set();\n\tthis.$oneshot = [];\n}\n\nSetBackend.prototype.$snapshot = null;\n\nSetBackend.prototype.$getSnapshot = function () {\n\tif (!this.$snapshot) {\n\t\tthis.$snapshot = Array.from(this.$persistent.values()).concat(this.$oneshot);\n\t}\n\n\treturn this.$snapshot;\n};\n\nSetBackend.prototype.$add = function (handler) {\n\tif (handler.$once) {\n\t\tif (this.$persistent.has(handler.$once)) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.$oneshot.push(handler);\n\t}\n\telse {\n\t\tthis.$persistent.add(handler);\n\t\tthis.$deleteOneshot(handler);\n\t}\n\n\tthis.$snapshot = null;\n};\n\nSetBackend.prototype.$clear = function () {\n\tif (this.$count()) {\n\t\tthis.$persistent.clear();\n\t\tthis.$oneshot = [];\n\t\tthis.$snapshot = null;\n\t\treturn true;\n\t}\n\n\treturn false;\n};\n\nSetBackend.prototype.$count = function () {\n\treturn this.$persistent.size + this.$oneshot.length;\n};\n\nSetBackend.prototype.$delete = function (handler) {\n\tif (this.$persistent.delete(handler)) {\n\t\tthis.$snapshot = null;\n\t\treturn true;\n\t}\n\n\treturn this.$deleteOneshot(handler);\n};\n\nSetBackend.prototype.$deleteWrapped = function (handler) {\n\tconst index = this.$oneshot.lastIndexOf(handler);\n\tif (index !== -1) {\n\t\tthis.$oneshot.splice(index, 1);\n\t\tthis.$snapshot = null;\n\t}\n};\n\nSetBackend.prototype.$deleteOneshot = function (handler) {\n\tlet index = this.$oneshot.length - 1;\n\twhile (index >= 0) {\n\t\tif (this.$oneshot[index].$once === handler) {\n\t\t\tthis.$oneshot.splice(index, 1);\n\t\t\tthis.$snapshot = null;\n\t\t\treturn true;\n\t\t}\n\n\t\t--index;\n\t}\n\n\treturn false;\n};\n", "import type { AsyncSignalOptions, SignalBackend, WrappedSignalHandler } from '~/types';\n\nfunction isThennable(obj: any): obj is Promise<any> {\n\treturn obj && typeof obj.then === 'function';\n}\n\nfunction dispatchInParallel<T>(thisArg: any, snapshot: readonly WrappedSignalHandler<T>[], event: T) {\n\treturn new Promise<void>((resolve, reject) => {\n\t\tconst { length } = snapshot;\n\t\tlet pending = 0;\n\n\t\tconst onHandlerResolved = () => {\n\t\t\tif (--pending === 0) {\n\t\t\t\tresolve();\n\t\t\t}\n\t\t};\n\n\t\tfor (let index = 0; index < length; ++index) {\n\t\t\tconst result = snapshot[index].call(thisArg, event);\n\t\t\tif (isThennable(result)) {\n\t\t\t\t++pending;\n\t\t\t\tresult.then(onHandlerResolved, reject);\n\t\t\t}\n\t\t}\n\t});\n}\n\nfunction dispatchInSeries<T>(thisArg: any, snapshot: readonly WrappedSignalHandler<T>[], event: T) {\n\treturn new Promise<void>((resolve, reject) => {\n\t\tconst { length } = snapshot;\n\t\tlet index = 0;\n\n\t\tconst next = () => {\n\t\t\tif (index >= length) {\n\t\t\t\tresolve();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst result = snapshot[index++].call(thisArg, event);\n\t\t\tif (isThennable(result)) {\n\t\t\t\tresult.then(next, reject);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tnext();\n\t\t\t}\n\t\t};\n\n\t\tnext();\n\t});\n}\n\nexport function createAsyncDispatcher<T = void>(backend: SignalBackend<T>, options?: AsyncSignalOptions) {\n\tconst run = options?.parallel ? dispatchInParallel : dispatchInSeries;\n\treturn function (this: any, event?: T) {\n\t\treturn run(this, backend.$getSnapshot(), event!);\n\t};\n}\n", "import { ArrayBackend } from './backend/ArrayBackend';\nimport { SetBackend } from './backend/SetBackend';\nimport { createAsyncDispatcher } from './dispatcher/asyncDispatcher';\nimport { createSyncDispatcher } from './dispatcher/syncDispatcher';\nimport type {\n\tAsyncSignal,\n\tAsyncSignalOptions,\n\tSignal,\n\tSignalBackend,\n\tSignalBackendType,\n\tSignalHandler,\n\tSignalHandlerOptions,\n\tSignalOptions,\n\tSyncSignal,\n\tSyncSignalOptions\n} from './types';\n\nconst BACKEND_MAP: Record<SignalBackendType, (new <T>() => SignalBackend<T>) | undefined> = {\n\tarray: ArrayBackend,\n\tset: SetBackend\n};\n\n/**\n * Creates a new synchronous Signal instance.\n */\nexport function create<T = void>(options?: SyncSignalOptions): SyncSignal<T>;\n\n/**\n * Creates a new asynchronous Signal instance.\n */\nexport function create<T = void>(options?: AsyncSignalOptions): AsyncSignal<T>;\n\n/**\n * Creates a new Signal instance.\n */\nexport function create<T = void>(options?: SignalOptions): Signal<T>;\nexport function create<T = void>(options: SignalOptions = {}): Signal<T> {\n\tconst backend = new (BACKEND_MAP[options.backend!] ?? ArrayBackend)<T>();\n\tconst isAsync = options.async === true;\n\tconst dispatcher: any = isAsync\n\t\t? createAsyncDispatcher(backend, options)\n\t\t: createSyncDispatcher(backend, options as SyncSignalOptions);\n\n\tdispatcher.$backend = backend;\n\tdispatcher.isAsync = isAsync;\n\n\treturn dispatcher;\n}\n\n/**\n * Attempts to remove the given handler from a Signal or removes all its\n * handlers if no specific handler is provided.\n *\n * Returns a boolean indicating whether any handlers have been removed.\n */\nexport function off<T>(signal: Signal<T>, handler?: SignalHandler<T>): boolean {\n\treturn handler\n\t\t? signal.$backend.$delete(handler)\n\t\t: signal.$backend.$clear();\n}\n\n/**\n * Attaches a handler to a Signal that is automatically removed after its first\n * invocation.\n */\nexport function once<T>(signal: Signal<T>, handler: SignalHandler<T>): void {\n\tlet wasTriggered = false;\n\tconst wrapped = function (this: any, event?: T) {\n\t\tif (wasTriggered) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tsignal.$backend.$deleteWrapped(wrapped);\n\t\twasTriggered = true;\n\n\t\treturn handler.call(this, event!);\n\t};\n\n\twrapped.$once = handler;\n\tsignal.$backend.$add(wrapped);\n}\n\n/**\n * Attaches a handler to a Signal. Has no effect if the handler has already been\n * attached to this Signal.\n */\nexport function on<T>(signal: Signal<T>, handler: SignalHandler<T>, options?: SignalHandlerOptions): void {\n\tif (options?.once) {\n\t\tonce(signal, handler);\n\t}\n\telse {\n\t\tsignal.$backend.$add(handler);\n\t}\n}\n\n/**\n * Checks whether a signal has any handlers attached and triggers it providing\n * return value of the `lazyEvent` callback as the event data.\n *\n * This is a no-op if the signal has no handlers attached.\n */\nexport function lazy<T>(signal: SyncSignal<T>, lazyEvent: () => T): void;\nexport function lazy<T>(signal: AsyncSignal<T>, lazyEvent: () => T): Promise<void>;\nexport function lazy<T>(this: any, signal: Signal<T>, lazyEvent: () => T) {\n\tif (signal.$backend.$count()) {\n\t\treturn (signal as any).call(this, lazyEvent());\n\t}\n\n\treturn signal.isAsync\n\t\t? Promise.resolve()\n\t\t: undefined;\n}\n", "import type { SignalBackend, SyncSignalOptions } from '~/types';\n\nexport function createSyncDispatcher<T = void>(backend: SignalBackend<T>, _options?: SyncSignalOptions) {\n\treturn function (this: any, event?: T) {\n\t\tconst snapshot = backend.$getSnapshot();\n\t\tconst { length } = snapshot;\n\n\t\tfor (let i = 0; i < length; ++i) {\n\t\t\tvoid snapshot[i].call(this, event!);\n\t\t}\n\t};\n}\n", "import type { Point } from '~/types';\n\nexport const ORIGIN: Point = {\n\tx: 0,\n\ty: 0\n};\n\nexport function getDistance(a: Point, b: Point) {\n\tconst dx = a.x - b.x;\n\tconst dy = a.y - b.y;\n\treturn Math.sqrt(dx * dx + dy * dy);\n}\n\nexport function clamp(value: number, min = 0, max = 1) {\n\treturn value < min ? min : value > max ? max : value;\n}\n\nexport function isAroundZero(x: number) {\n\treturn Math.abs(x) < Number.EPSILON;\n}\n", "import * as Signal from '@calmdownval/signal';\n\nimport type { Point } from '~/types';\nimport { getDistance } from '~/utils/math';\n\nimport type { EditorView } from '../EditorView';\nimport type { GestureHandler, Pointer } from '../types';\n\nexport interface PressGestureOptions {\n\t/**\n\t * The EditorView using this gesture.\n\t */\n\teditor: EditorView;\n\n\t/**\n\t * How long in milliseconds to wait before a long press is recognized.\n\t *\n\t * Defaults to 800.\n\t */\n\tlongPressDelay?: number;\n\n\t/**\n\t * The maximum distance in logical pixels a pointer is allowed to move to\n\t * still be recognized as a press.\n\t *\n\t * Defaults to 10.\n\t */\n\tmaxPressDistance?: number;\n\n\t/**\n\t * The maximum time in milliseconds between pointer events to be recognized\n\t * as multi-press.\n\t *\n\t * Defaults to 400.\n\t */\n\tmultiPressDelay?: number;\n}\n\nexport enum PressState {\n\tIdle,\n\tPending,\n\tMovedTooFar,\n\tLongPress,\n\tComplexGesture\n}\n\nexport class PressGesture implements GestureHandler {\n\tpublic readonly press = Signal.create<Point>();\n\tpublic readonly longPress = Signal.create<Point>();\n\tpublic readonly multiPress = Signal.create<Point>();\n\tpublic acceptsNewPointers = true;\n\n\tprotected readonly editor: EditorView;\n\tprotected state = PressState.Idle;\n\n\tprivate readonly longPressDelay: number;\n\tprivate readonly maxPressDistance: number;\n\tprivate readonly multiPressDelay: number;\n\tprivate longPressTimeout?: number;\n\tprivate multiPressCount = 0;\n\tprivate multiPressTime = 0;\n\n\tpublic constructor(options: PressGestureOptions) {\n\t\tthis.editor = options.editor;\n\t\tthis.longPressDelay = options.longPressDelay ?? 800;\n\t\tthis.maxPressDistance = options.maxPressDistance ?? 10;\n\t\tthis.multiPressDelay = options.multiPressDelay ?? 400;\n\t}\n\n\tpublic handlePointerDown(current: Pointer, pointers: readonly Pointer[]) {\n\t\tif (pointers.length > 1) {\n\t\t\tthis.onChangeState(PressState.ComplexGesture);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.state = PressState.Pending;\n\t\tthis.onMultiPress(current.editor, false);\n\t\tthis.longPressTimeout = setTimeout(\n\t\t\t() => this.onLongPress(current.editor),\n\t\t\tthis.longPressDelay\n\t\t);\n\t}\n\n\tpublic handlePointerMove(current: Pointer, _pointers: readonly Pointer[]) {\n\t\tconst distance = getDistance(current.start, current);\n\t\tif (distance > this.maxPressDistance) {\n\t\t\tthis.onChangeState(PressState.MovedTooFar);\n\t\t}\n\t}\n\n\tpublic handlePointerUp(current: Pointer, _pointers: readonly Pointer[]) {\n\t\tif (this.state === PressState.Pending) {\n\t\t\tthis.press(current.editor);\n\t\t\tthis.onMultiPress(current.editor, true);\n\t\t}\n\n\t\tthis.onChangeState(PressState.Idle);\n\t}\n\n\tprotected onChangeState(state: PressState) {\n\t\tif (this.longPressTimeout !== undefined) {\n\t\t\tclearTimeout(this.longPressTimeout);\n\t\t\tthis.longPressTimeout = undefined;\n\t\t}\n\n\t\tthis.state = state;\n\t}\n\n\tprotected onLongPress(editorPoint: Point) {\n\t\tthis.longPressTimeout = undefined;\n\t\tthis.longPress(editorPoint);\n\t\tthis.onChangeState(PressState.LongPress);\n\t}\n\n\tprivate onMultiPress(editorPoint: Point, isUp: boolean) {\n\t\tconst now = performance.now();\n\t\tif (now - this.multiPressTime > this.multiPressDelay) {\n\t\t\tthis.multiPressCount = 0;\n\t\t}\n\t\telse if (isUp && ++this.multiPressCount >= 2) {\n\t\t\tthis.multiPress(editorPoint);\n\t\t}\n\n\t\tthis.multiPressTime = now;\n\t}\n}\n", "import * as Signal from '@calmdownval/signal';\n\nimport type { Point } from '~/types';\nimport { clamp, isAroundZero, ORIGIN } from '~/utils/math';\n\nimport type { Pointer } from '../types';\nimport { PressGesture, PressGestureOptions } from './PressGesture';\n\nexport interface DragGestureOptions extends PressGestureOptions {\n\t/**\n\t * The proximity to editor view's edges at which automatic panning begins to\n\t * push the view.\n\t *\n\t * Defaults to 64.\n\t */\n\tedgeProximity?: number;\n\n\t/**\n\t * The maximum speed in logical pixels per millisecond of automatic panning\n\t * when dragging towards the edges of the view.\n\t *\n\t * Defaults to 0.5.\n\t */\n\tpushSpeed?: number;\n}\n\nexport class DragGesture extends PressGesture {\n\tpublic readonly drag = Signal.create<Point>();\n\tpublic readonly drop = Signal.create<Point>();\n\n\tpublic offset: Point = { ...ORIGIN };\n\tpublic isDragging = false;\n\n\tprivate readonly edgeProximity: number;\n\tprivate readonly pushSpeedBasis: number;\n\tprivate readonly pushSpeed: Point = { ...ORIGIN };\n\tprivate start: Point = { ...ORIGIN };\n\tprivate animationHandle?: number;\n\tprivate lastTimestamp?: number;\n\tprivate lastPoint!: Point;\n\n\tpublic constructor(options: DragGestureOptions) {\n\t\tsuper(options);\n\t\tthis.edgeProximity = options.edgeProximity ?? 64;\n\t\tthis.pushSpeedBasis = options.pushSpeed ?? 0.5;\n\t}\n\n\tpublic handlePointerDown(current: Pointer, pointers: readonly Pointer[]) {\n\t\tthis.acceptsNewPointers = false;\n\t\tthis.isDragging = true;\n\n\t\t// We must store start position in editor space since the view may get\n\t\t// auto-panned. Using `point.start` wouldn't work then.\n\t\tthis.lastPoint = current;\n\t\tthis.start = current.editor;\n\t\tthis.offset = { ...ORIGIN };\n\t\tthis.startPushAnimation(current);\n\n\t\tsuper.handlePointerDown(current, pointers);\n\t}\n\n\tpublic handlePointerMove(current: Pointer, pointers: readonly Pointer[]) {\n\t\tthis.lastPoint = current;\n\t\tthis.offset.x = current.editor.x - this.start.x;\n\t\tthis.offset.y = current.editor.y - this.start.y;\n\t\tthis.drag(this.offset);\n\t\tthis.startPushAnimation(current);\n\n\t\tsuper.handlePointerMove(current, pointers);\n\t}\n\n\tpublic handlePointerUp(current: Pointer, pointers: readonly Pointer[]) {\n\t\tthis.acceptsNewPointers = true;\n\t\tthis.isDragging = false;\n\t\tthis.stopPushAnimation();\n\t\tthis.drop(this.offset);\n\n\t\tsuper.handlePointerUp(current, pointers);\n\t}\n\n\tprivate startPushAnimation(current: Pointer) {\n\t\tthis.pushSpeed.x = this.pushSpeedBasis * (\n\t\t\tclamp(1 - (current.x - this.editor.edgeTopLeft.x) / this.edgeProximity) -\n\t\t\tclamp(1 - (this.editor.edgeBottomRight.x - current.x) / this.edgeProximity)\n\t\t);\n\n\t\tthis.pushSpeed.y = this.pushSpeedBasis * (\n\t\t\tclamp(1 - (current.y - this.editor.edgeTopLeft.y) / this.edgeProximity) -\n\t\t\tclamp(1 - (this.editor.edgeBottomRight.y - current.y) / this.edgeProximity)\n\t\t);\n\n\t\tif (!isAroundZero(this.pushSpeed.x) || !isAroundZero(this.pushSpeed.y)) {\n\t\t\tif (this.animationHandle === undefined) {\n\t\t\t\tthis.lastTimestamp = undefined;\n\t\t\t\tthis.animationHandle = requestAnimationFrame(this.onTick);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tthis.stopPushAnimation();\n\t\t}\n\t}\n\n\tprivate stopPushAnimation() {\n\t\tif (this.animationHandle !== undefined) {\n\t\t\tcancelAnimationFrame(this.animationHandle);\n\t\t\tthis.animationHandle = undefined;\n\t\t}\n\t}\n\n\tprivate readonly onTick = (timestamp: number) => {\n\t\tlet delta = 0;\n\t\tif (this.lastTimestamp !== undefined) {\n\t\t\tdelta = timestamp - this.lastTimestamp;\n\t\t}\n\n\t\tthis.editor.setOffset({\n\t\t\tx: this.pushSpeed.x * delta,\n\t\t\ty: this.pushSpeed.y * delta\n\t\t});\n\n\t\t// When auto-panning, we must emit drag events accordingly since the\n\t\t// view gets offset even when the pointer doesn't move.\n\t\tthis.offset = this.editor.clientToEditorSpace(this.lastPoint);\n\t\tthis.offset.x -= this.start.x;\n\t\tthis.offset.y -= this.start.y;\n\t\tthis.drag(this.offset);\n\n\t\tthis.lastTimestamp = timestamp;\n\t\tthis.animationHandle = requestAnimationFrame(this.onTick);\n\t};\n}\n", "import { getDistance } from '~/utils/math';\n\nimport { Pointer, PointerType } from '../types';\nimport { PressGesture, PressGestureOptions, PressState } from './PressGesture';\n\nexport interface PanAndZoomGestureOptions extends PressGestureOptions {\n\t/**\n\t * When panning with mouse, this feature locks the mouse pointer for\n\t * infinite panning.\n\t *\n\t * Defaults to false.\n\t */\n\tusePointerLock?: boolean;\n}\n\nexport class PanAndZoomGesture extends PressGesture {\n\tprivate readonly usePointerLock: boolean;\n\tprivate pinchInitDistance = 0;\n\tprivate pinchInitZoom = 1;\n\tprivate isPointerLocked = false;\n\tprivate isPointerLockEligible = false;\n\n\tpublic constructor(options: PanAndZoomGestureOptions) {\n\t\tsuper(options);\n\t\tthis.usePointerLock = options.usePointerLock ?? false;\n\n\t\tif (this.usePointerLock) {\n\t\t\tdocument.addEventListener('pointerlockchange', this.onPointerLockChange);\n\t\t}\n\t}\n\n\tpublic dispose() {\n\t\tif (this.usePointerLock) {\n\t\t\tdocument.removeEventListener('pointerlockchange', this.onPointerLockChange);\n\t\t}\n\t}\n\n\tpublic handlePointerDown(current: Pointer, pointers: readonly Pointer[]) {\n\t\tsuper.handlePointerDown(current, pointers);\n\t\tthis.isPointerLockEligible = (\n\t\t\tthis.usePointerLock && pointers.length === 1 && current.type === PointerType.Mouse\n\t\t);\n\n\t\tif (pointers.length === 2) {\n\t\t\tthis.pinchInitDistance = getDistance(pointers[0], pointers[1]);\n\t\t\tthis.pinchInitZoom = this.editor.zoom;\n\t\t\tthis.acceptsNewPointers = false;\n\t\t}\n\t}\n\n\tpublic handlePointerMove(current: Pointer, pointers: readonly Pointer[]) {\n\t\tsuper.handlePointerMove(current, pointers);\n\t\tif (this.state === PressState.LongPress) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (pointers.length === 2) {\n\t\t\tconst other = pointers[1] === current ? pointers[0] : pointers[1];\n\t\t\tconst pinchDistance = getDistance(current, other);\n\t\t\tthis.editor.setZoom(\n\t\t\t\tthis.pinchInitZoom * pinchDistance / this.pinchInitDistance,\n\t\t\t\t{\n\t\t\t\t\tx: (current.x + other.x) / 2,\n\t\t\t\t\ty: (current.y + other.y) / 2\n\t\t\t\t},\n\t\t\t\tfalse\n\t\t\t);\n\n\t\t\t// allow panning while pinch-zooming\n\t\t\tthis.editor.setOffset({\n\t\t\t\tx: (current.x + other.x) / 2 - (current.x - current.delta.x + other.x) / 2,\n\t\t\t\ty: (current.y + other.y) / 2 - (current.y - current.delta.y + other.y) / 2\n\t\t\t});\n\t\t}\n\t\telse {\n\t\t\tthis.editor.setOffset({\n\t\t\t\tx: current.delta.x,\n\t\t\t\ty: current.delta.y\n\t\t\t});\n\t\t}\n\t}\n\n\tpublic handlePointerUp(current: Pointer, pointers: readonly Pointer[]) {\n\t\tsuper.handlePointerUp(current, pointers);\n\t\tthis.acceptsNewPointers = true;\n\n\t\tif (this.isPointerLocked) {\n\t\t\tdocument.exitPointerLock();\n\t\t}\n\t}\n\n\tprotected onChangeState(state: PressState): void {\n\t\tsuper.onChangeState(state);\n\t\tif (this.isPointerLockEligible && state === PressState.MovedTooFar) {\n\t\t\tthis.editor.canvas?.requestPointerLock();\n\t\t}\n\t}\n\n\tprivate readonly onPointerLockChange = () => {\n\t\tthis.isPointerLocked = document.pointerLockElement === this.editor.canvas;\n\t};\n}\n", "import { Component, h } from 'preact';\n\nimport type { Point, Rect } from '~/types';\nimport { clamp, isAroundZero, ORIGIN } from '~/utils/math';\n\nimport { GestureHandler, Pointer, PointerType } from './types';\n\nconst DPR = window.devicePixelRatio || 1;\n\nexport interface EditorViewProps {\n\treadonly minZoom: number;\n\treadonly maxZoom: number;\n}\n\nexport abstract class EditorView<TProps extends EditorViewProps = EditorViewProps, TState = {}> extends Component<TProps, TState> {\n\t// view state, in logical pixels\n\tpublic zoom: number;\n\tpublic readonly offset: Point = { ...ORIGIN };\n\n\t// canvas layout in logical pixels, client coordinates\n\tpublic canvas: HTMLCanvasElement | null = null;\n\tpublic readonly edgeTopLeft: Point = { ...ORIGIN };\n\tpublic readonly edgeBottomRight: Point = { ...ORIGIN };\n\n\tprotected readonly canvasCssClass?: string;\n\n\t// user input handling\n\tprivate readonly pointers: Pointer[] = [];\n\tprivate readonly rawOffset: Point = { ...ORIGIN };\n\tprivate rawZoom: number;\n\tprivate gesture: GestureHandler | null = null;\n\n\t// rendering\n\tprivate frameHandle?: number;\n\tprivate observer?: ResizeObserver;\n\n\tpublic constructor(props: TProps, context?: any) {\n\t\tsuper(props, context);\n\n\t\tconst initialZoom = Math.max((props.minZoom + props.maxZoom) / 2, Number.EPSILON);\n\t\tthis.zoom = initialZoom;\n\t\tthis.rawZoom = initialZoom;\n\t}\n\n\tpublic componentDidMount() {\n\t\tconst options: AddEventListenerOptions = {\n\t\t\tpassive: true\n\t\t};\n\n\t\twindow.addEventListener('pointermove', this.onPointerMove, options);\n\t\twindow.addEventListener('pointerup', this.onPointerLost, options);\n\t\twindow.addEventListener('pointercancel', this.onPointerLost, options);\n\t}\n\n\tpublic componentWillUnmount() {\n\t\twindow.removeEventListener('pointermove', this.onPointerMove);\n\t\twindow.removeEventListener('pointerup', this.onPointerLost);\n\t\twindow.removeEventListener('pointercancel', this.onPointerLost);\n\n\t\tthis.observer?.disconnect();\n\t\tthis.observer = undefined;\n\n\t\tif (this.frameHandle !== undefined) {\n\t\t\tcancelAnimationFrame(this.frameHandle);\n\t\t\tthis.frameHandle = undefined;\n\t\t}\n\t}\n\n\tpublic shouldComponentUpdate() {\n\t\treturn false;\n\t}\n\n\tpublic render() {\n\t\treturn (\n\t\t\t<canvas\n\t\t\t\tclass={this.canvasCssClass}\n\t\t\t\tonContextMenu={cancelEvent}\n\t\t\t\tonLostPointerCapture={this.onPointerLost}\n\t\t\t\tonPointerDown={this.onPointerDown}\n\t\t\t\tonWheel={this.onWheel}\n\t\t\t\tref={this.onCanvasRef}\n\t\t\t/>\n\t\t);\n\t}\n\n\tpublic updateView() {\n\t\tthis.frameHandle ??= requestAnimationFrame(this.onFrame);\n\t}\n\n\tpublic clientToEditorSpace(client: Point): Point {\n\t\treturn {\n\t\t\tx: (client.x - (this.edgeTopLeft.x + this.edgeBottomRight.x) / 2 - this.offset.x) / this.zoom,\n\t\t\ty: (client.y - (this.edgeTopLeft.y + this.edgeBottomRight.y) / 2 - this.offset.y) / this.zoom\n\t\t};\n\t}\n\n\tpublic getVisibleRect(): Rect {\n\t\treturn {\n\t\t\ttopLeft: this.clientToEditorSpace(this.edgeTopLeft),\n\t\t\tbottomRight: this.clientToEditorSpace(this.edgeBottomRight)\n\t\t};\n\t}\n\n\tpublic setOffset(nextOffset: Point, relative = true) {\n\t\tthis.rawOffset.x = (relative ? this.rawOffset.x : 0) + nextOffset.x;\n\t\tthis.rawOffset.y = (relative ? this.rawOffset.y : 0) + nextOffset.y;\n\n\t\tconst offset = this.getOffsetAdjustment(this.rawOffset);\n\t\tif (!isAroundZero(offset.x - this.offset.x) || !isAroundZero(offset.y - this.offset.y)) {\n\t\t\tthis.offset.x = offset.x;\n\t\t\tthis.offset.y = offset.y;\n\t\t\tthis.updateView();\n\t\t}\n\t}\n\n\tpublic setZoom(nextZoom: number, target: Point, relative = true) {\n\t\tthis.rawZoom = clamp(\n\t\t\t(relative ? this.rawZoom : 0) + nextZoom,\n\t\t\tMath.max(this.props.minZoom, Number.EPSILON),\n\t\t\tthis.props.maxZoom\n\t\t);\n\n\t\tconst zoom = this.getZoomAdjustment(this.rawZoom);\n\t\tconst delta = this.zoom - zoom;\n\t\tif (isAroundZero(delta)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst point = this.clientToEditorSpace(target);\n\t\tthis.setOffset({\n\t\t\tx: delta * point.x,\n\t\t\ty: delta * point.y\n\t\t});\n\n\t\tthis.zoom = zoom;\n\t\tthis.updateView();\n\t}\n\n\tprotected abstract canvasAcquired(canvas: HTMLCanvasElement): void;\n\tprotected abstract canvasResized(width: number, height: number): void;\n\tprotected abstract canvasRender(): boolean;\n\tprotected abstract hitTest(point: Point, e: PointerEvent): GestureHandler | null;\n\n\tprotected getOffsetAdjustment(nextOffset: Point): Point {\n\t\treturn nextOffset;\n\t}\n\n\tprotected getZoomAdjustment(nextZoom: number) {\n\t\treturn nextZoom;\n\t}\n\n\tprotected getWheelDeltaAdjustment(_e: WheelEvent) {\n\t\treturn 1;\n\t}\n\n\tprivate updateLayout(rect: DOMRectReadOnly = this.canvas!.getBoundingClientRect()) {\n\t\tthis.edgeTopLeft.y = rect.top;\n\t\tthis.edgeTopLeft.x = rect.left;\n\t\tthis.edgeBottomRight.y = rect.bottom;\n\t\tthis.edgeBottomRight.x = rect.right;\n\t}\n\n\tprivate readonly onPointerDown = (e: PointerEvent) => {\n\t\tconst editorPoint = this.clientToEditorSpace(e);\n\t\tif (this.gesture === null) {\n\t\t\t// refresh layout info on new pointer interactions; the page may have been scrolled\n\t\t\tthis.updateLayout();\n\n\t\t\t// perform a hit test to decide how to handle this pointer\n\t\t\tthis.gesture = this.hitTest(editorPoint, e);\n\t\t}\n\n\t\tif (this.gesture?.acceptsNewPointers === true) {\n\t\t\tconst current: Pointer = {\n\t\t\t\tid: e.pointerId,\n\t\t\t\ttype: e.pointerType as PointerType,\n\t\t\t\tdelta: { ...ORIGIN },\n\t\t\t\teditor: editorPoint,\n\t\t\t\tstart: {\n\t\t\t\t\tx: e.x,\n\t\t\t\t\ty: e.y\n\t\t\t\t},\n\t\t\t\tx: e.x,\n\t\t\t\ty: e.y\n\t\t\t};\n\n\t\t\tthis.pointers.push(current);\n\t\t\tthis.gesture.handlePointerDown(current, this.pointers);\n\t\t}\n\t};\n\n\tprivate readonly onPointerMove = (e: PointerEvent) => {\n\t\tconst current = this.pointers.find(({ id }) => e.pointerId === id);\n\t\tif (!current) {\n\t\t\treturn;\n\t\t}\n\n\t\t// All our measurements use logical pixels; Movement uses physical pixel\n\t\t// coordinates (in most browsers...) so we need to convert.\n\t\t// See: https://github.com/w3c/uievents/issues/40\n\t\tcurrent.delta.x = e.movementX / DPR;\n\t\tcurrent.delta.y = e.movementY / DPR;\n\n\t\t// When using pointer lock, x/y values stay constant. To compensate,\n\t\t// we aggregate the movementXY deltas instead.\n\t\tif (current.type === PointerType.Mouse && document.pointerLockElement) {\n\t\t\tcurrent.x += current.delta.x;\n\t\t\tcurrent.y += current.delta.y;\n\t\t}\n\t\telse {\n\t\t\tcurrent.x = e.x;\n\t\t\tcurrent.y = e.y;\n\t\t}\n\n\t\tcurrent.editor = this.clientToEditorSpace(current);\n\t\tthis.gesture!.handlePointerMove(current, this.pointers);\n\t};\n\n\tprivate readonly onPointerLost = (e: PointerEvent) => {\n\t\tconst index = this.pointers.findIndex(({ id }) => e.pointerId === id);\n\t\tif (index === -1) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst current = this.pointers[index];\n\t\tthis.gesture!.handlePointerUp(current, this.pointers);\n\t\tthis.pointers.splice(index, 1);\n\n\t\tif (this.pointers.length === 0) {\n\t\t\tthis.gesture = null;\n\t\t}\n\t};\n\n\tprivate readonly onWheel = (e: WheelEvent) => {\n\t\tcancelEvent(e);\n\n\t\tlet adjustment = -this.getWheelDeltaAdjustment(e);\n\t\tif (e.ctrlKey) {\n\t\t\t// This extra adjustment is rather arbitrary, but seems to normalize\n\t\t\t// the zoom sensitivity across platforms quite well.\n\t\t\tadjustment /= (this.edgeBottomRight.y - this.edgeTopLeft.y) / 3;\n\t\t\tthis.setZoom(e.deltaY * adjustment, e);\n\t\t}\n\t\telse {\n\t\t\tthis.setOffset({\n\t\t\t\tx: (e.shiftKey ? e.deltaY : e.deltaX) * adjustment,\n\t\t\t\ty: (e.shiftKey ? e.deltaX : e.deltaY) * adjustment\n\t\t\t});\n\t\t}\n\t};\n\n\tprivate readonly onCanvasRef = (newCanvas: HTMLCanvasElement | null) => {\n\t\tconst oldCanvas = this.canvas;\n\t\tif (oldCanvas) {\n\t\t\tthis.observer!.unobserve(oldCanvas);\n\t\t}\n\n\t\tif (newCanvas) {\n\t\t\tthis.canvasAcquired(newCanvas);\n\t\t\tthis.observer ??= new ResizeObserver(this.onResizeObserved);\n\t\t\tthis.observer.observe(newCanvas, { box: 'content-box' });\n\t\t}\n\n\t\tthis.canvas = newCanvas;\n\t};\n\n\tprivate readonly onResizeObserved = (entries: ResizeObserverEntry[]) => {\n\t\tconst rect = entries[0].contentRect;\n\t\tthis.updateLayout(rect);\n\t\tthis.canvasResized(rect.width, rect.height);\n\t\tthis.updateView();\n\t};\n\n\tprivate readonly onFrame = () => {\n\t\tthis.frameHandle = this.canvasRender()\n\t\t\t? requestAnimationFrame(this.onFrame)\n\t\t\t: undefined;\n\t};\n}\n\nfunction cancelEvent(e: Event) {\n\te.preventDefault();\n\te.stopImmediatePropagation();\n}\n", "export interface Compare<T> {\n\t(a: T, b: T): number;\n}\n\nexport function quickSort<T>(array: T[], compare: Compare<T>) {\n\tconst { length } = array;\n\tif (length > 1) {\n\t\tqsSort(array, compare, 0, length - 1);\n\t}\n\n\treturn array;\n}\n\nfunction qsPartition<T>(array: T[], compare: Compare<T>, left: number, right: number) {\n\tconst pivot = array[(left + right) >>> 1];\n\tlet temp;\n\n\t/* eslint-disable no-param-reassign */\n\twhile (left <= right) {\n\t\twhile (compare(array[left], pivot) < 0) {\n\t\t\t++left;\n\t\t}\n\n\t\twhile (compare(array[right], pivot) > 0) {\n\t\t\t--right;\n\t\t}\n\n\t\tif (left <= right) {\n\t\t\ttemp = array[left];\n\t\t\tarray[left++] = array[right];\n\t\t\tarray[right--] = temp;\n\t\t}\n\t}\n\t/* eslint-enable */\n\n\treturn left;\n}\n\nfunction qsSort<T>(array: T[], compare: Compare<T>, left: number, right: number) {\n\tconst mid = qsPartition(array, compare, left, right);\n\tif (left < mid - 1) {\n\t\tqsSort(array, compare, left, mid - 1);\n\t}\n\n\tif (right > mid) {\n\t\tqsSort(array, compare, mid, right);\n\t}\n}\n", "import { isAroundZero } from '~/utils/math';\n\ninterface TransitionInfo {\n\t[key: string]: number;\n\treadonly $startTime: number;\n}\n\nexport interface Easing {\n\t(x: number): number;\n}\n\nexport interface TransitionsInit<TKeys extends string> {\n\tduration: number;\n\teasing: Easing;\n\tkeys: readonly TKeys[];\n}\n\nexport type Transition<TKeys extends string> = { [K in TKeys]: number };\n\nexport class Transitions<TKeys extends string> {\n\tprivate readonly duration!: number;\n\tprivate readonly easing!: Easing;\n\tprivate readonly keys!: readonly TKeys[];\n\tprivate readonly map = new Map<string, TransitionInfo[]>();\n\tprivate transitionCount = 0;\n\n\tpublic constructor(init: TransitionsInit<TKeys>) {\n\t\tObject.assign(this, init);\n\t}\n\n\tpublic get hasTransitions() {\n\t\treturn this.transitionCount > 0;\n\t}\n\n\tpublic add(target: string, values: Partial<Transition<TKeys>>, $startTime = Transitions.now()) {\n\t\tlet transitions = this.map.get(target);\n\t\tlet transition = transitions?.find(existing => isAroundZero(existing.$startTime - $startTime));\n\n\t\tif (transition) {\n\t\t\tfor (let key, ki = 0; ki < this.keys.length; ++ki) {\n\t\t\t\tkey = this.keys[ki];\n\t\t\t\ttransition[key] += values[key] ?? 0;\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\ttransition = { $startTime };\n\n\t\tlet isAllZeroes = true;\n\t\tfor (let key, value, ki = 0; ki < this.keys.length; ++ki) {\n\t\t\tkey = this.keys[ki];\n\t\t\tvalue = values[key] ?? 0;\n\n\t\t\ttransition[key] = value;\n\t\t\tisAllZeroes &&= isAroundZero(value);\n\t\t}\n\n\t\tif (isAllZeroes) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!transitions) {\n\t\t\tthis.map.set(target, transitions = []);\n\t\t}\n\n\t\t++this.transitionCount;\n\t\ttransitions.push(transition);\n\t}\n\n\tpublic getFrame(target: string, now = Transitions.now()) {\n\t\tconst transitions = this.map.get(target);\n\t\tif (!transitions) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst { keys } = this;\n\t\tconst frame = {} as Transition<TKeys>;\n\t\tfor (let ki = 0; ki < keys.length; ++ki) {\n\t\t\tframe[keys[ki]] = 0;\n\t\t}\n\n\t\tlet ti = 0;\n\t\twhile (ti < transitions.length) {\n\t\t\tconst transition = transitions[ti];\n\n\t\t\tlet x = 1 - (now - transition.$startTime) / this.duration;\n\t\t\tif (x <= 0) {\n\t\t\t\ttransitions.splice(ti, 1);\n\t\t\t\t--this.transitionCount;\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tx = this.easing(x);\n\t\t\tfor (let ki = 0; ki < keys.length; ++ki) {\n\t\t\t\tconst key = keys[ki];\n\t\t\t\tframe[key] += transition[key] * x;\n\t\t\t}\n\n\t\t\t++ti;\n\t\t}\n\n\t\tif (transitions.length === 0) {\n\t\t\tthis.map.delete(target);\n\t\t}\n\n\t\treturn frame;\n\t}\n\n\tpublic static now() {\n\t\treturn performance.now();\n\t}\n}\n", "import type { Graph, GraphNode, Move, Point } from '~/types';\nimport { isAroundZero, ORIGIN } from '~/utils/math';\n\nexport interface CachedCell extends Move<GraphNode> {\n\thasMoved: boolean;\n\tisFixed?: boolean;\n\tvisit?: number;\n}\n\ninterface GridChunk {\n\treadonly grid: (CachedCell | undefined)[];\n\treadonly baseX: number;\n\treadonly baseY: number;\n}\n\nconst DIRECTIONS = [\n\t 1,  0,\n\t 0, -1,\n\t-1,  0,\n\t 0,  1\n];\n\nexport class CachedGridAccessor {\n\tprivate readonly chunks = new Map<number, GridChunk>();\n\tprivate readonly movedCells: CachedCell[] = [];\n\tprivate readonly moves: Move<GraphNode>[] = [];\n\tprivate readonly safeOriginX: number;\n\tprivate readonly safeOriginY: number;\n\n\tprivate searchCounter = 0;\n\n\tpublic constructor(\n\t\tprivate readonly graph: Graph,\n\t\torigin: Readonly<Point> = ORIGIN,\n\t\tprivate readonly chunkSize = 16\n\t) {\n\t\tthis.safeOriginX = Math.floor(origin.x - chunkSize / 2);\n\t\tthis.safeOriginY = Math.floor(origin.y - chunkSize / 2);\n\t}\n\n\tpublic insertNode(ref: GraphNode, x: number, y: number) {\n\t\tthis.findCheapestMoves(x, y)!.forEach(this.moveCell);\n\n\t\tconst chunk = this.getChunk(x, y);\n\t\tconst index = this.getGridIndex(chunk, x, y);\n\t\tif (chunk.grid[index]) {\n\t\t\tthrow new Error('insertNode: cannot insert to an occupied cell');\n\t\t}\n\n\t\tconst cell = {\n\t\t\tref,\n\t\t\tx,\n\t\t\ty,\n\t\t\thasMoved: true,\n\t\t\tisFixed: true\n\t\t};\n\n\t\tchunk.grid[index] = cell;\n\t\tthis.moves.push(cell);\n\t}\n\n\tpublic commit() {\n\t\tconst extraMoves = [];\n\t\tfor (const cell of this.movedCells) {\n\t\t\tconst { ref: node, x, y } = cell;\n\t\t\tif (isAroundZero(x - node.x) && isAroundZero(y - node.y)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tthis.moves.unshift(cell);\n\t\t\textraMoves.push({\n\t\t\t\tref: node,\n\t\t\t\tx: node.x - x,\n\t\t\t\ty: node.y - y\n\t\t\t});\n\t\t}\n\n\t\tthis.graph.beginMoveNodes(extraMoves.map(move => move.ref));\n\t\tthis.graph.endMoveNodes(this.moves);\n\t\treturn extraMoves;\n\t}\n\n\tprivate getChunk(x: number, y: number) {\n\t\tconst { chunkSize } = this;\n\t\tconst chunkX = Math.floor((x - this.safeOriginX) / chunkSize);\n\t\tconst chunkY = Math.floor((y - this.safeOriginY) / chunkSize);\n\n\t\tconst chunkId = (int16(chunkX) << 16) | int16(chunkY);\n\n\t\tlet chunk = this.chunks.get(chunkId);\n\t\tif (!chunk) {\n\t\t\tconst baseX = this.safeOriginX + chunkX * chunkSize;\n\t\t\tconst baseY = this.safeOriginY + chunkY * chunkSize;\n\t\t\tconst nodes = this.graph.getNodesWithin(\n\t\t\t\tbaseX,\n\t\t\t\tbaseY,\n\t\t\t\tbaseX + chunkSize - 1,\n\t\t\t\tbaseY + chunkSize - 1\n\t\t\t);\n\n\t\t\tconst grid = new Array<CachedCell | undefined>(chunkSize * chunkSize);\n\t\t\tfor (let node, i = 0; i < nodes.length; ++i) {\n\t\t\t\tnode = nodes[i];\n\t\t\t\tgrid[(node.x - baseX) * chunkSize + node.y - baseY] = {\n\t\t\t\t\tref: node,\n\t\t\t\t\tx: node.x,\n\t\t\t\t\ty: node.y,\n\t\t\t\t\thasMoved: false\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tthis.chunks.set(chunkId, chunk = {\n\t\t\t\tgrid,\n\t\t\t\tbaseX,\n\t\t\t\tbaseY\n\t\t\t});\n\t\t}\n\n\t\treturn chunk;\n\t}\n\n\tprivate getGridIndex(chunk: GridChunk, x: number, y: number) {\n\t\treturn (x - chunk.baseX) * this.chunkSize + y - chunk.baseY;\n\t}\n\n\tprivate getCellAt(x: number, y: number) {\n\t\tconst chunk = this.getChunk(x, y);\n\t\tconst index = this.getGridIndex(chunk, x, y);\n\t\treturn chunk.grid[index];\n\t}\n\n\tprivate findCheapestMoves(x: number, y: number) {\n\t\tconst first = this.getCellAt(x, y);\n\t\tif (!first) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst current = this.searchCounter++;\n\t\tconst queue: Move<CachedCell>[][] = [];\n\t\tconst visitCell = (cell: CachedCell, moves: readonly Move<CachedCell>[]) => {\n\t\t\tcell.visit = current;\n\n\t\t\tlet di = 0;\n\t\t\tdo {\n\t\t\t\tconst nextMoves = moves.slice();\n\t\t\t\tnextMoves.unshift({\n\t\t\t\t\tref: cell,\n\t\t\t\t\tx: cell.x + DIRECTIONS[di++],\n\t\t\t\t\ty: cell.y + DIRECTIONS[di++]\n\t\t\t\t});\n\n\t\t\t\tqueue.push(nextMoves);\n\t\t\t}\n\t\t\twhile (di < DIRECTIONS.length);\n\t\t};\n\n\t\tvisitCell(first, []);\n\t\tlet result;\n\n\t\tdo {\n\t\t\tconst moves = queue.shift()!;\n\t\t\tconst cell = this.getCellAt(moves[0].x, moves[0].y);\n\t\t\tif (!cell) {\n\t\t\t\tresult = moves;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (cell.visit === current || cell.isFixed) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvisitCell(cell, moves);\n\t\t}\n\t\twhile (queue.length > 0);\n\n\t\tif (!result) {\n\t\t\tthrow new Error('findCheapestMoves: could not find a path');\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprivate readonly moveCell = ({ ref: cell, x, y }: Move<CachedCell>) => {\n\t\tconst dstChunk = this.getChunk(x, y);\n\t\tconst dstIndex = this.getGridIndex(dstChunk, x, y);\n\t\tif (dstChunk.grid[dstIndex]) {\n\t\t\tthrow new Error('moveCell: cannot move to an occupied cell');\n\t\t}\n\n\t\tconst srcChunk = this.getChunk(cell.x, cell.y);\n\t\tconst srcIndex = this.getGridIndex(srcChunk, cell.x, cell.y);\n\t\tsrcChunk.grid[srcIndex] = undefined;\n\n\t\tcell.x = x;\n\t\tcell.y = y;\n\t\tdstChunk.grid[dstIndex] = cell;\n\n\t\tif (!cell.hasMoved) {\n\t\t\tthis.movedCells.push(cell);\n\t\t\tcell.hasMoved = true;\n\t\t}\n\t};\n}\n\nfunction int16(n: number) {\n\treturn (\n\t\t((n >> 16) & 0x8000) | // sign\n\t\t( n        & 0x7fff)   // value\n\t);\n}\n", "import type { Graph, GraphNode, Point } from '~/types';\nimport { quickSort } from '~/utils/quicksort';\n\nimport { Transitions } from '../../Transitions';\nimport type { GridPoint } from '../../types';\nimport { CachedGridAccessor } from './CachedGridAccessor';\n\nexport function endMoveNodes(\n\tgraph: Graph,\n\tnodes: GraphNode[],\n\ttransitions: Transitions<keyof Point>,\n\toffset: GridPoint\n) {\n\t// find the center of the nodes being moved\n\tlet cx = 0;\n\tlet cy = 0;\n\n\tfor (let i = 0; i < nodes.length; ++i) {\n\t\tconst node = nodes[i];\n\t\tcx += node.x;\n\t\tcy += node.y;\n\t}\n\n\tcx /= nodes.length;\n\tcy /= nodes.length;\n\n\t// We must sort the nodes first to move them in a specific order to avoid\n\t// locking underlying nodes inside. For optimal results we sort by the\n\t// manhattan distance from center in an ascending order\n\tconst dist = (node: GraphNode) => (node.x - cx) ** 2 + (node.y - cy) ** 2;\n\tquickSort(nodes, (a, b) => dist(a) - dist(b));\n\n\t// create a cached accessor reducing the number of RTree queries\n\tconst accessor = new CachedGridAccessor(graph, {\n\t\tx: offset.x + cx,\n\t\ty: offset.y + cy\n\t});\n\n\tconst now = Transitions.now();\n\tfor (const node of nodes) {\n\t\taccessor.insertNode(node, node.x + offset.x, node.y + offset.y);\n\t\ttransitions.add(node.id, offset.frac, now);\n\t}\n\n\taccessor.commit().forEach(move => {\n\t\ttransitions.add(move.ref.id, move, now);\n\t});\n}\n", "import type { Point } from '~/types';\n\n// the radius of node shapes\nexport const SHAPE_RADIUS = 0.8;\n\n// the offset of in/out pins\nexport const PIN_OFFSET: Point = {\n\tx: 0,\n\ty: 0.8\n};\n\n// the radius of in/out pins\nexport const PIN_RADIUS = 0.2;\n", "export const GOLDEN_RATIO = 1.618034;\n\nexport type TypedArray =\n\t| Int8Array\n\t| Uint8Array\n\t| Uint8ClampedArray\n\t| Int16Array\n\t| Uint16Array\n\t| Int32Array\n\t| Uint32Array\n\t| Float32Array;\n\t// | Float64Array\n\t// | BigInt64Array\n\t// | BigUint64Array;\n\nexport interface AutoBufferArgs {\n\t/**\n\t * The initial size of the buffer.\n\t *\n\t * Defaults to 0.\n\t */\n\tinitialCapacity?: number;\n\n\t/**\n\t * The factor used to grow the buffer when allocating more space. Must be\n\t * greater than one.\n\t *\n\t * Defaults to the golden ratio (~1.62).\n\t */\n\tgrowthFactor?: number;\n\n\t/**\n\t * The binding target for the buffer, a GL constant.\n\t *\n\t * Defaults to gl.ARRAY_BUFFER.\n\t */\n\ttarget?: number;\n}\n\n/**\n * Used to cache the size of GL buffers to avoid calling `getBufferParameter`\n * which tends to be very sluggish for some reason...\n */\nexport interface WebGLBufferKnownSize {\n\treadonly ref: WebGLBuffer;\n\tsize: number;\n}\n\nexport function createBufferKnownSize(gl: WebGL2RenderingContext): WebGLBufferKnownSize {\n\treturn {\n\t\tref: gl.createBuffer()!,\n\t\tsize: 0\n\t};\n}\n\nexport class AutoBuffer<TData extends TypedArray> {\n\tpublic data: TData;\n\n\tprivate readonly target?: number;\n\tprivate readonly growthFactor: number;\n\tprivate usedCapacity = 0;\n\n\tpublic constructor(\n\t\tprivate readonly alloc: (capacity: number) => TData,\n\t\toptions?: AutoBufferArgs\n\t) {\n\t\tthis.target = options?.target;\n\t\tthis.growthFactor = options?.growthFactor ?? GOLDEN_RATIO;\n\t\tthis.data = alloc(options?.initialCapacity ?? 0);\n\t}\n\n\tpublic get capacity() {\n\t\treturn this.data.length;\n\t}\n\n\tpublic resize(requiredCapacity: number, preserveContents = true) {\n\t\tthis.usedCapacity = requiredCapacity;\n\n\t\tconst oldCapacity = Math.max(this.data.length, 1);\n\t\tif (requiredCapacity < oldCapacity) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst exponent = Math.ceil(Math.log(requiredCapacity / oldCapacity) / Math.log(this.growthFactor));\n\t\tconst newCapacity = Math.trunc(oldCapacity * this.growthFactor ** exponent);\n\t\tconst oldData = this.data;\n\n\t\tthis.data = this.alloc(newCapacity);\n\t\tif (preserveContents) {\n\t\t\tthis.data.set(oldData);\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tpublic commit(gl: WebGL2RenderingContext, buffer: WebGLBufferKnownSize | WebGLBuffer) {\n\t\tconst target = this.target ?? gl.ARRAY_BUFFER;\n\n\t\tlet bks = buffer as WebGLBufferKnownSize;\n\t\tif (bks.ref as WebGLBuffer | undefined) {\n\t\t\tgl.bindBuffer(target, bks.ref);\n\t\t}\n\t\telse {\n\t\t\tgl.bindBuffer(target, buffer);\n\t\t\tbks = {\n\t\t\t\tref: buffer,\n\t\t\t\tsize: gl.getBufferParameter(target, gl.BUFFER_SIZE)\n\t\t\t};\n\t\t}\n\n\t\tconst requiredSize = this.usedCapacity * this.data.BYTES_PER_ELEMENT;\n\t\tif (bks.size < requiredSize) {\n\t\t\tgl.bufferData(target, this.data, gl.DYNAMIC_READ);\n\t\t\tbks.size = this.data.byteLength;\n\t\t}\n\t\telse {\n\t\t\tgl.bufferSubData(target, 0, this.data, 0, this.usedCapacity);\n\t\t}\n\t}\n}\n", "import type { RGB } from '../types';\n\nexport function rgb2vec(rgb: RGB): [ r: number, g: number, b: number ] {\n\treturn [\n\t\t((rgb >> 16) & 255) / 255, // R\n\t\t((rgb >>  8) & 255) / 255, // G\n\t\t( rgb        & 255) / 255  // B\n\t];\n}\n\nexport interface ShaderArgs {\n\treadonly source: string;\n\treadonly type: number;\n}\n\nexport interface ProgramArgs {\n\treadonly shaders: readonly ShaderArgs[];\n\treadonly attributes: readonly string[];\n\treadonly uniforms: readonly string[];\n}\n\ntype KeysOf<T> = T extends readonly (infer TKey)[] ? TKey : keyof any;\ntype ReadonlyRecord<K extends keyof any, T> = { readonly [P in K]: T };\n\nexport function createProgram<TArgs extends ProgramArgs>(gl: WebGL2RenderingContext, args: TArgs) {\n\tconst program = gl.createProgram()!;\n\tfor (const shaderArgs of args.shaders) {\n\t\tconst shader = compileShader(gl, shaderArgs);\n\t\tgl.attachShader(program, shader);\n\t}\n\n\tgl.linkProgram(program);\n\tif (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\n\t\tthrow new Error('Error linking program:\\n' + gl.getProgramInfoLog(program));\n\t}\n\n\treturn {\n\t\tref: program,\n\t\tattributes: mapTuple(\n\t\t\targs.attributes,\n\t\t\tname => gl.getAttribLocation(program, name)\n\t\t) as ReadonlyRecord<KeysOf<TArgs['attributes']>, number>,\n\t\tuniforms: mapTuple(\n\t\t\targs.uniforms,\n\t\t\tname => gl.getUniformLocation(program, name)!\n\t\t) as ReadonlyRecord<KeysOf<TArgs['uniforms']>, WebGLUniformLocation>\n\t};\n}\n\nfunction compileShader(gl: WebGL2RenderingContext, args: ShaderArgs) {\n\tconst shader = gl.createShader(args.type)!;\n\tgl.shaderSource(shader, args.source);\n\tgl.compileShader(shader);\n\n\tif (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n\t\tconst type = {\n\t\t\t[gl.VERTEX_SHADER]: 'vertex',\n\t\t\t[gl.FRAGMENT_SHADER]: 'fragment'\n\t\t}[args.type] || 'a';\n\n\t\tthrow new Error(`Error compiling ${type} shader:\\n${gl.getShaderInfoLog(shader)}`);\n\t}\n\n\treturn shader;\n}\n\nfunction mapTuple<T>(tuple: readonly string[], callback: (key: string) => T) {\n\tconst map: Record<string, T> = {};\n\tfor (const key of tuple) {\n\t\tmap[key] = callback(key);\n\t}\n\n\treturn map;\n}\n", "import type { GraphNode } from '~/types';\n\nimport { PIN_OFFSET } from '../../constants';\nimport type { Renderer, RendererInit } from '../../types';\nimport { AutoBuffer, createBufferKnownSize } from '../AutoBuffer';\nimport { createProgram } from '../utils';\nimport edgeFragmentShader from './edge.fragment.glsl';\nimport edgeVertexShader from './edge.vertex.glsl';\n\nexport function createEdgeRenderer(gl: WebGL2RenderingContext, _init: RendererInit): Renderer {\n\tconst program = createProgram(gl, {\n\t\tshaders: [\n\t\t\t{\n\t\t\t\tsource: edgeVertexShader,\n\t\t\t\ttype: gl.VERTEX_SHADER\n\t\t\t},\n\t\t\t{\n\t\t\t\tsource: edgeFragmentShader,\n\t\t\t\ttype: gl.FRAGMENT_SHADER\n\t\t\t}\n\t\t],\n\t\tattributes: [ 'aGridPos' ],\n\t\tuniforms: [ 'uOffset', 'uViewMatrix' ]\n\t} as const);\n\n\tconst vao = gl.createVertexArray();\n\tgl.bindVertexArray(vao);\n\n\t//#region Edge Attribute Buffers\n\n\tconst nodePosGlBuffer = createBufferKnownSize(gl);\n\tconst nodePosBuffer = new AutoBuffer(\n\t\tcapacity => new Float32Array(capacity)\n\t);\n\n\tgl.bindBuffer(gl.ARRAY_BUFFER, nodePosGlBuffer.ref);\n\n\tgl.enableVertexAttribArray(program.attributes.aGridPos);\n\tgl.vertexAttribPointer(program.attributes.aGridPos, 2, gl.FLOAT, false, 0, 0);\n\n\t//#endregion\n\n\treturn {\n\t\trender(state) {\n\t\t\tconst { edges } = state;\n\t\t\tif (edges.length === 0) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tgl.useProgram(program.ref);\n\t\t\tgl.bindVertexArray(vao);\n\n\t\t\tnodePosBuffer.resize(edges.length * 4, false);\n\t\t\tconst { data } = nodePosBuffer;\n\n\t\t\tlet di = 0;\n\t\t\tconst addPoint = (node: GraphNode) => {\n\t\t\t\tdata[di++] = (node.virtualPos ?? node).x;\n\t\t\t\tdata[di++] = (node.virtualPos ?? node).y;\n\t\t\t};\n\n\t\t\tfor (let edge, i = 0; i < edges.length; ++i) {\n\t\t\t\tedge = edges[i];\n\t\t\t\taddPoint(edge.source);\n\t\t\t\taddPoint(edge.destination);\n\t\t\t}\n\n\t\t\tnodePosBuffer.commit(gl, nodePosGlBuffer);\n\n\t\t\tconst halfWidth = gl.drawingBufferWidth / 2;\n\t\t\tconst halfHeight = gl.drawingBufferHeight / 2;\n\n\t\t\tconst scaleX = state.gridSize / halfWidth;\n\t\t\tconst scaleY = state.gridSize / halfHeight;\n\t\t\tconst offsetX = state.gridOffset.x / halfWidth;\n\t\t\tconst offsetY = -state.gridOffset.y / halfHeight;\n\n\t\t\tgl.uniform2fv(program.uniforms.uOffset, [ PIN_OFFSET.x / 2, PIN_OFFSET.y / 2 ]);\n\t\t\tgl.uniformMatrix3x2fv(program.uniforms.uViewMatrix, false, [\n\t\t\t\t scaleX,       0,\n\t\t\t\t      0,  scaleY,\n\t\t\t\toffsetX, offsetY\n\t\t\t]);\n\n\t\t\tgl.drawArrays(gl.LINES, 0, edges.length * 2);\n\t\t}\n\t};\n}\n", "import type { Renderer, RendererInit } from '../../types';\nimport { createProgram, rgb2vec } from '../utils';\nimport gridFragmentShader from './grid.fragment.glsl';\nimport gridVertexShader from './grid.vertex.glsl';\n\nexport function createGridRenderer(gl: WebGL2RenderingContext, init: RendererInit): Renderer {\n\tconst program = createProgram(gl, {\n\t\tshaders: [\n\t\t\t{\n\t\t\t\tsource: gridVertexShader,\n\t\t\t\ttype: gl.VERTEX_SHADER\n\t\t\t},\n\t\t\t{\n\t\t\t\tsource: gridFragmentShader,\n\t\t\t\ttype: gl.FRAGMENT_SHADER\n\t\t\t}\n\t\t],\n\t\tattributes: [ 'aClipPosition' ],\n\t\tuniforms: [ 'uScreenSize', 'uGridOffset', 'uGridSize', 'uBackgroundColor', 'uGridlineColor' ]\n\t} as const);\n\n\tconst vao = gl.createVertexArray();\n\tgl.bindVertexArray(vao);\n\n\tconst clipPosGlBuffer = gl.createBuffer();\n\tconst clipPosData = new Int8Array([\n\t\t-1, -1,\n\t\t 1, -1,\n\t\t-1,  1,\n\t\t 1,  1\n\t]);\n\n\tgl.bindBuffer(gl.ARRAY_BUFFER, clipPosGlBuffer);\n\tgl.bufferData(gl.ARRAY_BUFFER, clipPosData, gl.STATIC_READ);\n\n\tgl.enableVertexAttribArray(program.attributes.aClipPosition);\n\tgl.vertexAttribPointer(program.attributes.aClipPosition, 2, gl.BYTE, false, 0, 0);\n\n\tconst backgroundColor = rgb2vec(init.backgroundColor);\n\tconst gridlineColor = rgb2vec(init.gridlineColor);\n\n\treturn {\n\t\trender(state) {\n\t\t\tgl.useProgram(program.ref);\n\t\t\tgl.bindVertexArray(vao);\n\n\t\t\tgl.uniform2fv(program.uniforms.uScreenSize, [ gl.drawingBufferWidth, gl.drawingBufferHeight ]);\n\t\t\tgl.uniform2fv(program.uniforms.uGridOffset, [ state.gridOffset.x, state.gridOffset.y ]);\n\t\t\tgl.uniform1f(program.uniforms.uGridSize, state.gridSize);\n\t\t\tgl.uniform3fv(program.uniforms.uBackgroundColor, backgroundColor);\n\t\t\tgl.uniform3fv(program.uniforms.uGridlineColor, gridlineColor);\n\n\t\t\tgl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n\t\t}\n\t};\n}\n", "import { SHAPE_RADIUS, PIN_OFFSET, PIN_RADIUS } from '../../constants';\nimport type { Shape } from '../../types';\n\ninterface RenderTarget {\n\t(d2: OffscreenCanvasRenderingContext2D, centerX: number, centerY: number, halfSize: number): void;\n}\n\nfunction composeTexture(targets: readonly RenderTarget[], resolution: number) {\n\tconst divisions = Math.ceil(Math.sqrt(targets.length));\n\tconst size = divisions * resolution;\n\tconst canvas = new OffscreenCanvas(size, size);\n\tconst d2 = canvas.getContext('2d', {\n\t\talpha: false,\n\t\tdesynchronized: true,\n\t\twillReadFrequently: false\n\t});\n\n\tif (!d2) {\n\t\tthrow new Error('Could not obtain offscreen 2D rendering context.');\n\t}\n\n\td2.clearRect(0, 0, size, size);\n\n\tconst halfSize = resolution / 2;\n\tfor (let i = 0; i < targets.length; ++i) {\n\t\ttargets[i](\n\t\t\td2,\n\t\t\thalfSize +           (i % divisions) * resolution,\n\t\t\thalfSize + Math.trunc(i / divisions) * resolution,\n\t\t\thalfSize\n\t\t);\n\t}\n\n\treturn {\n\t\t// FUTURE: cast to any shouldn't be necessary once OffscreenCanvas receives wider support\n\t\tsource: canvas as any as TexImageSource,\n\t\tdivisions\n\t};\n}\n\nconst STROKE_THICKNESS = 1 / 12;\nconst MASK = '#ffff00';\nconst OUTLINE = '#ff0000';\nconst TAU = Math.PI * 2;\n\nfunction drawShape(shape: Shape, d2: OffscreenCanvasRenderingContext2D, centerX: number, centerY: number, halfSize: number) {\n\tconst radius = halfSize * SHAPE_RADIUS;\n\td2.fillStyle = OUTLINE;\n\n\td2.beginPath();\n\td2.arc(centerX + halfSize * PIN_OFFSET.x, centerY + halfSize * PIN_OFFSET.y, halfSize * PIN_RADIUS, 0, TAU);\n\td2.fill();\n\n\td2.beginPath();\n\td2.arc(centerX - halfSize * PIN_OFFSET.x, centerY - halfSize * PIN_OFFSET.y, halfSize * PIN_RADIUS, 0, TAU);\n\td2.fill();\n\n\td2.fillStyle = MASK;\n\td2.strokeStyle = OUTLINE;\n\td2.lineJoin = 'round';\n\td2.lineWidth = Math.max(1, halfSize * STROKE_THICKNESS);\n\n\td2.beginPath();\n\td2.moveTo(\n\t\tMath.round(centerX + shape[0] * radius),\n\t\tMath.round(centerY + shape[1] * radius)\n\t);\n\n\tlet i = 2;\n\twhile (i < shape.length) {\n\t\td2.lineTo(\n\t\t\tMath.round(centerX + shape[i++] * radius),\n\t\t\tMath.round(centerY + shape[i++] * radius)\n\t\t);\n\t}\n\n\td2.closePath();\n\td2.fill();\n\td2.stroke();\n}\n\nexport function composeShapesTexture(shapes: readonly Shape[], resolution: number) {\n\tconst targets: RenderTarget[] = [];\n\tfor (let i = 0; i < shapes.length; ++i) {\n\t\ttargets.push(\n\t\t\tdrawShape.bind(null, shapes[i])\n\t\t);\n\t}\n\n\treturn composeTexture(targets, resolution);\n}\n", "import type { Renderer, RendererInit } from '../../types';\nimport { AutoBuffer, createBufferKnownSize } from '../AutoBuffer';\nimport { createProgram, rgb2vec } from '../utils';\nimport nodeFragmentShader from './node.fragment.glsl';\nimport nodeVertexShader from './node.vertex.glsl';\nimport { composeShapesTexture } from './ShapeTextureRenderer';\n\nexport function createNodeRenderer(gl: WebGL2RenderingContext, init: RendererInit): Renderer {\n\tconst program = createProgram(gl, {\n\t\tshaders: [\n\t\t\t{\n\t\t\t\tsource: nodeVertexShader,\n\t\t\t\ttype: gl.VERTEX_SHADER\n\t\t\t},\n\t\t\t{\n\t\t\t\tsource: nodeFragmentShader,\n\t\t\t\ttype: gl.FRAGMENT_SHADER\n\t\t\t}\n\t\t],\n\t\tattributes: [ 'aCellPos', 'aGridPos', 'aColor', 'aTexIndex' ],\n\t\tuniforms: [ 'uViewMatrix', 'uTexDiv', 'uShapes', 'uDefaultStrokeColor', 'uSelectedStrokeColor' ]\n\t} as const);\n\n\tconst vao = gl.createVertexArray();\n\tgl.bindVertexArray(vao);\n\n\t//#region Grid Cell Vertices\n\n\tconst cellPosGlBuffer = gl.createBuffer();\n\tconst cellPosData = new Float32Array([\n\t\t-0.5, -0.5,\n\t\t 0.5, -0.5,\n\t\t-0.5,  0.5,\n\t\t 0.5,  0.5\n\t]);\n\n\tgl.bindBuffer(gl.ARRAY_BUFFER, cellPosGlBuffer);\n\tgl.bufferData(gl.ARRAY_BUFFER, cellPosData, gl.STATIC_READ);\n\n\tgl.enableVertexAttribArray(program.attributes.aCellPos);\n\tgl.vertexAttribPointer(program.attributes.aCellPos, 2, gl.FLOAT, false, 0, 0);\n\tgl.vertexAttribDivisor(program.attributes.aCellPos, 0);\n\n\t//#endregion\n\n\t//#region Node Attributes\n\n\tconst nodeGlBuffer = createBufferKnownSize(gl);\n\tconst nodeDataBuffer = new AutoBuffer(\n\t\tcapacity => new Float32Array(capacity)\n\t);\n\n\tgl.bindBuffer(gl.ARRAY_BUFFER, nodeGlBuffer.ref);\n\n\tgl.enableVertexAttribArray(program.attributes.aGridPos);\n\tgl.vertexAttribPointer(program.attributes.aGridPos, 2, gl.FLOAT, false, 16, 0);\n\tgl.vertexAttribDivisor(program.attributes.aGridPos, 1);\n\n\tgl.enableVertexAttribArray(program.attributes.aColor);\n\tgl.vertexAttribIPointer(program.attributes.aColor, 1, gl.UNSIGNED_INT, 16, 8);\n\tgl.vertexAttribDivisor(program.attributes.aColor, 1);\n\n\tgl.enableVertexAttribArray(program.attributes.aTexIndex);\n\tgl.vertexAttribPointer(program.attributes.aTexIndex, 1, gl.FLOAT, false, 16, 12);\n\tgl.vertexAttribDivisor(program.attributes.aTexIndex, 1);\n\n\t//#endregion\n\n\t//#region Pre-rendered Shape Textures\n\n\tconst shapes = composeShapesTexture(init.shapes, init.shapeResolution);\n\tconst shapesGlTex = gl.createTexture();\n\n\tgl.activeTexture(gl.TEXTURE0);\n\tgl.bindTexture(gl.TEXTURE_2D, shapesGlTex);\n\n\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n\n\tgl.texImage2D(gl.TEXTURE_2D, 0, gl.RGB, gl.RGB, gl.UNSIGNED_BYTE, shapes.source);\n\n\t//#endregion\n\n\tconst defaultStrokeColor = rgb2vec(init.defaultStrokeColor);\n\tconst selectedStrokeColor = rgb2vec(init.selectedStrokeColor);\n\n\treturn {\n\t\trender(state) {\n\t\t\tconst { nodes, selectedNodes } = state;\n\t\t\tif (nodes.length === 0) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tgl.useProgram(program.ref);\n\t\t\tgl.bindVertexArray(vao);\n\n\t\t\tnodeDataBuffer.resize(nodes.length * 4, false);\n\t\t\tconst { data } = nodeDataBuffer;\n\t\t\tconst dataUInt = new Uint32Array(data.buffer);\n\n\t\t\tlet di = 0;\n\t\t\tfor (let node, i = 0; i < nodes.length; ++i) {\n\t\t\t\tnode = nodes[i];\n\t\t\t\tdata[di++] = (node.virtualPos ?? node).x;\n\t\t\t\tdata[di++] = (node.virtualPos ?? node).y;\n\t\t\t\tdataUInt[di++] = (node.color ?? 0xffffff) | (selectedNodes.has(node) ? 0x1000000 : 0);\n\t\t\t\tdata[di++] = node.shapeIndex ?? 0;\n\t\t\t}\n\n\t\t\tnodeDataBuffer.commit(gl, nodeGlBuffer);\n\n\t\t\tconst halfWidth = gl.drawingBufferWidth / 2;\n\t\t\tconst halfHeight = gl.drawingBufferHeight / 2;\n\n\t\t\tconst scaleX = state.gridSize / halfWidth;\n\t\t\tconst scaleY = state.gridSize / halfHeight;\n\t\t\tconst offsetX = state.gridOffset.x / halfWidth;\n\t\t\tconst offsetY = -state.gridOffset.y / halfHeight;\n\n\t\t\tgl.uniform1i(program.uniforms.uShapes, 0);\n\t\t\tgl.uniform1f(program.uniforms.uTexDiv, shapes.divisions);\n\t\t\tgl.uniform3fv(program.uniforms.uDefaultStrokeColor, defaultStrokeColor);\n\t\t\tgl.uniform3fv(program.uniforms.uSelectedStrokeColor, selectedStrokeColor);\n\t\t\tgl.uniformMatrix3x2fv(program.uniforms.uViewMatrix, false, [\n\t\t\t\t scaleX,       0,\n\t\t\t\t      0,  scaleY,\n\t\t\t\toffsetX, offsetY\n\t\t\t]);\n\n\t\t\tgl.drawArraysInstanced(gl.TRIANGLE_STRIP, 0, 4, nodes.length);\n\t\t}\n\t};\n}\n", "import { DragMode, Renderer, RendererInit } from '../../types';\nimport { createProgram, rgb2vec } from '../utils';\nimport selectionFragmentShader from './selection.fragment.glsl';\nimport selectionVertexShader from './selection.vertex.glsl';\n\nexport function createSelectionRenderer(gl: WebGL2RenderingContext, init: RendererInit): Renderer {\n\tconst program = createProgram(gl, {\n\t\tshaders: [\n\t\t\t{\n\t\t\t\tsource: selectionVertexShader,\n\t\t\t\ttype: gl.VERTEX_SHADER\n\t\t\t},\n\t\t\t{\n\t\t\t\tsource: selectionFragmentShader,\n\t\t\t\ttype: gl.FRAGMENT_SHADER\n\t\t\t}\n\t\t],\n\t\tattributes: [ 'aClipPos' ],\n\t\tuniforms: [ 'uSelectedStrokeColor', 'uDashSize' ]\n\t} as const);\n\n\tconst vao = gl.createVertexArray();\n\tgl.bindVertexArray(vao);\n\n\tconst clipPosGlBuffer = gl.createBuffer();\n\tconst clipPosData = new Float32Array(8);\n\n\tgl.bindBuffer(gl.ARRAY_BUFFER, clipPosGlBuffer);\n\tgl.bufferData(gl.ARRAY_BUFFER, clipPosData, gl.STATIC_READ);\n\tgl.enableVertexAttribArray(program.attributes.aClipPos);\n\tgl.vertexAttribPointer(program.attributes.aClipPos, 2, gl.FLOAT, false, 0, 0);\n\n\tconst selectedStrokeColor = rgb2vec(init.selectedStrokeColor);\n\n\treturn {\n\t\trender({ gridOffset, gridSize, dragging }) {\n\t\t\tif (dragging?.mode !== DragMode.Selection) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tgl.useProgram(program.ref);\n\t\t\tgl.bindVertexArray(vao);\n\n\t\t\tconst halfWidth = gl.drawingBufferWidth / 2;\n\t\t\tconst halfHeight = gl.drawingBufferHeight / 2;\n\n\t\t\tconst toClipPos = (x: number, y: number, offset: number) => {\n\t\t\t\tclipPosData[offset    ] =  (x * gridSize + gridOffset.x) / halfWidth;\n\t\t\t\tclipPosData[offset + 1] = -(y * gridSize + gridOffset.y) / halfHeight;\n\t\t\t};\n\n\t\t\tconst s = dragging.start;\n\t\t\tconst o = dragging.offset;\n\t\t\ttoClipPos(s.x      , s.y      , 0);\n\t\t\ttoClipPos(s.x + o.x, s.y      , 2);\n\t\t\ttoClipPos(s.x + o.x, s.y + o.y, 4);\n\t\t\ttoClipPos(s.x      , s.y + o.y, 6);\n\n\t\t\tgl.bindBuffer(gl.ARRAY_BUFFER, clipPosGlBuffer);\n\t\t\tgl.bufferSubData(gl.ARRAY_BUFFER, 0, clipPosData);\n\n\t\t\tgl.uniform1f(program.uniforms.uDashSize, gridSize / 4);\n\t\t\tgl.uniform3fv(program.uniforms.uSelectedStrokeColor, selectedStrokeColor);\n\n\t\t\tgl.drawArrays(gl.LINE_LOOP, 0, 4);\n\t\t}\n\t};\n}\n", "import type { Renderer, RendererInit } from '../types';\nimport { createEdgeRenderer } from './edge/EdgeRenderer';\nimport { createGridRenderer } from './grid/GridRenderer';\nimport { createNodeRenderer } from './node/NodeRenderer';\nimport { createSelectionRenderer } from './selection/SelectionRenderer';\n\nexport interface GLRenderer extends Renderer {\n\tresize(width: number, height: number): void;\n}\n\nexport function createGLRenderer(canvas: HTMLCanvasElement, init: RendererInit): GLRenderer {\n\tconst gl = canvas.getContext('webgl2', {\n\t\talpha: false,\n\t\tantialias: false,\n\t\tdepth: false,\n\t\tdesynchronized: true,\n\t\tfailIfMajorPerformanceCaveat: true,\n\t\tpowerPreference: 'high-performance',\n\t\tpremultipliedAlpha: false,\n\t\tpreserveDrawingBuffer: false,\n\t\tstencil: false\n\t});\n\n\tif (!gl) {\n\t\tthrow new Error('Could not obtain WebGL rendering context.');\n\t}\n\n\tgl.enable(gl.BLEND);\n\tgl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\n\n\tconst gridRenderer = createGridRenderer(gl, init);\n\tconst edgeRenderer = createEdgeRenderer(gl, init);\n\tconst nodeRenderer = createNodeRenderer(gl, init);\n\tconst selectionRenderer = createSelectionRenderer(gl, init);\n\n\treturn {\n\t\trender(state) {\n\t\t\tgridRenderer.render(state);\n\t\t\tedgeRenderer.render(state);\n\t\t\tnodeRenderer.render(state);\n\t\t\tselectionRenderer.render(state);\n\t\t},\n\t\tresize(width, height) {\n\t\t\tif (canvas.width === width && canvas.height === height) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tcanvas.width = width;\n\t\t\tcanvas.height = height;\n\t\t\tgl.viewport(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\n\t\t}\n\t};\n}\n", "import * as Signal from '@calmdownval/signal';\n\nimport { DragGesture, EditorView, EditorViewProps, PanAndZoomGesture } from '~/components/EditorView';\nimport { Graph, GraphEdge, GraphNode, Point } from '~/types';\nimport { ORIGIN } from '~/utils/math';\n\nimport { endMoveNodes } from './operations/endMove/endMove';\nimport { createGLRenderer, GLRenderer } from './renderer/GLRenderer';\nimport { Transitions } from './Transitions';\nimport { DragMode, DragState, GridPoint, RGB, Shape } from './types';\n\nimport './GraphEditor.css';\n\nconst DPR = window.devicePixelRatio || 1;\n\nexport interface GraphEditorProps extends EditorViewProps {\n\treadonly graph: Graph;\n\treadonly gridSize: number;\n\n\treadonly backgroundColor: RGB;\n\treadonly gridlineColor: RGB;\n\treadonly defaultStrokeColor: RGB;\n\treadonly selectedStrokeColor: RGB;\n\n\treadonly shapes: readonly Shape[];\n}\n\nexport class GraphEditor extends EditorView<GraphEditorProps> {\n\tprotected readonly canvasCssClass = 'graph-editor';\n\n\tprivate readonly dragGesture: DragGesture;\n\tprivate readonly panAndZoomGesture: PanAndZoomGesture;\n\tprivate readonly selectedNodes = new Set<GraphNode>();\n\tprivate readonly transitions = new Transitions({\n\t\tduration: 300,\n\t\teasing: x => x ** 5,\n\t\tkeys: [ 'x', 'y' ]\n\t});\n\n\tprivate dragging?: DragState;\n\tprivate renderer?: GLRenderer;\n\n\tpublic constructor(props: GraphEditorProps) {\n\t\tsuper(props);\n\n\t\tthis.dragGesture = new DragGesture({\n\t\t\teditor: this\n\t\t});\n\n\t\tthis.panAndZoomGesture = new PanAndZoomGesture({\n\t\t\teditor: this,\n\t\t\tusePointerLock: true\n\t\t});\n\n\t\tSignal.on(this.dragGesture.drag, this.onDragMove);\n\t\tSignal.on(this.dragGesture.drop, this.onDragDrop);\n\t\tSignal.on(this.dragGesture.press, this.onNodePress);\n\t\tSignal.on(this.panAndZoomGesture.press, this.onVoidPress);\n\t}\n\n\tpublic componentWillUnmount() {\n\t\tsuper.componentWillUnmount();\n\t\tthis.renderer = undefined;\n\t}\n\n\tprotected canvasAcquired(canvas: HTMLCanvasElement) {\n\t\tthis.renderer = createGLRenderer(canvas, {\n\t\t\tbackgroundColor: this.props.backgroundColor,\n\t\t\tgridlineColor: this.props.gridlineColor,\n\t\t\tdefaultStrokeColor: this.props.defaultStrokeColor,\n\t\t\tselectedStrokeColor: this.props.selectedStrokeColor,\n\t\t\tshapes: this.props.shapes,\n\t\t\tshapeResolution: Math.round(this.props.maxZoom * this.props.gridSize * DPR)\n\t\t});\n\t}\n\n\tprotected canvasResized(width: number, height: number) {\n\t\tthis.renderer!.resize(\n\t\t\tMath.round(width * DPR),\n\t\t\tMath.round(height * DPR)\n\t\t);\n\t}\n\n\tprotected canvasRender() {\n\t\tconst rect = this.getVisibleRect();\n\t\tconst tl = this.editorToGridSpace(rect.topLeft);\n\t\tconst br = this.editorToGridSpace(rect.bottomRight);\n\n\t\tconst nodes = this.props.graph.getNodesWithin(tl.x, tl.y, br.x, br.y);\n\t\tconst edges = this.props.graph.getEdgesWithin(tl.x, tl.y, br.x, br.y);\n\n\t\tconst now = Transitions.now();\n\t\tfor (const node of nodes) {\n\t\t\tconst frame = this.transitions.getFrame(node.id, now);\n\t\t\tnode.virtualPos = frame\n\t\t\t\t? {\n\t\t\t\t\tx: node.x + frame.x,\n\t\t\t\t\ty: node.y + frame.y\n\t\t\t\t}\n\t\t\t\t: undefined;\n\t\t}\n\n\t\tswitch (this.dragging?.mode) {\n\t\t\tcase DragMode.Nodes: {\n\t\t\t\tconst { offset } = this.dragging;\n\t\t\t\tconst extraEdges = new Set<GraphEdge>();\n\t\t\t\tfor (const node of this.dragging.nodes) {\n\t\t\t\t\tnodes.push(node);\n\t\t\t\t\tnode.edges?.forEach(edge => extraEdges.add(edge));\n\t\t\t\t\tnode.virtualPos = {\n\t\t\t\t\t\tx: node.x + offset.x,\n\t\t\t\t\t\ty: node.y + offset.y\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\textraEdges.forEach(edge => edges.push(edge));\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tthis.renderer!.render({\n\t\t\tgridSize: Math.round(this.zoom * this.props.gridSize * DPR),\n\t\t\tgridOffset: {\n\t\t\t\tx: Math.round(this.offset.x * DPR),\n\t\t\t\ty: Math.round(this.offset.y * DPR)\n\t\t\t},\n\t\t\tnodes,\n\t\t\tedges,\n\t\t\tselectedNodes: this.selectedNodes,\n\t\t\tdragging: this.dragging\n\t\t});\n\n\t\treturn this.transitions.hasTransitions;\n\t}\n\n\tprotected hitTest(point: Point, e: PointerEvent) {\n\t\tconst gridPoint = this.editorToGridSpace(point);\n\t\tconst { graph } = this.props;\n\n\t\tif (e.ctrlKey || e.metaKey) {\n\t\t\tthis.dragging = {\n\t\t\t\tmode: DragMode.Selection,\n\t\t\t\tstart: gridPoint.raw,\n\t\t\t\toffset: { ...ORIGIN }\n\t\t\t};\n\n\t\t\tthis.updateView();\n\t\t\treturn this.dragGesture;\n\t\t}\n\n\t\tconst targetNode = graph.getNodeAt(gridPoint.x, gridPoint.y);\n\t\tif (targetNode) {\n\t\t\tif (e.shiftKey) {\n\t\t\t\tif (this.selectedNodes.has(targetNode)) {\n\t\t\t\t\tthis.selectedNodes.delete(targetNode);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.selectedNodes.add(targetNode);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (!this.selectedNodes.has(targetNode)) {\n\t\t\t\tthis.selectedNodes.clear();\n\t\t\t\tthis.selectedNodes.add(targetNode);\n\t\t\t}\n\n\t\t\tconst nodes = Array.from(this.selectedNodes);\n\n\t\t\tthis.dragging = {\n\t\t\t\tmode: DragMode.Nodes,\n\t\t\t\toffset: { ...ORIGIN },\n\t\t\t\tnodes\n\t\t\t};\n\n\t\t\tgraph.beginMoveNodes(nodes);\n\t\t\tthis.updateView();\n\t\t\treturn this.dragGesture;\n\t\t}\n\n\t\treturn this.panAndZoomGesture;\n\t}\n\n\tprotected getZoomAdjustment(nextZoom: number) {\n\t\t// We adjust the requested zoom level so that the final grid size in\n\t\t// device pixels is an even number.\n\t\tconst ratio = this.props.gridSize * DPR / 2;\n\t\treturn Math.round(nextZoom * ratio) / ratio;\n\t}\n\n\tprotected getWheelDeltaAdjustment(e: WheelEvent) {\n\t\tswitch (e.deltaMode) {\n\t\t\tcase WheelEvent.DOM_DELTA_PAGE:\n\t\t\t\treturn this.edgeBottomRight.y - this.edgeTopLeft.y;\n\n\t\t\tcase WheelEvent.DOM_DELTA_LINE:\n\t\t\t\treturn this.props.gridSize;\n\n\t\t\t// case WheelEvent.DOM_DELTA_PIXEL:\n\t\t\tdefault:\n\t\t\t\treturn 1;\n\t\t}\n\t}\n\n\tprivate editorToGridSpace(point: Point): GridPoint {\n\t\tconst raw: Point = {\n\t\t\tx: point.x / this.props.gridSize,\n\t\t\ty: point.y / this.props.gridSize\n\t\t};\n\n\t\tconst x = Math.round(raw.x);\n\t\tconst y = Math.round(raw.y);\n\t\treturn {\n\t\t\tx,\n\t\t\ty,\n\t\t\traw,\n\t\t\tfrac: {\n\t\t\t\tx: raw.x - x,\n\t\t\t\ty: raw.y - y\n\t\t\t}\n\t\t};\n\t}\n\n\t// fired when user taps/clicks empty space\n\tprivate readonly onVoidPress = () => {\n\t\tif (this.selectedNodes.size > 0) {\n\t\t\tthis.selectedNodes.clear();\n\t\t\tthis.updateView();\n\t\t}\n\t};\n\n\t// fired when user taps/clicks a node\n\tprivate readonly onNodePress = (_point: Point) => {\n\t\t// ?\n\t};\n\n\tprivate readonly onDragMove = (point: Point) => {\n\t\tthis.dragging!.offset = this.editorToGridSpace(point).raw;\n\t\tthis.updateView();\n\t};\n\n\tprivate readonly onDragDrop = (point: Point) => {\n\t\tconst offset = this.editorToGridSpace(point);\n\t\tconst state = this.dragging!;\n\n\t\tswitch (state.mode) {\n\t\t\tcase DragMode.Nodes:\n\t\t\t\tendMoveNodes(\n\t\t\t\t\tthis.props.graph,\n\t\t\t\t\tstate.nodes,\n\t\t\t\t\tthis.transitions,\n\t\t\t\t\toffset\n\t\t\t\t);\n\n\t\t\t\tbreak;\n\n\t\t\tcase DragMode.Selection: {\n\t\t\t\tconst { start: a } = state;\n\t\t\t\tconst b = {\n\t\t\t\t\tx: a.x + offset.x,\n\t\t\t\t\ty: a.y + offset.y\n\t\t\t\t};\n\n\t\t\t\tconst nodes = this.props.graph.getNodesWithin(\n\t\t\t\t\tMath.round(Math.min(a.x, b.x)),\n\t\t\t\t\tMath.round(Math.min(a.y, b.y)),\n\t\t\t\t\tMath.round(Math.max(a.x, b.x)),\n\t\t\t\t\tMath.round(Math.max(a.y, b.y))\n\t\t\t\t);\n\n\t\t\t\tthis.selectedNodes.clear();\n\t\t\t\tnodes.forEach(node => this.selectedNodes.add(node));\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tthis.dragging = undefined;\n\t\tthis.updateView();\n\t};\n}\n", "import type { IdentityProvider } from '~/types';\n\nexport class IncrementingIdentityProvider implements IdentityProvider {\n\tprivate readonly shift: number;\n\tprivate readonly mask: number;\n\tprivate index = 0;\n\n\tpublic constructor(\n\t\tprivate readonly alphabet: string\n\t) {\n\t\tconst n = alphabet.length;\n\t\tif (n === 0) {\n\t\t\tthrow new Error('Alphabet cannot be empty.');\n\t\t}\n\n\t\tif ((n & (n - 1)) !== 0) {\n\t\t\tthrow new Error('Alphabet length must be a power of two.');\n\t\t}\n\n\t\tthis.shift = Math.trunc(Math.log(n) / Math.LN2);\n\t\tthis.mask = Math.trunc(n - 1);\n\t}\n\n\tpublic next() {\n\t\tlet id = '';\n\t\tlet value = this.index++;\n\n\t\tdo {\n\t\t\tid = this.alphabet[value & this.mask] + id;\n\t\t\tvalue >>= this.shift;\n\t\t}\n\t\twhile (value > 0);\n\n\t\treturn id;\n\t}\n\n\tpublic static createBase32() {\n\t\treturn new IncrementingIdentityProvider(\n\t\t\t'0123456789abcdefghijklmnopqrstuv'\n\t\t);\n\t}\n}\n", "export function removeItem<T>(array: T[] | undefined, item: T) {\n\tif (!array) {\n\t\treturn false;\n\t}\n\n\tconst index = array.indexOf(item);\n\tif (index === -1) {\n\t\treturn false;\n\t}\n\n\tarray.splice(index, 1);\n\treturn true;\n}\n", "import RBush, { BBox } from 'rbush';\n\nimport type { GraphEdge } from '~/types';\n\nexport class GraphEdgeRTree extends RBush<GraphEdge> {\n\tpublic toBBox({ source, destination }: GraphEdge): BBox {\n\t\treturn {\n\t\t\tmaxX: Math.max(source.x, destination.x),\n\t\t\tminX: Math.min(source.x, destination.x),\n\t\t\tmaxY: Math.max(source.y, destination.y),\n\t\t\tminY: Math.min(source.y, destination.y)\n\t\t};\n\t}\n\n\tpublic compareMinX(a: GraphEdge, b: GraphEdge) {\n\t\treturn Math.min(a.source.x, a.destination.x) - Math.min(b.source.x, b.destination.x);\n\t}\n\n\tpublic compareMinY(a: GraphEdge, b: GraphEdge) {\n\t\treturn Math.min(a.source.y, a.destination.y) - Math.min(b.source.y, b.destination.y);\n\t}\n}\n", "import RBush, { BBox } from 'rbush';\n\nimport type { Point } from '~/types';\n\nexport class PointRTree<T extends Readonly<Point>> extends RBush<T> {\n\tpublic toBBox({ x, y }: T): BBox {\n\t\treturn {\n\t\t\tmaxX: x,\n\t\t\tminX: x,\n\t\t\tmaxY: y,\n\t\t\tminY: y\n\t\t};\n\t}\n\n\tpublic compareMinX(a: T, b: T) {\n\t\treturn a.x - b.x;\n\t}\n\n\tpublic compareMinY(a: T, b: T) {\n\t\treturn a.y - b.y;\n\t}\n}\n\nexport function expandBBox(minX: number, minY: number, maxX = minX, maxY = minY, amount = Number.EPSILON): BBox {\n\treturn {\n\t\tmaxX: maxX + amount,\n\t\tminX: minX - amount,\n\t\tmaxY: maxY + amount,\n\t\tminY: minY - amount\n\t};\n}\n", "import type { Graph, GraphEdge, GraphNode, IdentityProvider, Move } from '~/types';\nimport { removeItem } from '~/utils/array';\n\nimport { GraphEdgeRTree } from './GraphEdgeRTree';\nimport { expandBBox, PointRTree } from './PointRTree';\n\nexport interface GraphStateOptions {\n\tidentity: IdentityProvider;\n}\n\nexport abstract class GraphBase implements Graph {\n\tprotected readonly identity: IdentityProvider;\n\tprotected readonly edges = new Set<GraphEdge>();\n\tprotected readonly edgeTree = new GraphEdgeRTree();\n\tprotected readonly nodes = new Set<GraphNode>();\n\tprotected readonly nodeTree = new PointRTree<GraphNode>();\n\n\tpublic constructor(options: GraphStateOptions) {\n\t\tthis.identity = options.identity;\n\t}\n\n\tpublic createNode(x: number, y: number): GraphNode {\n\t\tlet node = this.getNodeAt(x, y);\n\t\tif (!node) {\n\t\t\tnode = {\n\t\t\t\tid: this.identity.next(),\n\t\t\t\tx,\n\t\t\t\ty\n\t\t\t};\n\t\t}\n\n\t\tthis.nodes.add(node);\n\t\tthis.nodeTree.insert(node);\n\t\treturn node;\n\t}\n\n\tpublic removeNode(node: GraphNode): boolean {\n\t\tif (!this.nodes.delete(node)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tnode.edges?.forEach(edge => this.removeEdge(edge));\n\t\tthis.nodeTree.remove(node);\n\t\treturn true;\n\t}\n\n\tpublic createEdge(source: GraphNode, destination: GraphNode): GraphEdge {\n\t\tif (!this.nodes.has(source) || !this.nodes.has(destination)) {\n\t\t\tthrow new Error('Src and dst nodes must be part of the same graph to form a connection.');\n\t\t}\n\n\t\tlet edge = this.findEdge(source, destination);\n\t\tif (!edge) {\n\t\t\tedge = {\n\t\t\t\tsource,\n\t\t\t\tdestination\n\t\t\t};\n\n\t\t\t(source.edges ??= []).push(edge);\n\t\t\t(destination.edges ??= []).push(edge);\n\t\t\tthis.edges.add(edge);\n\t\t\tthis.edgeTree.insert(edge);\n\t\t}\n\n\t\treturn edge;\n\t}\n\n\tpublic removeEdge(edge: GraphEdge): boolean {\n\t\tif (!this.edges.delete(edge)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tremoveItem(edge.source.edges, edge);\n\t\tremoveItem(edge.destination.edges, edge);\n\t\treturn true;\n\t}\n\n\tpublic beginMoveNodes(nodes: Iterable<GraphNode>) {\n\t\tconst edges = new Set<GraphEdge>();\n\t\tfor (const node of nodes) {\n\t\t\tthis.nodeTree.remove(node);\n\t\t\tnode.edges?.forEach(edge => edges.add(edge));\n\t\t}\n\n\t\tedges.forEach(edge => this.edgeTree.remove(edge));\n\t}\n\n\tpublic endMoveNodes(moves: Iterable<Move<GraphNode>>) {\n\t\tconst edges = new Set<GraphEdge>();\n\t\tfor (const { ref: node, x, y } of moves) {\n\t\t\tnode.x = x;\n\t\t\tnode.y = y;\n\t\t\tif (this.getNodeAt(node.x, node.y)) {\n\t\t\t\tthrow new Error('Attempted to move a node to an occupied cell!');\n\t\t\t}\n\n\t\t\tthis.nodeTree.insert(node);\n\t\t\tnode.edges?.forEach(edge => edges.add(edge));\n\t\t}\n\n\t\tthis.edgeTree.load(Array.from(edges));\n\t}\n\n\tpublic getNodeAt(x: number, y: number): GraphNode | null {\n\t\t// There should never exist more than one node per cell, therefore\n\t\t// search should always yield 0 or 1 results.\n\t\tconst nodes = this.nodeTree.search(expandBBox(x, y));\n\t\tif (nodes.length > 1) {\n\t\t\tthrow new Error(`More than one node found at [ ${x}, ${y} ]`);\n\t\t}\n\n\t\treturn nodes.length > 0 ? nodes[0] : null;\n\t}\n\n\tpublic getNodesWithin(minX: number, minY: number, maxX: number, maxY: number): GraphNode[] {\n\t\treturn this.nodeTree.search(expandBBox(minX, minY, maxX, maxY));\n\t}\n\n\tpublic getEdgesWithin(minX: number, minY: number, maxX: number, maxY: number): GraphEdge[] {\n\t\treturn this.edgeTree.search(expandBBox(minX, minY, maxX, maxY));\n\t}\n\n\tprotected abstract findEdge(source: GraphNode, destination: GraphNode): GraphEdge | undefined;\n}\n", "import type { GraphEdge, GraphNode } from '~/types';\n\nimport { GraphBase, GraphStateOptions } from './GraphBase';\n\nexport class OrientedGraph extends GraphBase {\n\tpublic constructor(options: GraphStateOptions) {\n\t\tsuper(options);\n\t}\n\n\tprotected findEdge(source: GraphNode, destination: GraphNode): GraphEdge | undefined {\n\t\tconst src = source.edges;\n\t\tconst dst = destination.edges;\n\n\t\treturn src && dst && (\n\t\t\tsrc.length < dst.length\n\t\t\t\t? src.find(edge => edge.destination === destination)\n\t\t\t\t: dst.find(edge => edge.source === source)\n\t\t);\n\t}\n}\n", "import { IntlProvider } from '@calmdownval/intl-preact';\nimport { h } from 'preact';\n\nimport { GraphEditor } from '~/components/GraphEditor';\nimport { shapes } from '~/shapes';\nimport { IncrementingIdentityProvider } from '~/state/IncrementingIdentityProvider';\nimport { OrientedGraph } from '~/state/OrientedGraph';\n\nconst graph = new OrientedGraph({\n\tidentity: IncrementingIdentityProvider.createBase32()\n});\n\nfunction randomInt(min: number, max: number) {\n\treturn Math.round(min + Math.random() * (max - min));\n}\n\nfunction randomUInt(min: number, max: number) {\n\treturn Math.trunc(min + Math.random() * (max - min));\n}\n\nconst NODE_LIMIT = 100_000;\nconst EDGE_LIMIT = 50_000;\n\nconst range = Math.sqrt(NODE_LIMIT) * 2;\nconst allNodes = [];\n\nlet nodeCount = 0;\nwhile (nodeCount < NODE_LIMIT) {\n\tconst x = randomInt(-range, range);\n\tconst y = randomInt(-range, range);\n\tif (graph.getNodeAt(x, y)) {\n\t\tcontinue;\n\t}\n\n\tconst node = graph.createNode(x, y);\n\tnode.color = randomUInt(0, 0xffffff + 1);\n\tnode.shapeIndex = randomUInt(0, shapes.length);\n\tallNodes.push(node);\n\n\t++nodeCount;\n}\n\nlet edgeCount = 0;\nwhile (edgeCount < EDGE_LIMIT) {\n\tconst a = randomUInt(0, nodeCount);\n\tconst b = randomUInt(0, nodeCount);\n\n\tgraph.createEdge(allNodes[a], allNodes[b]);\n\t++edgeCount;\n}\n\nexport const GraphTestApp = () => (\n\t<IntlProvider url='./locale/en.json'>\n\t\t<GraphEditor\n\t\t\tgraph={graph}\n\t\t\tgridSize={32}\n\n\t\t\tbackgroundColor={0x2a2a2a}\n\t\t\tgridlineColor={0x3a3a3a}\n\t\t\tdefaultStrokeColor={0x000000}\n\t\t\tselectedStrokeColor={0xffffff}\n\n\t\t\tshapes={shapes}\n\t\t\tminZoom={0.5}\n\t\t\tmaxZoom={2.0}\n\t\t/>\n\t</IntlProvider>\n);\n", "import { h, render } from 'preact';\n\nimport { FieldSetTestApp } from '~/components/App';\n\nimport './index.css';\n\nrender(\n\t<FieldSetTestApp />,\n\tdocument.getElementById('root')!\n);\n"],
  "mappings": "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",
  "names": []
}
