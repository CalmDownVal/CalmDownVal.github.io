(()=>{var Jt=Object.create;var le=Object.defineProperty;var Qt=Object.getOwnPropertyDescriptor;var er=Object.getOwnPropertyNames;var tr=Object.getPrototypeOf,rr=Object.prototype.hasOwnProperty;var nr=(t,e,r)=>e in t?le(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var or=t=>le(t,"__esModule",{value:!0});var ir=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var sr=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of er(e))!rr.call(t,o)&&(r||o!=="default")&&le(t,o,{get:()=>e[o],enumerable:!(n=Qt(e,o))||n.enumerable});return t},ar=(t,e)=>sr(or(le(t!=null?Jt(tr(t)):{},"default",!e&&t&&t.__esModule?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);var he=(t,e,r)=>(nr(t,typeof e!="symbol"?e+"":e,r),r);var Zt=ir((Be,Oe)=>{(function(t,e){typeof Be=="object"&&typeof Oe<"u"?Oe.exports=e():typeof define=="function"&&define.amd?define(e):(t=t||self).RBush=e()})(Be,function(){"use strict";function t(s,d,h,g,m){(function _(b,P,T,A,w){for(;A>T;){if(A-T>600){var E=A-T+1,C=P-T+1,M=Math.log(E),B=.5*Math.exp(2*M/3),O=.5*Math.sqrt(M*B*(E-B)/E)*(C-E/2<0?-1:1),F=Math.max(T,Math.floor(P-C*B/E+O)),qt=Math.min(A,Math.floor(P+(E-C)*B/E+O));_(b,P,F,qt,w)}var ce=b[P],ee=T,L=A;for(e(b,T,P),w(b[A],ce)>0&&e(b,T,A);ee<L;){for(e(b,ee,L),ee++,L--;w(b[ee],ce)<0;)ee++;for(;w(b[L],ce)>0;)L--}w(b[T],ce)===0?e(b,T,L):e(b,++L,A),L<=P&&(T=L+1),P<=L&&(A=L-1)}})(s,d,h||0,g||s.length-1,m||r)}function e(s,d,h){var g=s[d];s[d]=s[h],s[h]=g}function r(s,d){return s<d?-1:s>d?1:0}var n=function(s){s===void 0&&(s=9),this._maxEntries=Math.max(4,s),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function o(s,d,h){if(!h)return d.indexOf(s);for(var g=0;g<d.length;g++)if(h(s,d[g]))return g;return-1}function i(s,d){a(s,0,s.children.length,d,s)}function a(s,d,h,g,m){m||(m=y(null)),m.minX=1/0,m.minY=1/0,m.maxX=-1/0,m.maxY=-1/0;for(var _=d;_<h;_++){var b=s.children[_];c(m,s.leaf?g(b):b)}return m}function c(s,d){return s.minX=Math.min(s.minX,d.minX),s.minY=Math.min(s.minY,d.minY),s.maxX=Math.max(s.maxX,d.maxX),s.maxY=Math.max(s.maxY,d.maxY),s}function l(s,d){return s.minX-d.minX}function f(s,d){return s.minY-d.minY}function u(s){return(s.maxX-s.minX)*(s.maxY-s.minY)}function x(s){return s.maxX-s.minX+(s.maxY-s.minY)}function v(s,d){return s.minX<=d.minX&&s.minY<=d.minY&&d.maxX<=s.maxX&&d.maxY<=s.maxY}function p(s,d){return d.minX<=s.maxX&&d.minY<=s.maxY&&d.maxX>=s.minX&&d.maxY>=s.minY}function y(s){return{children:s,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function R(s,d,h,g,m){for(var _=[d,h];_.length;)if(!((h=_.pop())-(d=_.pop())<=g)){var b=d+Math.ceil((h-d)/g/2)*g;t(s,b,d,h,m),_.push(d,b,b,h)}}return n.prototype.all=function(){return this._all(this.data,[])},n.prototype.search=function(s){var d=this.data,h=[];if(!p(s,d))return h;for(var g=this.toBBox,m=[];d;){for(var _=0;_<d.children.length;_++){var b=d.children[_],P=d.leaf?g(b):b;p(s,P)&&(d.leaf?h.push(b):v(s,P)?this._all(b,h):m.push(b))}d=m.pop()}return h},n.prototype.collides=function(s){var d=this.data;if(!p(s,d))return!1;for(var h=[];d;){for(var g=0;g<d.children.length;g++){var m=d.children[g],_=d.leaf?this.toBBox(m):m;if(p(s,_)){if(d.leaf||v(s,_))return!0;h.push(m)}}d=h.pop()}return!1},n.prototype.load=function(s){if(!s||!s.length)return this;if(s.length<this._minEntries){for(var d=0;d<s.length;d++)this.insert(s[d]);return this}var h=this._build(s.slice(),0,s.length-1,0);if(this.data.children.length)if(this.data.height===h.height)this._splitRoot(this.data,h);else{if(this.data.height<h.height){var g=this.data;this.data=h,h=g}this._insert(h,this.data.height-h.height-1,!0)}else this.data=h;return this},n.prototype.insert=function(s){return s&&this._insert(s,this.data.height-1),this},n.prototype.clear=function(){return this.data=y([]),this},n.prototype.remove=function(s,d){if(!s)return this;for(var h,g,m,_=this.data,b=this.toBBox(s),P=[],T=[];_||P.length;){if(_||(_=P.pop(),g=P[P.length-1],h=T.pop(),m=!0),_.leaf){var A=o(s,_.children,d);if(A!==-1)return _.children.splice(A,1),P.push(_),this._condense(P),this}m||_.leaf||!v(_,b)?g?(h++,_=g.children[h],m=!1):_=null:(P.push(_),T.push(h),h=0,g=_,_=_.children[0])}return this},n.prototype.toBBox=function(s){return s},n.prototype.compareMinX=function(s,d){return s.minX-d.minX},n.prototype.compareMinY=function(s,d){return s.minY-d.minY},n.prototype.toJSON=function(){return this.data},n.prototype.fromJSON=function(s){return this.data=s,this},n.prototype._all=function(s,d){for(var h=[];s;)s.leaf?d.push.apply(d,s.children):h.push.apply(h,s.children),s=h.pop();return d},n.prototype._build=function(s,d,h,g){var m,_=h-d+1,b=this._maxEntries;if(_<=b)return i(m=y(s.slice(d,h+1)),this.toBBox),m;g||(g=Math.ceil(Math.log(_)/Math.log(b)),b=Math.ceil(_/Math.pow(b,g-1))),(m=y([])).leaf=!1,m.height=g;var P=Math.ceil(_/b),T=P*Math.ceil(Math.sqrt(b));R(s,d,h,T,this.compareMinX);for(var A=d;A<=h;A+=T){var w=Math.min(A+T-1,h);R(s,A,w,P,this.compareMinY);for(var E=A;E<=w;E+=P){var C=Math.min(E+P-1,w);m.children.push(this._build(s,E,C,g-1))}}return i(m,this.toBBox),m},n.prototype._chooseSubtree=function(s,d,h,g){for(;g.push(d),!d.leaf&&g.length-1!==h;){for(var m=1/0,_=1/0,b=void 0,P=0;P<d.children.length;P++){var T=d.children[P],A=u(T),w=(E=s,C=T,(Math.max(C.maxX,E.maxX)-Math.min(C.minX,E.minX))*(Math.max(C.maxY,E.maxY)-Math.min(C.minY,E.minY))-A);w<_?(_=w,m=A<m?A:m,b=T):w===_&&A<m&&(m=A,b=T)}d=b||d.children[0]}var E,C;return d},n.prototype._insert=function(s,d,h){var g=h?s:this.toBBox(s),m=[],_=this._chooseSubtree(g,this.data,d,m);for(_.children.push(s),c(_,g);d>=0&&m[d].children.length>this._maxEntries;)this._split(m,d),d--;this._adjustParentBBoxes(g,m,d)},n.prototype._split=function(s,d){var h=s[d],g=h.children.length,m=this._minEntries;this._chooseSplitAxis(h,m,g);var _=this._chooseSplitIndex(h,m,g),b=y(h.children.splice(_,h.children.length-_));b.height=h.height,b.leaf=h.leaf,i(h,this.toBBox),i(b,this.toBBox),d?s[d-1].children.push(b):this._splitRoot(h,b)},n.prototype._splitRoot=function(s,d){this.data=y([s,d]),this.data.height=s.height+1,this.data.leaf=!1,i(this.data,this.toBBox)},n.prototype._chooseSplitIndex=function(s,d,h){for(var g,m,_,b,P,T,A,w=1/0,E=1/0,C=d;C<=h-d;C++){var M=a(s,0,C,this.toBBox),B=a(s,C,h,this.toBBox),O=(m=M,_=B,b=void 0,P=void 0,T=void 0,A=void 0,b=Math.max(m.minX,_.minX),P=Math.max(m.minY,_.minY),T=Math.min(m.maxX,_.maxX),A=Math.min(m.maxY,_.maxY),Math.max(0,T-b)*Math.max(0,A-P)),F=u(M)+u(B);O<w?(w=O,g=C,E=F<E?F:E):O===w&&F<E&&(E=F,g=C)}return g||h-d},n.prototype._chooseSplitAxis=function(s,d,h){var g=s.leaf?this.compareMinX:l,m=s.leaf?this.compareMinY:f;this._allDistMargin(s,d,h,g)<this._allDistMargin(s,d,h,m)&&s.children.sort(g)},n.prototype._allDistMargin=function(s,d,h,g){s.children.sort(g);for(var m=this.toBBox,_=a(s,0,d,m),b=a(s,h-d,h,m),P=x(_)+x(b),T=d;T<h-d;T++){var A=s.children[T];c(_,s.leaf?m(A):A),P+=x(_)}for(var w=h-d-1;w>=d;w--){var E=s.children[w];c(b,s.leaf?m(E):E),P+=x(b)}return P},n.prototype._adjustParentBBoxes=function(s,d,h){for(var g=h;g>=0;g--)c(d[g],s)},n.prototype._condense=function(s){for(var d=s.length-1,h=void 0;d>=0;d--)s[d].children.length===0?d>0?(h=s[d-1].children).splice(h.indexOf(s[d]),1):this.clear():i(s[d],this.toBBox)},n})});var ye,S,$e,dr,te,Ke,Ve,je,fe={},qe=[],ur=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function U(t,e){for(var r in e)t[r]=e[r];return t}function Je(t){var e=t.parentNode;e&&e.removeChild(t)}function I(t,e,r){var n,o,i,a={};for(i in e)i=="key"?n=e[i]:i=="ref"?o=e[i]:a[i]=e[i];if(arguments.length>2&&(a.children=arguments.length>3?ye.call(arguments,2):r),typeof t=="function"&&t.defaultProps!=null)for(i in t.defaultProps)a[i]===void 0&&(a[i]=t.defaultProps[i]);return pe(t,a,n,o,null)}function pe(t,e,r,n,o){var i={type:t,props:e,key:r,ref:n,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:o??++$e};return o==null&&S.vnode!=null&&S.vnode(i),i}function ge(t){return t.children}function H(t,e){this.props=t,this.context=e}function q(t,e){if(e==null)return t.__?q(t.__,t.__.__k.indexOf(t)+1):null;for(var r;e<t.__k.length;e++)if((r=t.__k[e])!=null&&r.__e!=null)return r.__e;return typeof t.type=="function"?q(t):null}function Qe(t){var e,r;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((r=t.__k[e])!=null&&r.__e!=null){t.__e=t.__c.base=r.__e;break}return Qe(t)}}function Pe(t){(!t.__d&&(t.__d=!0)&&te.push(t)&&!me.__r++||Ve!==S.debounceRendering)&&((Ve=S.debounceRendering)||Ke)(me)}function me(){for(var t;me.__r=te.length;)t=te.sort(function(e,r){return e.__v.__b-r.__v.__b}),te=[],t.some(function(e){var r,n,o,i,a,c;e.__d&&(a=(i=(r=e).__v).__e,(c=r.__P)&&(n=[],(o=U({},i)).__v=i.__v+1,Se(c,i,o,r.__n,c.ownerSVGElement!==void 0,i.__h!=null?[a]:null,n,a??q(i),i.__h),nt(n,i),i.__e!=a&&Qe(i)))})}function et(t,e,r,n,o,i,a,c,l,f){var u,x,v,p,y,R,s,d=n&&n.__k||qe,h=d.length;for(r.__k=[],u=0;u<e.length;u++)if((p=r.__k[u]=(p=e[u])==null||typeof p=="boolean"?null:typeof p=="string"||typeof p=="number"||typeof p=="bigint"?pe(null,p,null,null,p):Array.isArray(p)?pe(ge,{children:p},null,null,null):p.__b>0?pe(p.type,p.props,p.key,null,p.__v):p)!=null){if(p.__=r,p.__b=r.__b+1,(v=d[u])===null||v&&p.key==v.key&&p.type===v.type)d[u]=void 0;else for(x=0;x<h;x++){if((v=d[x])&&p.key==v.key&&p.type===v.type){d[x]=void 0;break}v=null}Se(t,p,v=v||fe,o,i,a,c,l,f),y=p.__e,(x=p.ref)&&v.ref!=x&&(s||(s=[]),v.ref&&s.push(v.ref,null,p),s.push(x,p.__c||y,p)),y!=null?(R==null&&(R=y),typeof p.type=="function"&&p.__k===v.__k?p.__d=l=tt(p,l,t):l=rt(t,p,v,d,y,l),typeof r.type=="function"&&(r.__d=l)):l&&v.__e==l&&l.parentNode!=t&&(l=q(v))}for(r.__e=R,u=h;u--;)d[u]!=null&&(typeof r.type=="function"&&d[u].__e!=null&&d[u].__e==r.__d&&(r.__d=q(n,u+1)),it(d[u],d[u]));if(s)for(u=0;u<s.length;u++)ot(s[u],s[++u],s[++u])}function tt(t,e,r){for(var n,o=t.__k,i=0;o&&i<o.length;i++)(n=o[i])&&(n.__=t,e=typeof n.type=="function"?tt(n,e,r):rt(r,n,n,o,n.__e,e));return e}function rt(t,e,r,n,o,i){var a,c,l;if(e.__d!==void 0)a=e.__d,e.__d=void 0;else if(r==null||o!=i||o.parentNode==null)e:if(i==null||i.parentNode!==t)t.appendChild(o),a=null;else{for(c=i,l=0;(c=c.nextSibling)&&l<n.length;l+=2)if(c==o)break e;t.insertBefore(o,i),a=i}return a!==void 0?a:o.nextSibling}function cr(t,e,r,n,o){var i;for(i in r)i==="children"||i==="key"||i in e||_e(t,i,null,r[i],n);for(i in e)o&&typeof e[i]!="function"||i==="children"||i==="key"||i==="value"||i==="checked"||r[i]===e[i]||_e(t,i,e[i],r[i],n)}function Xe(t,e,r){e[0]==="-"?t.setProperty(e,r):t[e]=r==null?"":typeof r!="number"||ur.test(e)?r:r+"px"}function _e(t,e,r,n,o){var i;e:if(e==="style")if(typeof r=="string")t.style.cssText=r;else{if(typeof n=="string"&&(t.style.cssText=n=""),n)for(e in n)r&&e in r||Xe(t.style,e,"");if(r)for(e in r)n&&r[e]===n[e]||Xe(t.style,e,r[e])}else if(e[0]==="o"&&e[1]==="n")i=e!==(e=e.replace(/Capture$/,"")),e=e.toLowerCase()in t?e.toLowerCase().slice(2):e.slice(2),t.l||(t.l={}),t.l[e+i]=r,r?n||t.addEventListener(e,i?Ze:We,i):t.removeEventListener(e,i?Ze:We,i);else if(e!=="dangerouslySetInnerHTML"){if(o)e=e.replace(/xlink[H:h]/,"h").replace(/sName$/,"s");else if(e!=="href"&&e!=="list"&&e!=="form"&&e!=="tabIndex"&&e!=="download"&&e in t)try{t[e]=r??"";break e}catch{}typeof r=="function"||(r!=null&&(r!==!1||e[0]==="a"&&e[1]==="r")?t.setAttribute(e,r):t.removeAttribute(e))}}function We(t){this.l[t.type+!1](S.event?S.event(t):t)}function Ze(t){this.l[t.type+!0](S.event?S.event(t):t)}function Se(t,e,r,n,o,i,a,c,l){var f,u,x,v,p,y,R,s,d,h,g,m=e.type;if(e.constructor!==void 0)return null;r.__h!=null&&(l=r.__h,c=e.__e=r.__e,e.__h=null,i=[c]),(f=S.__b)&&f(e);try{e:if(typeof m=="function"){if(s=e.props,d=(f=m.contextType)&&n[f.__c],h=f?d?d.props.value:f.__:n,r.__c?R=(u=e.__c=r.__c).__=u.__E:("prototype"in m&&m.prototype.render?e.__c=u=new m(s,h):(e.__c=u=new H(s,h),u.constructor=m,u.render=hr),d&&d.sub(u),u.props=s,u.state||(u.state={}),u.context=h,u.__n=n,x=u.__d=!0,u.__h=[]),u.__s==null&&(u.__s=u.state),m.getDerivedStateFromProps!=null&&(u.__s==u.state&&(u.__s=U({},u.__s)),U(u.__s,m.getDerivedStateFromProps(s,u.__s))),v=u.props,p=u.state,x)m.getDerivedStateFromProps==null&&u.componentWillMount!=null&&u.componentWillMount(),u.componentDidMount!=null&&u.__h.push(u.componentDidMount);else{if(m.getDerivedStateFromProps==null&&s!==v&&u.componentWillReceiveProps!=null&&u.componentWillReceiveProps(s,h),!u.__e&&u.shouldComponentUpdate!=null&&u.shouldComponentUpdate(s,u.__s,h)===!1||e.__v===r.__v){u.props=s,u.state=u.__s,e.__v!==r.__v&&(u.__d=!1),u.__v=e,e.__e=r.__e,e.__k=r.__k,e.__k.forEach(function(_){_&&(_.__=e)}),u.__h.length&&a.push(u);break e}u.componentWillUpdate!=null&&u.componentWillUpdate(s,u.__s,h),u.componentDidUpdate!=null&&u.__h.push(function(){u.componentDidUpdate(v,p,y)})}u.context=h,u.props=s,u.state=u.__s,(f=S.__r)&&f(e),u.__d=!1,u.__v=e,u.__P=t,f=u.render(u.props,u.state,u.context),u.state=u.__s,u.getChildContext!=null&&(n=U(U({},n),u.getChildContext())),x||u.getSnapshotBeforeUpdate==null||(y=u.getSnapshotBeforeUpdate(v,p)),g=f!=null&&f.type===ge&&f.key==null?f.props.children:f,et(t,Array.isArray(g)?g:[g],e,r,n,o,i,a,c,l),u.base=e.__e,e.__h=null,u.__h.length&&a.push(u),R&&(u.__E=u.__=null),u.__e=!1}else i==null&&e.__v===r.__v?(e.__k=r.__k,e.__e=r.__e):e.__e=lr(r.__e,e,r,n,o,i,a,l);(f=S.diffed)&&f(e)}catch(_){e.__v=null,(l||i!=null)&&(e.__e=c,e.__h=!!l,i[i.indexOf(c)]=null),S.__e(_,e,r)}}function nt(t,e){S.__c&&S.__c(e,t),t.some(function(r){try{t=r.__h,r.__h=[],t.some(function(n){n.call(r)})}catch(n){S.__e(n,r.__v)}})}function lr(t,e,r,n,o,i,a,c){var l,f,u,x=r.props,v=e.props,p=e.type,y=0;if(p==="svg"&&(o=!0),i!=null){for(;y<i.length;y++)if((l=i[y])&&"setAttribute"in l==!!p&&(p?l.localName===p:l.nodeType===3)){t=l,i[y]=null;break}}if(t==null){if(p===null)return document.createTextNode(v);t=o?document.createElementNS("http://www.w3.org/2000/svg",p):document.createElement(p,v.is&&v),i=null,c=!1}if(p===null)x===v||c&&t.data===v||(t.data=v);else{if(i=i&&ye.call(t.childNodes),f=(x=r.props||fe).dangerouslySetInnerHTML,u=v.dangerouslySetInnerHTML,!c){if(i!=null)for(x={},y=0;y<t.attributes.length;y++)x[t.attributes[y].name]=t.attributes[y].value;(u||f)&&(u&&(f&&u.__html==f.__html||u.__html===t.innerHTML)||(t.innerHTML=u&&u.__html||""))}if(cr(t,v,x,o,c),u)e.__k=[];else if(y=e.props.children,et(t,Array.isArray(y)?y:[y],e,r,n,o&&p!=="foreignObject",i,a,i?i[0]:r.__k&&q(r,0),c),i!=null)for(y=i.length;y--;)i[y]!=null&&Je(i[y]);c||("value"in v&&(y=v.value)!==void 0&&(y!==t.value||p==="progress"&&!y||p==="option"&&y!==x.value)&&_e(t,"value",y,x.value,!1),"checked"in v&&(y=v.checked)!==void 0&&y!==t.checked&&_e(t,"checked",y,x.checked,!1))}return t}function ot(t,e,r){try{typeof t=="function"?t(e):t.current=e}catch(n){S.__e(n,r)}}function it(t,e,r){var n,o;if(S.unmount&&S.unmount(t),(n=t.ref)&&(n.current&&n.current!==t.__e||ot(n,null,e)),(n=t.__c)!=null){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(i){S.__e(i,e)}n.base=n.__P=null}if(n=t.__k)for(o=0;o<n.length;o++)n[o]&&it(n[o],e,typeof t.type!="function");r||t.__e==null||Je(t.__e),t.__e=t.__d=void 0}function hr(t,e,r){return this.constructor(t,r)}function st(t,e,r){var n,o,i;S.__&&S.__(t,e),o=(n=typeof r=="function")?null:r&&r.__k||e.__k,i=[],Se(e,t=(!n&&r||e).__k=I(ge,null,[t]),o||fe,fe,e.ownerSVGElement!==void 0,!n&&r?[r]:o?null:e.firstChild?ye.call(e.childNodes):null,i,!n&&r?r:o?o.__e:e.firstChild,n),nt(i,t)}function at(t,e){var r={__c:e="__cC"+je++,__:t,Consumer:function(n,o){return n.children(o)},Provider:function(n){var o,i;return this.getChildContext||(o=[],(i={})[e]=this,this.getChildContext=function(){return i},this.shouldComponentUpdate=function(a){this.props.value!==a.value&&o.some(Pe)},this.sub=function(a){o.push(a);var c=a.componentWillUnmount;a.componentWillUnmount=function(){o.splice(o.indexOf(a),1),c&&c.call(a)}}),n.children}};return r.Provider.__=r.Consumer.contextType=r}ye=qe.slice,S={__e:function(t,e){for(var r,n,o;e=e.__;)if((r=e.__c)&&!r.__)try{if((n=r.constructor)&&n.getDerivedStateFromError!=null&&(r.setState(n.getDerivedStateFromError(t)),o=r.__d),r.componentDidCatch!=null&&(r.componentDidCatch(t),o=r.__d),o)return r.__E=r}catch(i){t=i}throw t}},$e=0,dr=function(t){return t!=null&&t.constructor===void 0},H.prototype.setState=function(t,e){var r;r=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=U({},this.state),typeof t=="function"&&(t=t(U({},r),this.props)),t&&U(r,t),t!=null&&this.__v&&(e&&this.__h.push(e),Pe(this))},H.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),Pe(this))},H.prototype.render=ge,te=[],Ke=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,me.__r=0,je=0;var G=class extends Error{code;isTranslationError=!0;constructor(e,r){super(`${e} ${r}`),this.code=e}static is(e){return e?.isTranslationError===!0}};he(G,"FORMAT_UNAVAILABLE","FormatUnavailable"),he(G,"INVALID_PARAMETER","InvalidParameter"),he(G,"KEY_NOT_FOUND","KeyNotFound");function Ae(t){return t[1]??"variable"}function dt(t,e){let r=t[0];return e!==void 0&&Object.prototype.hasOwnProperty.call(e,r)?""+e[r]:r}function ut(t,e){let{length:r}=e,n=Ae(t);if(t.length-2>r)throw new G(G.INVALID_PARAMETER,`too many parameters for format '${n}'`);for(let o=0;o<r;++o)e[o].call(null,t[2+o],n,o)}function pr(t,e,r){fr(t)&&Array.isArray(mr(t))||_r("a map of messages",e,r)}function fr(t){return t!==null&&typeof t=="object"}function mr(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function _r(t,e,r){throw new G(G.INVALID_PARAMETER,`expected parameter ${r+1} of format '${e}' to be ${t}`)}var yr=[pr],gr=[],vr=Object.freeze({__proto__:null,select:()=>(t,e)=>{ut(t,yr);let r=t[2];if(!r.other)throw new G(G.INVALID_PARAMETER,`messages of format '${Ae(t)}' must contain the key 'other'`);let n={};for(let o in r)n[o]=e.interpret(r[o]);return o=>(n[dt(t,o)]??n.other)(o)},variable:()=>t=>(ut(t,gr),e=>dt(t,e))}),N=class extends Error{input;at;isParseError=!0;constructor(e,r,n){super(e),this.input=r,this.at=n}toString(){let e=Math.max(this.input.lastIndexOf(`
`,this.at-1),0)+1,r=this.input.indexOf(`
`,this.at+1);r===-1?r=this.input.length:this.input[r-1]==="\r"&&--r;let n=`${this.input.slice(e,r)}
${" ".repeat(this.at-e)}^`;return`${this.message} at pos ${this.at}:

${n}

${this.stack}`}static is(e){return e?.isParseError===!0}};function pt(t){return t===32||t>=9&&t<=13||t===133||t===160||t===6158||t>=8192&&t<=8205||t===8232||t===8233||t===8239||t===8287||t===8288||t===12288||t===65279}function V(t,e){let{length:r}=t,n=e;for(;n<r&&pt(t.charCodeAt(n));)++n;return n}function re(t,e){let{length:r}=t,n,o=e;for(;o<r&&(n=t[o],n!=="{"&&n!=="}"&&n!==","&&n!=="#"&&n!=="'"&&n!==":"&&!pt(n.charCodeAt(0)));)++o;if(e===o)throw new N(`expected an identifier but ${n?`saw '${n}'`:"saw the end of pattern"} instead`,t,e);return t.slice(e,o)}function ct(t,e,r){let{length:n}=t,o,i=e,a=e,c="";for(;a<n&&(o=t[a],!(o==="{"||o==="}"||r&&o==="#"));){if(o==="'"){if(o=t[++a],o==="'")c+=t.slice(i,a),i=a+1;else if(o==="{"||o==="}"||r&&o==="#"){for(c+=t.slice(i,a-1),i=a;++a<n;)if(o=t[a],o==="'"){if(o=t[a+1],o!=="'")break;c+=t.slice(i,++a),i=a+1}c+=t.slice(i,a),i=++a}}++a}return c+=t.slice(i,a),c}function ft(t,e,r,n){let{length:o}=t,i={};r.push(i);let a,c=n,l=[],f=Te(t,e,l,!0);for(i[c]=l;f<o&&(f=V(t,f),a=t[f],a!==","&&a!=="}");){if(c=re(t,f),f=V(t,f+c.length),a=t[f],a!=="{")throw new N("expected '{'",t,f);l=[],f=Te(t,f+1,l,!0),i[c]=l}return f}function xr(t,e,r,n){let{length:o}=t,i={};r.push(i);let a,c=n,l=V(t,e),f=re(t,l);for(l+=f.length,i[c]=f;l<o&&(l=V(t,l),a=t[l],a!==","&&a!=="}");){if(c=re(t,l),l=V(t,l+c.length),a=t[l],a==="{")return ft(t,l+1,r,c);if(a!==":")throw new N("expected ':' or '{'",t,l);l=V(t,l+1),f=re(t,l),l+=f.length,i[c]=f}return l}function br(t,e,r){let n=e,o=t[n];if(o==="#")return r.push("#"),n+1;if(o!=="{")throw new N("expected '#' or '{'",t,n);let{length:i}=t;do{n=V(t,n+1);let a=re(t,n);switch(n=V(t,n+a.length),o=t[n],o){case",":case"}":r.push(a);break;case"{":if(r.length<2)throw new N("expected an identifier but saw a message instead",t,n);n=ft(t,n+1,r,a),o=t[n];break;case":":if(r.length<2)throw new N("expected an identifier but saw an attribute instead",t,n);n=xr(t,n+1,r,a),o=t[n];break;default:throw new N(`unexpected character '${o}'`,t,n)}}while(n<i&&o!=="}");return n+1}function Te(t,e,r,n){let o,i=e,a=ct(t,i,n);a&&(r.push(a),i+=a.length);let{length:c}=t;for(;i<c;){if(o=t[i],o==="}"){if(!n)throw new N("unexpected '}'",t,i);++i;break}let l=[];i=br(t,i,l),r.push(l),a=ct(t,i,n),a&&(r.push(a),i+=a.length)}return i}function lt(t){let e=[];return Te(t,0,e,!1),e}function mt(t,e,r){for(let n in t){if(n.startsWith("$"))continue;let o=t[n];switch(typeof o){case"string":e[r+n]=o;break;case"object":o!==null&&mt(o,e,`${r}${n}.`)}}return e}function Pr(t){return mt(t,{},"")}function ht(t,e){let r={};for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=e(t[n],n));return r}var _t=class{formatProvider;constructor(e){this.formatProvider=e}interpret(e,r){let{length:n}=e;if(n===1)return this.interpretElement(e[0],r);let o=new Array(n);for(let i=0;i<n;++i)o[i]=this.interpretElement(e[i],r);return Sr.bind(null,o)}interpretElement(e,r){if(typeof e=="string")return()=>e;let n=e;if(n.length===1&&n[0]==="#"){if(r===void 0)return()=>"#";n=[r]}return this.formatProvider.getFormat(n)(n,this)}};function Sr(t,e){let r="";for(let n=0;n<t.length;++n)r+=t[n](e);return r}var yt=class{formatMap;constructor(e){this.formatMap=e}getFormat(e){let r=Ae(e),n=this.formatMap[r];if(!n)throw new G(G.FORMAT_UNAVAILABLE,r);return n}},J;(function(t){t[t.Eager=0]="Eager",t[t.Lazy=1]="Lazy",t[t.Off=2]="Off"})(J||(J={}));var ne=class{cacheMode;expansions;interpreter;constructor({cacheMode:e,interpreter:r,translations:n}){this.cacheMode=e??J.Lazy,this.interpreter=r,this.expansions=Pr(n),e===J.Eager&&(this.expansions=ht(this.expansions,o=>r.interpret(lt(o))))}expand(e,r){let n=this.expansions[e];if(n===void 0)throw new G(G.KEY_NOT_FOUND,e);return typeof n=="string"&&(n=this.interpreter.interpret(lt(n)),this.cacheMode!==J.Off&&(this.expansions[e]=n)),n(r)}static fromLocale(e,r=vr){let n=ht(r,(i,a)=>i(e.$format?.[a])),o=new yt(n);return new ne({cacheMode:J.Lazy,interpreter:new _t(o),translations:e})}};var Tr,Z,gt;var At=[],vt=S.__b,xt=S.__r,bt=S.diffed,Pt=S.__c,St=S.unmount;function Ar(){for(var t;t=At.shift();)if(t.__P)try{t.__H.__h.forEach(ve),t.__H.__h.forEach(Ee),t.__H.__h=[]}catch(e){t.__H.__h=[],S.__e(e,t.__v)}}S.__b=function(t){Z=null,vt&&vt(t)},S.__r=function(t){xt&&xt(t),Tr=0;var e=(Z=t.__c).__H;e&&(e.__h.forEach(ve),e.__h.forEach(Ee),e.__h=[])},S.diffed=function(t){bt&&bt(t);var e=t.__c;e&&e.__H&&e.__H.__h.length&&(At.push(e)!==1&&gt===S.requestAnimationFrame||((gt=S.requestAnimationFrame)||function(r){var n,o=function(){clearTimeout(i),Tt&&cancelAnimationFrame(n),setTimeout(r)},i=setTimeout(o,100);Tt&&(n=requestAnimationFrame(o))})(Ar)),Z=null},S.__c=function(t,e){e.some(function(r){try{r.__h.forEach(ve),r.__h=r.__h.filter(function(n){return!n.__||Ee(n)})}catch(n){e.some(function(o){o.__h&&(o.__h=[])}),e=[],S.__e(n,r.__v)}}),Pt&&Pt(t,e)},S.unmount=function(t){St&&St(t);var e,r=t.__c;r&&r.__H&&(r.__H.__.forEach(function(n){try{ve(n)}catch(o){e=o}}),e&&S.__e(e,r.__v))};var Tt=typeof requestAnimationFrame=="function";function ve(t){var e=Z,r=t.__c;typeof r=="function"&&(t.__c=void 0,r()),Z=e}function Ee(t){var e=Z;t.__c=t.__(),Z=e}var we={isLoading:!0,t:()=>""},Er=at(we),Re=class extends H{state=we;pendingFetch;componentDidMount(){this.fetchLocale()}componentDidUpdate(e){let r=this.props;e.url!==r.url&&this.fetchLocale()}componentWillUnmount(){this.pendingFetch?.abort()}render(){return I(Er.Provider,{children:this.props.children,value:this.state})}async fetchLocale(){try{this.setState(we),this.pendingFetch=new AbortController;let{credentials:e,headers:r,url:n}=this.props,o=await fetch(n,{credentials:e,headers:r,method:"GET",signal:this.pendingFetch.signal});if(!o.ok)throw new Error(`unexpected HTTP response ${o.status} - ${o.statusText}`);let i=await o.json(),a=ne.fromLocale(i,this.props.formats);this.setState({isLoading:!1,t:wr.bind(null,a)})}catch(e){this.props.onError?.(e),this.setState({isLoading:!1,t:()=>""})}finally{this.pendingFetch=void 0}}};function wr(t,e,r){try{return typeof e=="string"?t.expand(e,r):t.expand(e.key,e.vars)}catch(n){let o;return o=G.is(n)?n.message:N.is(n)?"ParseError":"UnknownError",`⚠️ ${o}`}}function Y(){this.t=[]}function z(){this.i=new Set,this.u=[]}function Et(t){return t&&typeof t.then=="function"}function Rr(t,e,r){return new Promise((n,o)=>{let{length:i}=e,a=0,c=()=>{--a==0&&n()};for(let l=0;l<i;++l){let f=e[l].call(t,r);Et(f)&&(++a,f.then(c,o))}})}function Cr(t,e,r){return new Promise((n,o)=>{let{length:i}=e,a=0,c=()=>{if(a>=i)return void n();let l=e[a++].call(t,r);Et(l)?l.then(c,o):c()};c()})}Y.prototype.o=null,Y.prototype.h=function(){return this.o||(this.o=this.t.slice()),this.o},Y.prototype.l=function(t){this.t.push(t),this.o=null},Y.prototype.g=function(){return this.t.length!==0&&(this.t=[],this.o=null,!0)},Y.prototype.m=function(){return this.t.length},Y.prototype.P=function(t){let{t:e}=this,r,n=e.length-1;for(;n>=0&&(r=e[n],r!==t&&r.p!==t);)--n;return n!==-1&&(this.t.splice(n,1),this.o=null,!0)},Y.prototype.v=function(t){let e=this.t.lastIndexOf(t);e!==-1&&(this.t.splice(e,1),this.o=null)},z.prototype.o=null,z.prototype.h=function(){return this.o||(this.o=Array.from(this.i.values()).concat(this.u)),this.o},z.prototype.l=function(t){if(t.p){if(this.i.has(t.p))return;this.u.push(t)}else this.i.add(t),this.A(t);this.o=null},z.prototype.g=function(){return!!this.m()&&(this.i.clear(),this.u=[],this.o=null,!0)},z.prototype.m=function(){return this.i.size+this.u.length},z.prototype.P=function(t){return this.i.delete(t)?(this.o=null,!0):this.A(t)},z.prototype.v=function(t){let e=this.u.lastIndexOf(t);e!==-1&&(this.u.splice(e,1),this.o=null)},z.prototype.A=function(t){let e=this.u.length-1;for(;e>=0;){if(this.u[e].p===t)return this.u.splice(e,1),this.o=null,!0;--e}return!1};var kr={array:Y,set:z};function $(t={}){let e=new(kr[t.backend]??Y),r=t.async===!0,n=r?function(o,i){let a=i?.parallel?Rr:Cr;return function(c){return a(this,o.h(),c)}}(e,t):function(o,i){return function(a){let c=o.h(),{length:l}=c;for(let f=0;f<l;++f)c[f].call(this,a)}}(e);return n.S=e,n.isAsync=r,n}function Mr(t,e){let r=!1,n=function(o){if(!r)return t.S.v(n),r=!0,e.call(this,o)};n.p=e,t.S.l(n)}function oe(t,e,r){r?.once?Mr(t,e):t.S.l(e)}var k={x:0,y:0};function ie(t,e){let r=t.x-e.x,n=t.y-e.y;return Math.sqrt(r*r+n*n)}function K(t,e=0,r=1){return t<e?e:t>r?r:t}function D(t){return Math.abs(t)<Number.EPSILON}var se=class{longPress=$();multiClick=$();press=$();acceptsNewPointers=!0;editor;longPressDelay;maxPressDistance;multiClickDelay;isPressValid=!1;longPressTimeout;multiClickCount=0;multiClickTime=0;constructor(e){this.editor=e.editor,this.longPressDelay=e.longPressDelay??800,this.maxPressDistance=e.maxPressDistance??10,this.multiClickDelay=e.multiClickDelay??400}handlePointerDown(e,r){if(r.length>1){this.cancelPress();return}switch(this.isPressValid=!0,e.type){case"mouse":this.multiClickTick(e.editor,!1);break;case"touch":case"pen":this.longPressTimeout=setTimeout(()=>this.onLongPress(e.editor),this.longPressDelay);break}}handlePointerMove(e,r){ie(e.start,e)>this.maxPressDistance&&this.cancelPress()}handlePointerUp(e,r){this.isPressValid&&(this.press(e.editor),e.type==="mouse"&&this.multiClickTick(e.editor,!0)),this.cancelPress()}cancelPress(){this.longPressTimeout!==void 0&&(clearTimeout(this.longPressTimeout),this.longPressTimeout=void 0),this.isPressValid=!1}onLongPress(e){this.longPressTimeout=void 0,this.longPress(e)}multiClickTick(e,r){let n=performance.now();n-this.multiClickTime>this.multiClickDelay?this.multiClickCount=0:r&&++this.multiClickCount>=2&&this.multiClick(e),this.multiClickTime=n}};var ke=class extends se{drag=$();drop=$();offset={...k};isDragging=!1;acceptsNewPointers=!0;edgeProximity;pushSpeedBasis;pushSpeed={...k};start={...k};animationHandle;lastTimestamp;lastPoint;constructor(e){super(e);this.edgeProximity=e.edgeProximity??64,this.pushSpeedBasis=e.pushSpeed??.5}handlePointerDown(e,r){this.acceptsNewPointers=!1,this.isDragging=!0,this.lastPoint=e,this.start=e.editor,this.offset={...k},this.startPushAnimation(e),super.handlePointerDown(e,r)}handlePointerMove(e,r){this.lastPoint=e,this.offset.x=e.editor.x-this.start.x,this.offset.y=e.editor.y-this.start.y,this.drag(this.offset),this.startPushAnimation(e),super.handlePointerMove(e,r)}handlePointerUp(e,r){this.acceptsNewPointers=!0,this.isDragging=!1,this.stopPushAnimation(),this.drop(this.offset),super.handlePointerUp(e,r)}startPushAnimation(e){this.pushSpeed.x=this.pushSpeedBasis*(K(1-(e.x-this.editor.edgeTopLeft.x)/this.edgeProximity)-K(1-(this.editor.edgeBottomRight.x-e.x)/this.edgeProximity)),this.pushSpeed.y=this.pushSpeedBasis*(K(1-(e.y-this.editor.edgeTopLeft.y)/this.edgeProximity)-K(1-(this.editor.edgeBottomRight.y-e.y)/this.edgeProximity)),!D(this.pushSpeed.x)||!D(this.pushSpeed.y)?this.animationHandle===void 0&&(this.lastTimestamp=void 0,this.animationHandle=requestAnimationFrame(this.onTick)):this.stopPushAnimation()}stopPushAnimation(){this.animationHandle!==void 0&&(cancelAnimationFrame(this.animationHandle),this.animationHandle=void 0)}onTick=e=>{let r=0;this.lastTimestamp!==void 0&&(r=e-this.lastTimestamp),this.editor.setOffset({x:this.pushSpeed.x*r,y:this.pushSpeed.y*r}),this.offset=this.editor.clientToEditorSpace(this.lastPoint),this.offset.x-=this.start.x,this.offset.y-=this.start.y,this.drag(this.offset),this.lastTimestamp=e,this.animationHandle=requestAnimationFrame(this.onTick)}};var Me=class extends se{acceptsNewPointers=!0;usePointerLock;pinchInitDistance=0;pinchInitZoom=1;didLongPress=!1;isPointerLocked=!1;constructor(e){super(e);this.usePointerLock=e.usePointerLock??!1,this.usePointerLock&&document.addEventListener("pointerlockchange",this.onPointerLockChange)}dispose(){this.usePointerLock&&document.removeEventListener("pointerlockchange",this.onPointerLockChange)}handlePointerDown(e,r){if(super.handlePointerDown(e,r),this.usePointerLock&&r.length===1&&e.type==="mouse"&&this.editor.canvas?.requestPointerLock(),r.length===2){let[n,o]=r;this.pinchInitDistance=ie(n,o),this.pinchInitZoom=this.editor.zoom,this.acceptsNewPointers=!1}}handlePointerMove(e,r){if(super.handlePointerMove(e,r),!this.didLongPress)if(r.length===2){let n=r[1]===e?r[0]:r[1],o=ie(e,n);this.editor.setZoom(this.pinchInitZoom*o/this.pinchInitDistance,{x:(e.x+n.x)/2,y:(e.y+n.y)/2},!1),this.editor.setOffset({x:(e.x+n.x)/2-(e.x-e.delta.x+n.x)/2,y:(e.y+n.y)/2-(e.y-e.delta.y+n.y)/2})}else this.editor.setOffset({x:e.delta.x,y:e.delta.y})}handlePointerUp(e,r){super.handlePointerUp(e,r),this.acceptsNewPointers=!0,r.length===1&&(this.didLongPress=!1),this.isPointerLocked&&document.exitPointerLock()}onLongPress(e){super.onLongPress(e),this.didLongPress=!0}onPointerLockChange=()=>{this.isPointerLocked=document.pointerLockElement===this.editor.canvas}};var wt=window.devicePixelRatio||1,Ge=class extends H{zoom;offset={...k};canvas=null;edgeTopLeft={...k};edgeBottomRight={...k};canvasCssClass;pointers=[];rawOffset={...k};rawZoom;gesture=null;frameHandle;observer;constructor(e,r){super(e,r);let n=Math.max((e.minZoom+e.maxZoom)/2,Number.EPSILON);this.zoom=n,this.rawZoom=n}componentDidMount(){let e={passive:!0};window.addEventListener("pointermove",this.onPointerMove,e),window.addEventListener("pointerup",this.onPointerLost,e),window.addEventListener("pointercancel",this.onPointerLost,e)}componentWillUnmount(){window.removeEventListener("pointermove",this.onPointerMove),window.removeEventListener("pointerup",this.onPointerLost),window.removeEventListener("pointercancel",this.onPointerLost),this.observer?.disconnect(),this.observer=void 0,this.frameHandle!==void 0&&(cancelAnimationFrame(this.frameHandle),this.frameHandle=void 0)}shouldComponentUpdate(){return!1}render(){return I("canvas",{class:this.canvasCssClass,onContextMenu:Rt,onLostPointerCapture:this.onPointerLost,onPointerDown:this.onPointerDown,onWheel:this.onWheel,ref:this.onCanvasRef})}updateView(){this.frameHandle??=requestAnimationFrame(this.onFrame)}clientToEditorSpace(e){return{x:(e.x-(this.edgeTopLeft.x+this.edgeBottomRight.x)/2-this.offset.x)/this.zoom,y:(e.y-(this.edgeTopLeft.y+this.edgeBottomRight.y)/2-this.offset.y)/this.zoom}}getVisibleRect(){return{topLeft:this.clientToEditorSpace(this.edgeTopLeft),bottomRight:this.clientToEditorSpace(this.edgeBottomRight)}}setOffset(e,r=!0){this.rawOffset.x=(r?this.rawOffset.x:0)+e.x,this.rawOffset.y=(r?this.rawOffset.y:0)+e.y;let n=this.getOffsetAdjustment(this.rawOffset);(!D(n.x-this.offset.x)||!D(n.y-this.offset.y))&&(this.offset.x=n.x,this.offset.y=n.y,this.updateView())}setZoom(e,r,n=!0){this.rawZoom=K((n?this.rawZoom:0)+e,Math.max(this.props.minZoom,Number.EPSILON),this.props.maxZoom);let o=this.getZoomAdjustment(this.rawZoom),i=this.zoom-o;if(D(i))return;let a=this.clientToEditorSpace(r);this.setOffset({x:i*a.x,y:i*a.y}),this.zoom=o,this.updateView()}getOffsetAdjustment(e){return e}getZoomAdjustment(e){return e}getWheelDeltaAdjustment(e){return 1}updateLayout(e=this.canvas.getBoundingClientRect()){this.edgeTopLeft.y=e.top,this.edgeTopLeft.x=e.left,this.edgeBottomRight.y=e.bottom,this.edgeBottomRight.x=e.right}onPointerDown=e=>{let r=this.clientToEditorSpace(e);if(this.gesture===null&&(this.updateLayout(),this.gesture=this.hitTest(r,e)),this.gesture?.acceptsNewPointers===!0){let n={id:e.pointerId,type:e.pointerType,delta:{...k},editor:r,start:{x:e.x,y:e.y},x:e.x,y:e.y};this.pointers.push(n),this.gesture.handlePointerDown(n,this.pointers)}};onPointerMove=e=>{let r=this.pointers.find(({id:n})=>e.pointerId===n);!r||(r.delta.x=e.movementX/wt,r.delta.y=e.movementY/wt,D(r.x-e.x)&&D(r.y-e.y)?(r.sumMovement??={...k},r.sumMovement.x+=r.delta.x,r.sumMovement.y+=r.delta.y,r.x=r.start.x+r.sumMovement.x,r.y=r.start.y+r.sumMovement.y):(r.x=e.x,r.y=e.y),r.editor=this.clientToEditorSpace(r),this.gesture.handlePointerMove(r,this.pointers))};onPointerLost=e=>{let r=this.pointers.findIndex(({id:o})=>e.pointerId===o);if(r===-1)return;let n=this.pointers[r];this.gesture.handlePointerUp(n,this.pointers),this.pointers.splice(r,1),this.pointers.length===0&&(this.gesture=null)};onWheel=e=>{Rt(e);let r=-this.getWheelDeltaAdjustment(e);e.ctrlKey?(r/=(this.edgeBottomRight.y-this.edgeTopLeft.y)/3,this.setZoom(e.deltaY*r,e)):this.setOffset({x:(e.shiftKey?e.deltaY:e.deltaX)*r,y:(e.shiftKey?e.deltaX:e.deltaY)*r})};onCanvasRef=e=>{let r=this.canvas;r&&this.observer.unobserve(r),e&&(this.canvasAcquired(e),this.observer??=new ResizeObserver(this.onResizeObserved),this.observer.observe(e,{box:"content-box"})),this.canvas=e};onResizeObserved=e=>{let r=e[0].contentRect;this.updateLayout(r),this.canvasResized(r.width,r.height),this.updateView()};onFrame=()=>{this.frameHandle=this.canvasRender()?requestAnimationFrame(this.onFrame):void 0}};function Rt(t){t.preventDefault(),t.stopImmediatePropagation()}function Ct(t,e){let{length:r}=t;return r>1&&De(t,e,0,r-1),t}function Dr(t,e,r,n){let o=t[r+n>>>1],i;for(;r<=n;){for(;e(t[r],o)<0;)++r;for(;e(t[n],o)>0;)--n;r<=n&&(i=t[r],t[r++]=t[n],t[n--]=i)}return r}function De(t,e,r,n){let o=Dr(t,e,r,n);r<o-1&&De(t,e,r,o-1),n>o&&De(t,e,o,n)}var Le=class{constructor(e,r=k,n=16){this.graph=e;this.chunkSize=n;this.safeOriginX=Math.floor(r.x-n/2),this.safeOriginY=Math.floor(r.y-n/2)}chunks=new Map;safeOriginX;safeOriginY;beginMoveNode(e){let r=this.getChunk(e.x,e.y),n=this.getGridIndex(r,e.x,e.y);if(r.grid[n]!==e)throw new Error("beginMoveNode: accessor is out of sync");r.grid[n]=void 0,this.graph.beginMoveNode(e)}endMoveNode(e,r,n){let o=this.getChunk(r,n),i=this.getGridIndex(o,r,n);if(o.grid[i])throw new Error("endMoveNode: cannot move to an occupied cell");o.grid[i]=e,this.graph.endMoveNode(e,r,n)}get(e,r){let n=this.getChunk(e,r),o=this.getGridIndex(n,e,r);return n.grid[o]}getChunk(e,r){let{chunkSize:n}=this,o=Math.floor((e-this.safeOriginX)/n),i=Math.floor((r-this.safeOriginY)/n),a=kt(o)<<16|kt(i),c=this.chunks.get(a);if(!c){let l=this.safeOriginX+o*n,f=this.safeOriginY+i*n,u=this.graph.getNodesWithin(l,f,l+n-1,f+n-1),x=new Array(n*n);for(let v,p=0;p<u.length;++p)v=u[p],x[(v.x-l)*n+v.y-f]=v;this.chunks.set(a,c={grid:x,baseX:l,baseY:f})}return c}getGridIndex(e,r,n){return(r-e.baseX)*this.chunkSize+n-e.baseY}};function kt(t){return t>>16&32768|t&32767}var Lr=[1,0,0,-1,-1,0,0,1];function Mt(t,e,r,n,o){if(o.x===0&&o.y===0){for(let u=0;u<e.length;++u){let x=e[u];t.endMoveNode(x,x.x,x.y),n.add(x.id,o.frac)}return}let i=0,a=0;for(let u=0;u<e.length;++u){let x=e[u];i+=x.x,a+=x.y}i/=e.length,a/=e.length;let c=e.map(u=>({node:u,dist:(u.x-i)**2+(u.y-a)**2}));Ct(c,Nr);let l=new Set,f=new Le(t,{x:o.x+i,y:o.y+a});for(let u=0;u<c.length;++u){let{node:x}=c[u],v=Lr;if(!D(x.x-i)||!D(x.y-a)){let y=Math.sign(x.x-i),R=y===0?Math.sign(x.y-a):0;v=[y,R,-R,y,R,-y]}let p=Gt(f,x.x+o.x,x.y+o.y,v,r,l);if(l.clear(),p)for(let y,R=0;R<p.length;++R)y=p[R],f.beginMoveNode(y.node),f.endMoveNode(y.node,y.node.x+y.dx,y.node.y+y.dy),n.add(y.node.id,{x:-y.dx,y:-y.dy});f.endMoveNode(x,x.x+o.x,x.y+o.y),n.add(x.id,o.frac)}}function Nr(t,e){return t.dist-e.dist}function Gt(t,e,r,n,o,i){let a=t.get(e,r);if(!a)return[];if(o.has(a.id)||i.has(a.id))return null;i.add(a.id);let c=null,l=0,f,u;do{let x=n[l++],v=n[l++],p=Gt(t,e+x,r+v,n,o,i);p&&(!c||p.length<c.length)&&(c=p,f=x,u=v)}while(l<n.length);return c?.push({node:a,dx:f,dy:u}),c}function X(t){return[(t>>16&255)/255,(t>>8&255)/255,(t&255)/255]}function Q(t,e){let r=t.createProgram();for(let n of e.shaders){let o=Ir(t,n);t.attachShader(r,o)}if(t.linkProgram(r),!t.getProgramParameter(r,t.LINK_STATUS))throw new Error(`Error linking program:
`+t.getProgramInfoLog(r));return{ref:r,attributes:Dt(e.attributes,n=>t.getAttribLocation(r,n)),uniforms:Dt(e.uniforms,n=>t.getUniformLocation(r,n))}}function Ir(t,e){let r=t.createShader(e.type);if(t.shaderSource(r,e.source),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS)){let n={[t.VERTEX_SHADER]:"vertex",[t.FRAGMENT_SHADER]:"fragment"}[e.type]||"a";throw new Error(`Error compiling ${n} shader:
${t.getShaderInfoLog(r)}`)}return r}function Dt(t,e){let r={};for(let n of t)r[n]=e(n);return r}var Lt=`#version 300 es
precision mediump float;

in vec2 vGridPosition;

layout(location = 0) out vec4 fragColor;

uniform float uGridSize;
uniform vec3 uBackgroundColor;
uniform vec3 uGridlineColor;

void main() {
	// Flooring to strictly align to one side, avoiding double-width or disjoint gridlines.
	float halfSize = floor(uGridSize / 2.0);
	float gridlineDist = min(
		abs(floor(mod(vGridPosition[0], uGridSize) - halfSize)),
		abs(floor(mod(vGridPosition[1], uGridSize) - halfSize))
	);

	fragColor = vec4(mix(uBackgroundColor, uGridlineColor, float(gridlineDist == 0.0)), 1.0);
}
`;var Nt=`#version 300 es

in vec2 aClipPosition;

out vec2 vGridPosition;

uniform vec2 uScreenSize;
uniform vec2 uGridOffset;

void main() {
	gl_Position = vec4(aClipPosition, 0.0, 1.0);

	// Assuming that aClipPosition is +1 xor -1 and uGridOffset is an integer,
	// the final vGridPosition vector will have integer coordinates.
	vec2 mapping = vec2(
		(aClipPosition[0] * -0.5) + 0.5,
		(aClipPosition[1] *  0.5) + 0.5
	);

	vec2 offset = vec2(
		floor(uScreenSize[0] * 0.5),
		floor(uScreenSize[1] * 0.5)
	);

	vGridPosition = uScreenSize * mapping - offset + uGridOffset;
}
`;function It(t,e){let r=Q(t,{shaders:[{source:Nt,type:t.VERTEX_SHADER},{source:Lt,type:t.FRAGMENT_SHADER}],attributes:["aClipPosition"],uniforms:["uScreenSize","uGridOffset","uGridSize","uBackgroundColor","uGridlineColor"]}),n=t.createVertexArray();t.bindVertexArray(n);let o=t.createBuffer(),i=new Int8Array([-1,-1,1,-1,-1,1,1,1]);t.bindBuffer(t.ARRAY_BUFFER,o),t.bufferData(t.ARRAY_BUFFER,i,t.STATIC_READ),t.enableVertexAttribArray(r.attributes.aClipPosition),t.vertexAttribPointer(r.attributes.aClipPosition,2,t.BYTE,!1,0,0);let a=X(e.backgroundColor),c=X(e.gridlineColor);return{render(l){t.useProgram(r.ref),t.bindVertexArray(n),t.uniform2fv(r.uniforms.uScreenSize,[t.drawingBufferWidth,t.drawingBufferHeight]),t.uniform2fv(r.uniforms.uGridOffset,[l.gridOffset.x,l.gridOffset.y]),t.uniform1f(r.uniforms.uGridSize,l.gridSize),t.uniform3fv(r.uniforms.uBackgroundColor,a),t.uniform3fv(r.uniforms.uGridlineColor,c),t.drawArrays(t.TRIANGLE_STRIP,0,4)}}}var W=class{duration;easing;keys;map=new Map;zeroState;transitionCount=0;constructor(e){let r={};for(let n=0;n<e.keys.length;++n)r[e.keys[n]]=0;Object.assign(this,e),this.zeroState=r}get hasTransitions(){return this.transitionCount>0}add(e,r,n=W.now()){let o=this.map.get(e),i=o?.find(c=>D(c.$startTime-n));if(i){for(let c,l=0;l<this.keys.length;++l)c=this.keys[l],i[c]+=r[c]??0;return}i={$startTime:n};let a=!0;for(let c,l,f=0;f<this.keys.length;++f)c=this.keys[f],l=r[c]??0,i[c]=l,a&&=D(l);a||(o||this.map.set(e,o=[]),++this.transitionCount,o.push(i))}getFrame(e,r=W.now()){let n=this.map.get(e);if(!n)return this.zeroState;let{keys:o}=this,i={};for(let c=0;c<o.length;++c)i[o[c]]=0;let a=0;for(;a<n.length;){let c=n[a],l=1-(r-c.$startTime)/this.duration;if(l<=0){n.splice(a,1),--this.transitionCount;continue}l=this.easing(l);for(let f=0;f<o.length;++f){let u=o[f];i[u]+=c[u]*l}++a}return n.length===0&&this.map.delete(e),i}static now(){return performance.now()}};function Bt(t){return{ref:t.createBuffer(),size:0}}var ae=class{constructor(e,r){this.alloc=e;this.growthFactor=r?.growthFactor??1.618034,this.data=e(r?.initialCapacity??0)}data;growthFactor;usedCapacity=0;resize(e,r=!0){this.usedCapacity=e;let n=Math.max(this.data.length,1);if(e<n)return!1;let o=Math.ceil(Math.log(e/n)/Math.log(this.growthFactor)),i=Math.trunc(n*this.growthFactor**o),a=this.data;return this.data=this.alloc(i),r&&this.data.set(a),!0}commit(e,r){let n=r;n?.ref||(n={ref:r,size:e.getBufferParameter(e.ARRAY_BUFFER,e.BUFFER_SIZE)}),e.bindBuffer(e.ARRAY_BUFFER,n.ref);let o=this.usedCapacity*this.data.BYTES_PER_ELEMENT;n.size<o?(e.bufferData(e.ARRAY_BUFFER,this.data,e.DYNAMIC_READ),n.size=this.data.byteLength):e.bufferSubData(e.ARRAY_BUFFER,0,this.data,0,this.usedCapacity)}static createFloat32(e){return new ae(r=>new Float32Array(r),e)}};var Ot=`#version 300 es
precision mediump float;

in vec2 vTexPos;
in vec4 vColor;

layout(location = 0) out vec4 fragColor;

uniform sampler2D uShapes;
uniform vec3 uDefaultStrokeColor;
uniform vec3 uSelectedStrokeColor;

void main() {
	vec4 shape = texture(uShapes, vTexPos);
	vec3 stroke = mix(uDefaultStrokeColor, uSelectedStrokeColor, vColor.w);

	fragColor = vec4(
		mix(stroke, vColor.xyz, shape.y),
		shape.x
	);
}
`;var Ft=`#version 300 es

// shared:
in vec2 aCellPos;

// per-instance:
in vec2 aGridPos;
in float aColor;
in float aTexIndex;

out vec2 vTexPos;
out vec4 vColor;

uniform mat3x2 uViewMatrix;
uniform float uTexDiv;

void main() {
	gl_Position = vec4(
		uViewMatrix * vec3(
			aCellPos[0] + aGridPos[0],
			aCellPos[1] - aGridPos[1],
			1.0
		),
		0.0,
		1.0
	);

	float size = 1.0 / uTexDiv;
	float halfSize = size * 0.5;
	vTexPos = vec2(
		  mod(aTexIndex,  uTexDiv) / uTexDiv + aCellPos[0] * size + halfSize,
		floor(aTexIndex / uTexDiv) / uTexDiv - aCellPos[1] * size + halfSize
	);

	highp uint rgb = uint(aColor);
	vColor = vec4(
		float((rgb >> 16u) & 255u) / 255.0,
		float((rgb >>  8u) & 255u) / 255.0,
		float( rgb         & 255u) / 255.0,

		// w is used to swap between stroke colors
		float((rgb >> 24u) & 255u)
	);
}
`;function Yr(t,e){let r=Math.ceil(Math.sqrt(t.length)),n=r*e,o=new OffscreenCanvas(n,n),i=o.getContext("2d",{alpha:!1,desynchronized:!0,willReadFrequently:!1});if(!i)throw new Error("Could not obtain offscreen 2D rendering context.");i.clearRect(0,0,n,n);let a=e/2;for(let c=0;c<t.length;++c)t[c](i,a+c%r*e,a+Math.trunc(c/r)*e,a);return{source:o,divisions:r}}function Ur(t,e,r,n,o){e.fillStyle="#ffff00",e.strokeStyle="#ff0000",e.lineWidth=Math.max(1,o/12),e.beginPath(),e.moveTo(Math.round(r+t[0]*o),Math.round(n+t[1]*o));let i=2;for(;i<t.length;)e.lineTo(Math.round(r+t[i++]*o),Math.round(n+t[i++]*o));e.closePath(),e.fill(),e.stroke()}function zt(t,e){let r=[];for(let n=0;n<t.length;++n)r.push(Ur.bind(null,t[n]));return Yr(r,e)}function Ut(t,e){let r=Q(t,{shaders:[{source:Ft,type:t.VERTEX_SHADER},{source:Ot,type:t.FRAGMENT_SHADER}],attributes:["aCellPos","aGridPos","aColor","aTexIndex"],uniforms:["uViewMatrix","uTexDiv","uShapes","uDefaultStrokeColor","uSelectedStrokeColor"]}),n=t.createVertexArray();t.bindVertexArray(n);let o=t.createBuffer(),i=new Float32Array([-.5,-.5,.5,-.5,-.5,.5,.5,.5]);t.bindBuffer(t.ARRAY_BUFFER,o),t.bufferData(t.ARRAY_BUFFER,i,t.STATIC_READ),t.enableVertexAttribArray(r.attributes.aCellPos),t.vertexAttribPointer(r.attributes.aCellPos,2,t.FLOAT,!1,0,0),t.vertexAttribDivisor(r.attributes.aCellPos,0);let a=Bt(t),c=ae.createFloat32();t.bindBuffer(t.ARRAY_BUFFER,a.ref),t.enableVertexAttribArray(r.attributes.aGridPos),t.vertexAttribPointer(r.attributes.aGridPos,2,t.FLOAT,!1,16,0),t.vertexAttribDivisor(r.attributes.aGridPos,1),t.enableVertexAttribArray(r.attributes.aColor),t.vertexAttribPointer(r.attributes.aColor,1,t.FLOAT,!1,16,8),t.vertexAttribDivisor(r.attributes.aColor,1),t.enableVertexAttribArray(r.attributes.aTexIndex),t.vertexAttribPointer(r.attributes.aTexIndex,1,t.FLOAT,!1,16,12),t.vertexAttribDivisor(r.attributes.aTexIndex,1);let l=zt(e.shapes,e.shapeResolution),f=t.createTexture();t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,f),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.RGB,t.RGB,t.UNSIGNED_BYTE,l.source);let u=X(e.defaultStrokeColor),x=X(e.selectedStrokeColor);return{render(v){let{dragging:p,nodes:y,selectedIds:R,transitions:s}=v,d=p?.mode===1,h=y.length+(d?p.nodes.length:0);if(h===0)return;t.useProgram(r.ref),t.bindVertexArray(n),c.resize(h*4,!1);let{data:g}=c,m=W.now(),_=0,b=(M,B,O=k)=>{let F=s.getFrame(M.id,m);g[_++]=M.x+O.x+F.x,g[_++]=M.y+O.y+F.y,g[_++]=(M.color??16777215)|(B?16777216:0),g[_++]=M.shapeIndex??0};for(let M=0;M<y.length;++M)b(y[M],!d&&R.has(y[M].id));d&&p.nodes.forEach(M=>b(M,!0,p.offset)),c.commit(t,a);let P=t.drawingBufferWidth/2,T=t.drawingBufferHeight/2,A=v.gridSize/P,w=v.gridSize/T,E=v.gridOffset.x/P,C=-v.gridOffset.y/T;t.uniform1i(r.uniforms.uShapes,0),t.uniform1f(r.uniforms.uTexDiv,l.divisions),t.uniform3fv(r.uniforms.uDefaultStrokeColor,u),t.uniform3fv(r.uniforms.uSelectedStrokeColor,x),t.uniformMatrix3x2fv(r.uniforms.uViewMatrix,!1,[A,0,0,w,E,C]),t.drawArraysInstanced(t.TRIANGLE_STRIP,0,4,h)}}}var Ht=`#version 300 es
precision mediump float;

layout(location = 0) out vec4 fragColor;

uniform vec3 uSelectedStrokeColor;
uniform float uDashSize;

void main() {
	float xMod = mod(gl_FragCoord[0], 2.0 * uDashSize);
	float yMod = mod(gl_FragCoord[1], 2.0 * uDashSize);
	float alpha = float(
		(xMod < uDashSize && yMod < uDashSize) ||
		(xMod > uDashSize && yMod > uDashSize)
	);

	fragColor = vec4(uSelectedStrokeColor, alpha);
}
`;var Vt=`#version 300 es

in vec2 aClipPos;

void main() {
	gl_Position = vec4(aClipPos, 0.0, 1.0);
}
`;function Xt(t,e){let r=Q(t,{shaders:[{source:Vt,type:t.VERTEX_SHADER},{source:Ht,type:t.FRAGMENT_SHADER}],attributes:["aClipPos"],uniforms:["uSelectedStrokeColor","uDashSize"]}),n=t.createVertexArray();t.bindVertexArray(n);let o=t.createBuffer(),i=new Float32Array(8);t.bindBuffer(t.ARRAY_BUFFER,o),t.bufferData(t.ARRAY_BUFFER,i,t.STATIC_READ),t.enableVertexAttribArray(r.attributes.aClipPos),t.vertexAttribPointer(r.attributes.aClipPos,2,t.FLOAT,!1,0,0);let a=X(e.selectedStrokeColor);return{render({gridOffset:c,gridSize:l,dragging:f}){if(f?.mode!==0)return;t.useProgram(r.ref),t.bindVertexArray(n);let u=t.drawingBufferWidth/2,x=t.drawingBufferHeight/2,v=(R,s,d)=>{i[d]=(R*l+c.x)/u,i[d+1]=-(s*l+c.y)/x},p=f.start,y=f.offset;v(p.x,p.y,0),v(p.x+y.x,p.y,2),v(p.x+y.x,p.y+y.y,4),v(p.x,p.y+y.y,6),t.bindBuffer(t.ARRAY_BUFFER,o),t.bufferSubData(t.ARRAY_BUFFER,0,i),t.uniform1f(r.uniforms.uDashSize,l/4),t.uniform3fv(r.uniforms.uSelectedStrokeColor,a),t.drawArrays(t.LINE_LOOP,0,4)}}}function Wt(t,e){let r=t.getContext("webgl2",{alpha:!1,antialias:!1,depth:!1,desynchronized:!0,failIfMajorPerformanceCaveat:!0,powerPreference:"high-performance",premultipliedAlpha:!1,preserveDrawingBuffer:!1,stencil:!1});if(!r)throw new Error("Could not obtain WebGL rendering context.");r.enable(r.BLEND),r.blendFunc(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA);let n=It(r,e),o=Ut(r,e),i=Xt(r,e);return{render(a){n.render(a),o.render(a),i.render(a)},resize(a,c){t.width===a&&t.height===c||(t.width=a,t.height=c,r.viewport(0,0,r.drawingBufferWidth,r.drawingBufferHeight))}}}var j=window.devicePixelRatio||1,Ne=class extends Ge{canvasCssClass="graph-editor";dragGesture;panAndZoomGesture;selectedIds=new Set;transitions=new W({duration:300,easing:e=>e**5,keys:["x","y"]});dragging;renderer;constructor(e){super(e);this.dragGesture=new ke({editor:this}),this.panAndZoomGesture=new Me({editor:this,usePointerLock:!0}),oe(this.dragGesture.drag,this.onDragMove),oe(this.dragGesture.drop,this.onDragDrop),oe(this.dragGesture.press,this.onNodePress),oe(this.panAndZoomGesture.press,this.onVoidPress)}componentWillUnmount(){super.componentWillUnmount(),this.renderer=void 0}canvasAcquired(e){this.renderer=Wt(e,{backgroundColor:this.props.backgroundColor,gridlineColor:this.props.gridlineColor,defaultStrokeColor:this.props.defaultStrokeColor,selectedStrokeColor:this.props.selectedStrokeColor,shapes:this.props.shapes,shapeResolution:Math.round(this.props.maxZoom*this.props.gridSize*j)})}canvasResized(e,r){this.renderer.resize(Math.round(e*j),Math.round(r*j))}canvasRender(){let e=this.getVisibleRect(),r=this.editorToGridSpace(e.topLeft),n=this.editorToGridSpace(e.bottomRight);return this.renderer.render({gridSize:Math.round(this.zoom*this.props.gridSize*j),gridOffset:{x:Math.round(this.offset.x*j),y:Math.round(this.offset.y*j)},nodes:this.props.graph.getNodesWithin(r.x,r.y,n.x,n.y),selectedIds:this.selectedIds,transitions:this.transitions,dragging:this.dragging}),this.transitions.hasTransitions}hitTest(e,r){let n=this.editorToGridSpace(e),{graph:o}=this.props;if(r.ctrlKey)return this.dragging={mode:0,start:n.raw,offset:{...k}},this.updateView(),this.dragGesture;let i=o.getNodeAt(n.x,n.y);if(i){let a;return this.selectedIds.has(i.id)?a=Array.from(this.selectedIds).map(c=>o.getNodeById(c)):(a=[i],this.selectedIds.clear(),this.selectedIds.add(i.id)),this.dragging={mode:1,offset:{...k},nodes:a},a.forEach(c=>o.beginMoveNode(c)),this.dragGesture}return this.panAndZoomGesture}getZoomAdjustment(e){let r=this.props.gridSize*j/2;return Math.round(e*r)/r}getWheelDeltaAdjustment(e){switch(e.deltaMode){case WheelEvent.DOM_DELTA_PAGE:return this.edgeBottomRight.y-this.edgeTopLeft.y;case WheelEvent.DOM_DELTA_LINE:return this.props.gridSize;default:return 1}}editorToGridSpace(e){let r={x:e.x/this.props.gridSize,y:e.y/this.props.gridSize},n=Math.round(r.x),o=Math.round(r.y);return{x:n,y:o,raw:r,frac:{x:r.x-n,y:r.y-o}}}onVoidPress=()=>{this.selectedIds.size>0&&(this.selectedIds.clear(),this.updateView())};onNodePress=e=>{let r=this.editorToGridSpace(e),n=this.props.graph.getNodeAt(r.x,r.y);n&&(this.selectedIds.clear(),this.selectedIds.add(n.id),this.updateView())};onDragMove=e=>{this.dragging.offset=this.editorToGridSpace(e).raw,this.updateView()};onDragDrop=e=>{let r=this.editorToGridSpace(e),n=this.dragging;switch(n.mode){case 1:Mt(this.props.graph,n.nodes,this.selectedIds,this.transitions,r);break;case 0:{let{start:o}=n,i=this.props.graph.getNodesWithin(Math.round(Math.min(o.x,o.x+r.x)),Math.round(Math.min(o.y,o.y+r.y)),Math.round(Math.max(o.x,o.x+r.x)),Math.round(Math.max(o.y,o.y+r.y)));this.selectedIds.clear(),i.forEach(a=>this.selectedIds.add(a.id));break}}this.dragging=void 0,this.updateView()}};var Xr=[.68,0,.657,-.176,.589,-.34,.481,-.481,.34,-.589,.176,-.657,0,-.68,-.176,-.657,-.34,-.589,-.481,-.481,-.589,-.34,-.657,-.176,-.68,-0,-.657,.176,-.589,.34,-.481,.481,-.34,.589,-.176,.657,-0,.68,.176,.657,.34,.589,.481,.481,.589,.34,.657,.176],Wr=[.68,-.68,-.68,-.68,-.68,.68,.68,.68],Zr=[.8,0,0,-.8,-.8,-0,-0,.8],$r=[.8,-.68,-.8,-.68,-0,.68],Kr=[.462,0,.693,-.4,.231,-.4,0,-.8,-.231,-.4,-.693,-.4,-.462,-0,-.693,.4,-.231,.4,-0,.8,.231,.4,.693,.4],Ie=[Xr,Wr,Zr,$r,Kr];var de=class{constructor(e){this.alphabet=e;let r=e.length;if(r===0)throw new Error("Alphabet cannot be empty.");if((r&r-1)!==0)throw new Error("Alphabet length must be a power of two.");this.shift=Math.trunc(Math.log(r)/Math.LN2),this.mask=Math.trunc(r-1)}shift;mask;index=0;next(){let e="",r=this.index++;do e=this.alphabet[r&this.mask]+e,r>>=this.shift;while(r>0);return e}static createBase32(){return new de("0123456789abcdefghijklmnopqrstuv")}};function ue(t,e){if(!t)return!1;let r=t.indexOf(e);return r===-1?!1:(t.splice(r,1),!0)}var Fe=ar(Zt());var ze=class extends Fe.default{toBBox({x:e,y:r}){return{minX:e,minY:r,maxX:e,maxY:r}}compareMinX(e,r){return e.x-r.x}compareMinY(e,r){return e.y-r.y}};function Ye(t,e,r,n){return{maxX:r+Number.EPSILON,minX:t-Number.EPSILON,maxY:n+Number.EPSILON,minY:e-Number.EPSILON}}var Ue=class{identity;edges=new Set;nodes=new Map;space=new ze;constructor(e){this.identity=e.identity}createNode(e,r){let n={id:this.identity.next(),x:e,y:r};return this.nodes.set(n.id,n),this.space.insert(n),n}removeNode(e){if(!this.nodes.delete(e.id))return!1;if(e.incoming)for(let r of e.incoming)this.edges.delete(r),ue(r.source.outgoing,r);if(e.outgoing)for(let r of e.outgoing)this.edges.delete(r),ue(r.destination.incoming,r);return this.space.remove(e),!0}createEdge(e,r){let n=e.outgoing,o=r.incoming,i=n&&o&&(n.length<o.length?n.find(a=>a.destination===r):o.find(a=>a.source===e));return i||(i={source:e,destination:r},(e.outgoing??=[]).push(i),(r.incoming??=[]).push(i),this.edges.add(i)),i}removeEdge(e){return this.edges.delete(e)?(ue(e.source.outgoing,e),ue(e.destination.incoming,e),!0):!1}beginMoveNode(e){this.space.remove(e)}endMoveNode(e,r,n){e.x=r,e.y=n,this.getNodeAt(e.x,e.y)&&console.warn("endMoveNode: node moved into an occupied cell!"),this.space.insert(e)}getNodeById(e){return this.nodes.get(e)??null}getNodeAt(e,r){let n=this.space.search(Ye(e,r,e,r));return n.length>1&&console.warn(`getNodeAt: more than one node found at [ ${e}, ${r} ]`),n.length>0?n[0]:null}getNodesWithin(e,r,n,o){return this.space.search(Ye(e,r,n,o))}};var He=new Ue({identity:de.createBase32()});function xe(t,e){return Math.round(t+Math.random()*(e-t))}var Kt=1e5,be=Math.sqrt(Kt)*2,$t=0;for(;$t<Kt;){let t=xe(-be,be),e=xe(-be,be);if(He.getNodeAt(t,e))continue;let r=He.createNode(t,e);r.color=xe(0,16777215),r.shapeIndex=xe(0,Ie.length-1),++$t}var jt=()=>I(Re,{url:"./locale/en.json"},I(Ne,{graph:He,gridSize:32,backgroundColor:2763306,gridlineColor:3815994,defaultStrokeColor:0,selectedStrokeColor:16777215,shapes:Ie,minZoom:.5,maxZoom:2}));st(I(jt,null),document.getElementById("root"));})();
//# sourceMappingURL=index.js.map
