(()=>{var Zt=Object.create;var le=Object.defineProperty;var $t=Object.getOwnPropertyDescriptor;var Kt=Object.getOwnPropertyNames;var jt=Object.getPrototypeOf,qt=Object.prototype.hasOwnProperty;var Jt=(t,e,r)=>e in t?le(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Qt=t=>le(t,"__esModule",{value:!0});var er=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var tr=(t,e,r,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Kt(e))!qt.call(t,n)&&(r||n!=="default")&&le(t,n,{get:()=>e[n],enumerable:!(o=$t(e,n))||o.enumerable});return t},rr=(t,e)=>tr(Qt(le(t!=null?Zt(jt(t)):{},"default",!e&&t&&t.__esModule?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);var de=(t,e,r)=>(Jt(t,typeof e!="symbol"?e+"":e,r),r);var Vt=er((Be,Ie)=>{(function(t,e){typeof Be=="object"&&typeof Ie<"u"?Ie.exports=e():typeof define=="function"&&define.amd?define(e):(t=t||self).RBush=e()})(Be,function(){"use strict";function t(s,u,d,y,f){(function m(v,b,S,T,R){for(;T>S;){if(T-S>600){var E=T-S+1,w=b-S+1,C=Math.log(E),N=.5*Math.exp(2*C/3),O=.5*Math.sqrt(C*N*(E-N)/E)*(w-E/2<0?-1:1),F=Math.max(S,Math.floor(b-w*N/E+O)),Wt=Math.min(T,Math.floor(b+(E-w)*N/E+O));m(v,b,F,Wt,R)}var ce=v[b],ee=S,G=T;for(e(v,S,b),R(v[T],ce)>0&&e(v,S,T);ee<G;){for(e(v,ee,G),ee++,G--;R(v[ee],ce)<0;)ee++;for(;R(v[G],ce)>0;)G--}R(v[S],ce)===0?e(v,S,G):e(v,++G,T),G<=b&&(S=G+1),b<=G&&(T=G-1)}})(s,u,d||0,y||s.length-1,f||r)}function e(s,u,d){var y=s[u];s[u]=s[d],s[d]=y}function r(s,u){return s<u?-1:s>u?1:0}var o=function(s){s===void 0&&(s=9),this._maxEntries=Math.max(4,s),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function n(s,u,d){if(!d)return u.indexOf(s);for(var y=0;y<u.length;y++)if(d(s,u[y]))return y;return-1}function i(s,u){a(s,0,s.children.length,u,s)}function a(s,u,d,y,f){f||(f=g(null)),f.minX=1/0,f.minY=1/0,f.maxX=-1/0,f.maxY=-1/0;for(var m=u;m<d;m++){var v=s.children[m];l(f,s.leaf?y(v):v)}return f}function l(s,u){return s.minX=Math.min(s.minX,u.minX),s.minY=Math.min(s.minY,u.minY),s.maxX=Math.max(s.maxX,u.maxX),s.maxY=Math.max(s.maxY,u.maxY),s}function h(s,u){return s.minX-u.minX}function _(s,u){return s.minY-u.minY}function c(s){return(s.maxX-s.minX)*(s.maxY-s.minY)}function A(s){return s.maxX-s.minX+(s.maxY-s.minY)}function x(s,u){return s.minX<=u.minX&&s.minY<=u.minY&&u.maxX<=s.maxX&&u.maxY<=s.maxY}function p(s,u){return u.minX<=s.maxX&&u.minY<=s.maxY&&u.maxX>=s.minX&&u.maxY>=s.minY}function g(s){return{children:s,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function D(s,u,d,y,f){for(var m=[u,d];m.length;)if(!((d=m.pop())-(u=m.pop())<=y)){var v=u+Math.ceil((d-u)/y/2)*y;t(s,v,u,d,f),m.push(u,v,v,d)}}return o.prototype.all=function(){return this._all(this.data,[])},o.prototype.search=function(s){var u=this.data,d=[];if(!p(s,u))return d;for(var y=this.toBBox,f=[];u;){for(var m=0;m<u.children.length;m++){var v=u.children[m],b=u.leaf?y(v):v;p(s,b)&&(u.leaf?d.push(v):x(s,b)?this._all(v,d):f.push(v))}u=f.pop()}return d},o.prototype.collides=function(s){var u=this.data;if(!p(s,u))return!1;for(var d=[];u;){for(var y=0;y<u.children.length;y++){var f=u.children[y],m=u.leaf?this.toBBox(f):f;if(p(s,m)){if(u.leaf||x(s,m))return!0;d.push(f)}}u=d.pop()}return!1},o.prototype.load=function(s){if(!s||!s.length)return this;if(s.length<this._minEntries){for(var u=0;u<s.length;u++)this.insert(s[u]);return this}var d=this._build(s.slice(),0,s.length-1,0);if(this.data.children.length)if(this.data.height===d.height)this._splitRoot(this.data,d);else{if(this.data.height<d.height){var y=this.data;this.data=d,d=y}this._insert(d,this.data.height-d.height-1,!0)}else this.data=d;return this},o.prototype.insert=function(s){return s&&this._insert(s,this.data.height-1),this},o.prototype.clear=function(){return this.data=g([]),this},o.prototype.remove=function(s,u){if(!s)return this;for(var d,y,f,m=this.data,v=this.toBBox(s),b=[],S=[];m||b.length;){if(m||(m=b.pop(),y=b[b.length-1],d=S.pop(),f=!0),m.leaf){var T=n(s,m.children,u);if(T!==-1)return m.children.splice(T,1),b.push(m),this._condense(b),this}f||m.leaf||!x(m,v)?y?(d++,m=y.children[d],f=!1):m=null:(b.push(m),S.push(d),d=0,y=m,m=m.children[0])}return this},o.prototype.toBBox=function(s){return s},o.prototype.compareMinX=function(s,u){return s.minX-u.minX},o.prototype.compareMinY=function(s,u){return s.minY-u.minY},o.prototype.toJSON=function(){return this.data},o.prototype.fromJSON=function(s){return this.data=s,this},o.prototype._all=function(s,u){for(var d=[];s;)s.leaf?u.push.apply(u,s.children):d.push.apply(d,s.children),s=d.pop();return u},o.prototype._build=function(s,u,d,y){var f,m=d-u+1,v=this._maxEntries;if(m<=v)return i(f=g(s.slice(u,d+1)),this.toBBox),f;y||(y=Math.ceil(Math.log(m)/Math.log(v)),v=Math.ceil(m/Math.pow(v,y-1))),(f=g([])).leaf=!1,f.height=y;var b=Math.ceil(m/v),S=b*Math.ceil(Math.sqrt(v));D(s,u,d,S,this.compareMinX);for(var T=u;T<=d;T+=S){var R=Math.min(T+S-1,d);D(s,T,R,b,this.compareMinY);for(var E=T;E<=R;E+=b){var w=Math.min(E+b-1,R);f.children.push(this._build(s,E,w,y-1))}}return i(f,this.toBBox),f},o.prototype._chooseSubtree=function(s,u,d,y){for(;y.push(u),!u.leaf&&y.length-1!==d;){for(var f=1/0,m=1/0,v=void 0,b=0;b<u.children.length;b++){var S=u.children[b],T=c(S),R=(E=s,w=S,(Math.max(w.maxX,E.maxX)-Math.min(w.minX,E.minX))*(Math.max(w.maxY,E.maxY)-Math.min(w.minY,E.minY))-T);R<m?(m=R,f=T<f?T:f,v=S):R===m&&T<f&&(f=T,v=S)}u=v||u.children[0]}var E,w;return u},o.prototype._insert=function(s,u,d){var y=d?s:this.toBBox(s),f=[],m=this._chooseSubtree(y,this.data,u,f);for(m.children.push(s),l(m,y);u>=0&&f[u].children.length>this._maxEntries;)this._split(f,u),u--;this._adjustParentBBoxes(y,f,u)},o.prototype._split=function(s,u){var d=s[u],y=d.children.length,f=this._minEntries;this._chooseSplitAxis(d,f,y);var m=this._chooseSplitIndex(d,f,y),v=g(d.children.splice(m,d.children.length-m));v.height=d.height,v.leaf=d.leaf,i(d,this.toBBox),i(v,this.toBBox),u?s[u-1].children.push(v):this._splitRoot(d,v)},o.prototype._splitRoot=function(s,u){this.data=g([s,u]),this.data.height=s.height+1,this.data.leaf=!1,i(this.data,this.toBBox)},o.prototype._chooseSplitIndex=function(s,u,d){for(var y,f,m,v,b,S,T,R=1/0,E=1/0,w=u;w<=d-u;w++){var C=a(s,0,w,this.toBBox),N=a(s,w,d,this.toBBox),O=(f=C,m=N,v=void 0,b=void 0,S=void 0,T=void 0,v=Math.max(f.minX,m.minX),b=Math.max(f.minY,m.minY),S=Math.min(f.maxX,m.maxX),T=Math.min(f.maxY,m.maxY),Math.max(0,S-v)*Math.max(0,T-b)),F=c(C)+c(N);O<R?(R=O,y=w,E=F<E?F:E):O===R&&F<E&&(E=F,y=w)}return y||d-u},o.prototype._chooseSplitAxis=function(s,u,d){var y=s.leaf?this.compareMinX:h,f=s.leaf?this.compareMinY:_;this._allDistMargin(s,u,d,y)<this._allDistMargin(s,u,d,f)&&s.children.sort(y)},o.prototype._allDistMargin=function(s,u,d,y){s.children.sort(y);for(var f=this.toBBox,m=a(s,0,u,f),v=a(s,d-u,d,f),b=A(m)+A(v),S=u;S<d-u;S++){var T=s.children[S];l(m,s.leaf?f(T):T),b+=A(m)}for(var R=d-u-1;R>=u;R--){var E=s.children[R];l(v,s.leaf?f(E):E),b+=A(v)}return b},o.prototype._adjustParentBBoxes=function(s,u,d){for(var y=d;y>=0;y--)l(u[y],s)},o.prototype._condense=function(s){for(var u=s.length-1,d=void 0;u>=0;u--)s[u].children.length===0?u>0?(d=s[u-1].children).splice(d.indexOf(s[u]),1):this.clear():i(s[u],this.toBBox)},o})});var _e,P,Ze,or,te,$e,Ye,Ke,fe={},je=[],nr=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function V(t,e){for(var r in e)t[r]=e[r];return t}function qe(t){var e=t.parentNode;e&&e.removeChild(t)}function I(t,e,r){var o,n,i,a={};for(i in e)i=="key"?o=e[i]:i=="ref"?n=e[i]:a[i]=e[i];if(arguments.length>2&&(a.children=arguments.length>3?_e.call(arguments,2):r),typeof t=="function"&&t.defaultProps!=null)for(i in t.defaultProps)a[i]===void 0&&(a[i]=t.defaultProps[i]);return he(t,a,o,n,null)}function he(t,e,r,o,n){var i={type:t,props:e,key:r,ref:o,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:n??++Ze};return n==null&&P.vnode!=null&&P.vnode(i),i}function ye(t){return t.children}function Y(t,e){this.props=t,this.context=e}function q(t,e){if(e==null)return t.__?q(t.__,t.__.__k.indexOf(t)+1):null;for(var r;e<t.__k.length;e++)if((r=t.__k[e])!=null&&r.__e!=null)return r.__e;return typeof t.type=="function"?q(t):null}function Je(t){var e,r;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((r=t.__k[e])!=null&&r.__e!=null){t.__e=t.__c.base=r.__e;break}return Je(t)}}function Pe(t){(!t.__d&&(t.__d=!0)&&te.push(t)&&!pe.__r++||Ye!==P.debounceRendering)&&((Ye=P.debounceRendering)||$e)(pe)}function pe(){for(var t;pe.__r=te.length;)t=te.sort(function(e,r){return e.__v.__b-r.__v.__b}),te=[],t.some(function(e){var r,o,n,i,a,l;e.__d&&(a=(i=(r=e).__v).__e,(l=r.__P)&&(o=[],(n=V({},i)).__v=i.__v+1,Se(l,i,n,r.__n,l.ownerSVGElement!==void 0,i.__h!=null?[a]:null,o,a??q(i),i.__h),rt(o,i),i.__e!=a&&Je(i)))})}function Qe(t,e,r,o,n,i,a,l,h,_){var c,A,x,p,g,D,s,u=o&&o.__k||je,d=u.length;for(r.__k=[],c=0;c<e.length;c++)if((p=r.__k[c]=(p=e[c])==null||typeof p=="boolean"?null:typeof p=="string"||typeof p=="number"||typeof p=="bigint"?he(null,p,null,null,p):Array.isArray(p)?he(ye,{children:p},null,null,null):p.__b>0?he(p.type,p.props,p.key,null,p.__v):p)!=null){if(p.__=r,p.__b=r.__b+1,(x=u[c])===null||x&&p.key==x.key&&p.type===x.type)u[c]=void 0;else for(A=0;A<d;A++){if((x=u[A])&&p.key==x.key&&p.type===x.type){u[A]=void 0;break}x=null}Se(t,p,x=x||fe,n,i,a,l,h,_),g=p.__e,(A=p.ref)&&x.ref!=A&&(s||(s=[]),x.ref&&s.push(x.ref,null,p),s.push(A,p.__c||g,p)),g!=null?(D==null&&(D=g),typeof p.type=="function"&&p.__k===x.__k?p.__d=h=et(p,h,t):h=tt(t,p,x,u,g,h),typeof r.type=="function"&&(r.__d=h)):h&&x.__e==h&&h.parentNode!=t&&(h=q(x))}for(r.__e=D,c=d;c--;)u[c]!=null&&(typeof r.type=="function"&&u[c].__e!=null&&u[c].__e==r.__d&&(r.__d=q(o,c+1)),nt(u[c],u[c]));if(s)for(c=0;c<s.length;c++)ot(s[c],s[++c],s[++c])}function et(t,e,r){for(var o,n=t.__k,i=0;n&&i<n.length;i++)(o=n[i])&&(o.__=t,e=typeof o.type=="function"?et(o,e,r):tt(r,o,o,n,o.__e,e));return e}function tt(t,e,r,o,n,i){var a,l,h;if(e.__d!==void 0)a=e.__d,e.__d=void 0;else if(r==null||n!=i||n.parentNode==null)e:if(i==null||i.parentNode!==t)t.appendChild(n),a=null;else{for(l=i,h=0;(l=l.nextSibling)&&h<o.length;h+=2)if(l==n)break e;t.insertBefore(n,i),a=i}return a!==void 0?a:n.nextSibling}function ir(t,e,r,o,n){var i;for(i in r)i==="children"||i==="key"||i in e||me(t,i,null,r[i],o);for(i in e)n&&typeof e[i]!="function"||i==="children"||i==="key"||i==="value"||i==="checked"||r[i]===e[i]||me(t,i,e[i],r[i],o)}function He(t,e,r){e[0]==="-"?t.setProperty(e,r):t[e]=r==null?"":typeof r!="number"||nr.test(e)?r:r+"px"}function me(t,e,r,o,n){var i;e:if(e==="style")if(typeof r=="string")t.style.cssText=r;else{if(typeof o=="string"&&(t.style.cssText=o=""),o)for(e in o)r&&e in r||He(t.style,e,"");if(r)for(e in r)o&&r[e]===o[e]||He(t.style,e,r[e])}else if(e[0]==="o"&&e[1]==="n")i=e!==(e=e.replace(/Capture$/,"")),e=e.toLowerCase()in t?e.toLowerCase().slice(2):e.slice(2),t.l||(t.l={}),t.l[e+i]=r,r?o||t.addEventListener(e,i?We:Xe,i):t.removeEventListener(e,i?We:Xe,i);else if(e!=="dangerouslySetInnerHTML"){if(n)e=e.replace(/xlink[H:h]/,"h").replace(/sName$/,"s");else if(e!=="href"&&e!=="list"&&e!=="form"&&e!=="tabIndex"&&e!=="download"&&e in t)try{t[e]=r??"";break e}catch{}typeof r=="function"||(r!=null&&(r!==!1||e[0]==="a"&&e[1]==="r")?t.setAttribute(e,r):t.removeAttribute(e))}}function Xe(t){this.l[t.type+!1](P.event?P.event(t):t)}function We(t){this.l[t.type+!0](P.event?P.event(t):t)}function Se(t,e,r,o,n,i,a,l,h){var _,c,A,x,p,g,D,s,u,d,y,f=e.type;if(e.constructor!==void 0)return null;r.__h!=null&&(h=r.__h,l=e.__e=r.__e,e.__h=null,i=[l]),(_=P.__b)&&_(e);try{e:if(typeof f=="function"){if(s=e.props,u=(_=f.contextType)&&o[_.__c],d=_?u?u.props.value:_.__:o,r.__c?D=(c=e.__c=r.__c).__=c.__E:("prototype"in f&&f.prototype.render?e.__c=c=new f(s,d):(e.__c=c=new Y(s,d),c.constructor=f,c.render=ar),u&&u.sub(c),c.props=s,c.state||(c.state={}),c.context=d,c.__n=o,A=c.__d=!0,c.__h=[]),c.__s==null&&(c.__s=c.state),f.getDerivedStateFromProps!=null&&(c.__s==c.state&&(c.__s=V({},c.__s)),V(c.__s,f.getDerivedStateFromProps(s,c.__s))),x=c.props,p=c.state,A)f.getDerivedStateFromProps==null&&c.componentWillMount!=null&&c.componentWillMount(),c.componentDidMount!=null&&c.__h.push(c.componentDidMount);else{if(f.getDerivedStateFromProps==null&&s!==x&&c.componentWillReceiveProps!=null&&c.componentWillReceiveProps(s,d),!c.__e&&c.shouldComponentUpdate!=null&&c.shouldComponentUpdate(s,c.__s,d)===!1||e.__v===r.__v){c.props=s,c.state=c.__s,e.__v!==r.__v&&(c.__d=!1),c.__v=e,e.__e=r.__e,e.__k=r.__k,e.__k.forEach(function(m){m&&(m.__=e)}),c.__h.length&&a.push(c);break e}c.componentWillUpdate!=null&&c.componentWillUpdate(s,c.__s,d),c.componentDidUpdate!=null&&c.__h.push(function(){c.componentDidUpdate(x,p,g)})}c.context=d,c.props=s,c.state=c.__s,(_=P.__r)&&_(e),c.__d=!1,c.__v=e,c.__P=t,_=c.render(c.props,c.state,c.context),c.state=c.__s,c.getChildContext!=null&&(o=V(V({},o),c.getChildContext())),A||c.getSnapshotBeforeUpdate==null||(g=c.getSnapshotBeforeUpdate(x,p)),y=_!=null&&_.type===ye&&_.key==null?_.props.children:_,Qe(t,Array.isArray(y)?y:[y],e,r,o,n,i,a,l,h),c.base=e.__e,e.__h=null,c.__h.length&&a.push(c),D&&(c.__E=c.__=null),c.__e=!1}else i==null&&e.__v===r.__v?(e.__k=r.__k,e.__e=r.__e):e.__e=sr(r.__e,e,r,o,n,i,a,h);(_=P.diffed)&&_(e)}catch(m){e.__v=null,(h||i!=null)&&(e.__e=l,e.__h=!!h,i[i.indexOf(l)]=null),P.__e(m,e,r)}}function rt(t,e){P.__c&&P.__c(e,t),t.some(function(r){try{t=r.__h,r.__h=[],t.some(function(o){o.call(r)})}catch(o){P.__e(o,r.__v)}})}function sr(t,e,r,o,n,i,a,l){var h,_,c,A=r.props,x=e.props,p=e.type,g=0;if(p==="svg"&&(n=!0),i!=null){for(;g<i.length;g++)if((h=i[g])&&"setAttribute"in h==!!p&&(p?h.localName===p:h.nodeType===3)){t=h,i[g]=null;break}}if(t==null){if(p===null)return document.createTextNode(x);t=n?document.createElementNS("http://www.w3.org/2000/svg",p):document.createElement(p,x.is&&x),i=null,l=!1}if(p===null)A===x||l&&t.data===x||(t.data=x);else{if(i=i&&_e.call(t.childNodes),_=(A=r.props||fe).dangerouslySetInnerHTML,c=x.dangerouslySetInnerHTML,!l){if(i!=null)for(A={},g=0;g<t.attributes.length;g++)A[t.attributes[g].name]=t.attributes[g].value;(c||_)&&(c&&(_&&c.__html==_.__html||c.__html===t.innerHTML)||(t.innerHTML=c&&c.__html||""))}if(ir(t,x,A,n,l),c)e.__k=[];else if(g=e.props.children,Qe(t,Array.isArray(g)?g:[g],e,r,o,n&&p!=="foreignObject",i,a,i?i[0]:r.__k&&q(r,0),l),i!=null)for(g=i.length;g--;)i[g]!=null&&qe(i[g]);l||("value"in x&&(g=x.value)!==void 0&&(g!==t.value||p==="progress"&&!g||p==="option"&&g!==A.value)&&me(t,"value",g,A.value,!1),"checked"in x&&(g=x.checked)!==void 0&&g!==t.checked&&me(t,"checked",g,A.checked,!1))}return t}function ot(t,e,r){try{typeof t=="function"?t(e):t.current=e}catch(o){P.__e(o,r)}}function nt(t,e,r){var o,n;if(P.unmount&&P.unmount(t),(o=t.ref)&&(o.current&&o.current!==t.__e||ot(o,null,e)),(o=t.__c)!=null){if(o.componentWillUnmount)try{o.componentWillUnmount()}catch(i){P.__e(i,e)}o.base=o.__P=null}if(o=t.__k)for(n=0;n<o.length;n++)o[n]&&nt(o[n],e,typeof t.type!="function");r||t.__e==null||qe(t.__e),t.__e=t.__d=void 0}function ar(t,e,r){return this.constructor(t,r)}function it(t,e,r){var o,n,i;P.__&&P.__(t,e),n=(o=typeof r=="function")?null:r&&r.__k||e.__k,i=[],Se(e,t=(!o&&r||e).__k=I(ye,null,[t]),n||fe,fe,e.ownerSVGElement!==void 0,!o&&r?[r]:n?null:e.firstChild?_e.call(e.childNodes):null,i,!o&&r?r:n?n.__e:e.firstChild,o),rt(i,t)}function st(t,e){var r={__c:e="__cC"+Ke++,__:t,Consumer:function(o,n){return o.children(n)},Provider:function(o){var n,i;return this.getChildContext||(n=[],(i={})[e]=this,this.getChildContext=function(){return i},this.shouldComponentUpdate=function(a){this.props.value!==a.value&&n.some(Pe)},this.sub=function(a){n.push(a);var l=a.componentWillUnmount;a.componentWillUnmount=function(){n.splice(n.indexOf(a),1),l&&l.call(a)}}),o.children}};return r.Provider.__=r.Consumer.contextType=r}_e=je.slice,P={__e:function(t,e){for(var r,o,n;e=e.__;)if((r=e.__c)&&!r.__)try{if((o=r.constructor)&&o.getDerivedStateFromError!=null&&(r.setState(o.getDerivedStateFromError(t)),n=r.__d),r.componentDidCatch!=null&&(r.componentDidCatch(t),n=r.__d),n)return r.__E=r}catch(i){t=i}throw t}},Ze=0,or=function(t){return t!=null&&t.constructor===void 0},Y.prototype.setState=function(t,e){var r;r=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=V({},this.state),typeof t=="function"&&(t=t(V({},r),this.props)),t&&V(r,t),t!=null&&this.__v&&(e&&this.__h.push(e),Pe(this))},Y.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),Pe(this))},Y.prototype.render=ye,te=[],$e=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,pe.__r=0,Ke=0;var k=class extends Error{code;isTranslationError=!0;constructor(e,r){super(`${e} ${r}`),this.code=e}static is(e){return e?.isTranslationError===!0}};de(k,"FORMAT_UNAVAILABLE","FormatUnavailable"),de(k,"INVALID_PARAMETER","InvalidParameter"),de(k,"KEY_NOT_FOUND","KeyNotFound");function Ae(t){return t[1]??"variable"}function at(t,e){let r=t[0];return e!==void 0&&Object.prototype.hasOwnProperty.call(e,r)?""+e[r]:r}function ut(t,e){let{length:r}=e,o=Ae(t);if(t.length-2>r)throw new k(k.INVALID_PARAMETER,`too many parameters for format '${o}'`);for(let n=0;n<r;++n)e[n].call(null,t[2+n],o,n)}function ur(t,e,r){cr(t)&&Array.isArray(lr(t))||dr("a map of messages",e,r)}function cr(t){return t!==null&&typeof t=="object"}function lr(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function dr(t,e,r){throw new k(k.INVALID_PARAMETER,`expected parameter ${r+1} of format '${e}' to be ${t}`)}var hr=[ur],fr=[],pr=Object.freeze({__proto__:null,select:()=>(t,e)=>{ut(t,hr);let r=t[2];if(!r.other)throw new k(k.INVALID_PARAMETER,`messages of format '${Ae(t)}' must contain the key 'other'`);let o={};for(let n in r)o[n]=e.interpret(r[n]);return n=>(o[at(t,n)]??o.other)(n)},variable:()=>t=>(ut(t,fr),e=>at(t,e))}),L=class extends Error{input;at;isParseError=!0;constructor(e,r,o){super(e),this.input=r,this.at=o}toString(){let e=Math.max(this.input.lastIndexOf(`
`,this.at-1),0)+1,r=this.input.indexOf(`
`,this.at+1);r===-1?r=this.input.length:this.input[r-1]==="\r"&&--r;let o=`${this.input.slice(e,r)}
${" ".repeat(this.at-e)}^`;return`${this.message} at pos ${this.at}:

${o}

${this.stack}`}static is(e){return e?.isParseError===!0}};function ht(t){return t===32||t>=9&&t<=13||t===133||t===160||t===6158||t>=8192&&t<=8205||t===8232||t===8233||t===8239||t===8287||t===8288||t===12288||t===65279}function H(t,e){let{length:r}=t,o=e;for(;o<r&&ht(t.charCodeAt(o));)++o;return o}function re(t,e){let{length:r}=t,o,n=e;for(;n<r&&(o=t[n],o!=="{"&&o!=="}"&&o!==","&&o!=="#"&&o!=="'"&&o!==":"&&!ht(o.charCodeAt(0)));)++n;if(e===n)throw new L(`expected an identifier but ${o?`saw '${o}'`:"saw the end of pattern"} instead`,t,e);return t.slice(e,n)}function ct(t,e,r){let{length:o}=t,n,i=e,a=e,l="";for(;a<o&&(n=t[a],!(n==="{"||n==="}"||r&&n==="#"));){if(n==="'"){if(n=t[++a],n==="'")l+=t.slice(i,a),i=a+1;else if(n==="{"||n==="}"||r&&n==="#"){for(l+=t.slice(i,a-1),i=a;++a<o;)if(n=t[a],n==="'"){if(n=t[a+1],n!=="'")break;l+=t.slice(i,++a),i=a+1}l+=t.slice(i,a),i=++a}}++a}return l+=t.slice(i,a),l}function ft(t,e,r,o){let{length:n}=t,i={};r.push(i);let a,l=o,h=[],_=Te(t,e,h,!0);for(i[l]=h;_<n&&(_=H(t,_),a=t[_],a!==","&&a!=="}");){if(l=re(t,_),_=H(t,_+l.length),a=t[_],a!=="{")throw new L("expected '{'",t,_);h=[],_=Te(t,_+1,h,!0),i[l]=h}return _}function mr(t,e,r,o){let{length:n}=t,i={};r.push(i);let a,l=o,h=H(t,e),_=re(t,h);for(h+=_.length,i[l]=_;h<n&&(h=H(t,h),a=t[h],a!==","&&a!=="}");){if(l=re(t,h),h=H(t,h+l.length),a=t[h],a==="{")return ft(t,h+1,r,l);if(a!==":")throw new L("expected ':' or '{'",t,h);h=H(t,h+1),_=re(t,h),h+=_.length,i[l]=_}return h}function _r(t,e,r){let o=e,n=t[o];if(n==="#")return r.push("#"),o+1;if(n!=="{")throw new L("expected '#' or '{'",t,o);let{length:i}=t;do{o=H(t,o+1);let a=re(t,o);switch(o=H(t,o+a.length),n=t[o],n){case",":case"}":r.push(a);break;case"{":if(r.length<2)throw new L("expected an identifier but saw a message instead",t,o);o=ft(t,o+1,r,a),n=t[o];break;case":":if(r.length<2)throw new L("expected an identifier but saw an attribute instead",t,o);o=mr(t,o+1,r,a),n=t[o];break;default:throw new L(`unexpected character '${n}'`,t,o)}}while(o<i&&n!=="}");return o+1}function Te(t,e,r,o){let n,i=e,a=ct(t,i,o);a&&(r.push(a),i+=a.length);let{length:l}=t;for(;i<l;){if(n=t[i],n==="}"){if(!o)throw new L("unexpected '}'",t,i);++i;break}let h=[];i=_r(t,i,h),r.push(h),a=ct(t,i,o),a&&(r.push(a),i+=a.length)}return i}function lt(t){let e=[];return Te(t,0,e,!1),e}function pt(t,e,r){for(let o in t){if(o.startsWith("$"))continue;let n=t[o];switch(typeof n){case"string":e[r+o]=n;break;case"object":n!==null&&pt(n,e,`${r}${o}.`)}}return e}function yr(t){return pt(t,{},"")}function dt(t,e){let r={};for(let o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=e(t[o],o));return r}var mt=class{formatProvider;constructor(e){this.formatProvider=e}interpret(e,r){let{length:o}=e;if(o===1)return this.interpretElement(e[0],r);let n=new Array(o);for(let i=0;i<o;++i)n[i]=this.interpretElement(e[i],r);return vr.bind(null,n)}interpretElement(e,r){if(typeof e=="string")return()=>e;let o=e;if(o.length===1&&o[0]==="#"){if(r===void 0)return()=>"#";o=[r]}return this.formatProvider.getFormat(o)(o,this)}};function vr(t,e){let r="";for(let o=0;o<t.length;++o)r+=t[o](e);return r}var _t=class{formatMap;constructor(e){this.formatMap=e}getFormat(e){let r=Ae(e),o=this.formatMap[r];if(!o)throw new k(k.FORMAT_UNAVAILABLE,r);return o}},J;(function(t){t[t.Eager=0]="Eager",t[t.Lazy=1]="Lazy",t[t.Off=2]="Off"})(J||(J={}));var oe=class{cacheMode;expansions;interpreter;constructor({cacheMode:e,interpreter:r,translations:o}){this.cacheMode=e??J.Lazy,this.interpreter=r,this.expansions=yr(o),e===J.Eager&&(this.expansions=dt(this.expansions,n=>r.interpret(lt(n))))}expand(e,r){let o=this.expansions[e];if(o===void 0)throw new k(k.KEY_NOT_FOUND,e);return typeof o=="string"&&(o=this.interpreter.interpret(lt(o)),this.cacheMode!==J.Off&&(this.expansions[e]=o)),o(r)}static fromLocale(e,r=pr){let o=dt(r,(i,a)=>i(e.$format?.[a])),n=new _t(o);return new oe({cacheMode:J.Lazy,interpreter:new mt(n),translations:e})}};var gr,Z,yt;var Tt=[],vt=P.__b,gt=P.__r,xt=P.diffed,bt=P.__c,Pt=P.unmount;function xr(){for(var t;t=Tt.shift();)if(t.__P)try{t.__H.__h.forEach(ve),t.__H.__h.forEach(Ee),t.__H.__h=[]}catch(e){t.__H.__h=[],P.__e(e,t.__v)}}P.__b=function(t){Z=null,vt&&vt(t)},P.__r=function(t){gt&&gt(t),gr=0;var e=(Z=t.__c).__H;e&&(e.__h.forEach(ve),e.__h.forEach(Ee),e.__h=[])},P.diffed=function(t){xt&&xt(t);var e=t.__c;e&&e.__H&&e.__H.__h.length&&(Tt.push(e)!==1&&yt===P.requestAnimationFrame||((yt=P.requestAnimationFrame)||function(r){var o,n=function(){clearTimeout(i),St&&cancelAnimationFrame(o),setTimeout(r)},i=setTimeout(n,100);St&&(o=requestAnimationFrame(n))})(xr)),Z=null},P.__c=function(t,e){e.some(function(r){try{r.__h.forEach(ve),r.__h=r.__h.filter(function(o){return!o.__||Ee(o)})}catch(o){e.some(function(n){n.__h&&(n.__h=[])}),e=[],P.__e(o,r.__v)}}),bt&&bt(t,e)},P.unmount=function(t){Pt&&Pt(t);var e,r=t.__c;r&&r.__H&&(r.__H.__.forEach(function(o){try{ve(o)}catch(n){e=n}}),e&&P.__e(e,r.__v))};var St=typeof requestAnimationFrame=="function";function ve(t){var e=Z,r=t.__c;typeof r=="function"&&(t.__c=void 0,r()),Z=e}function Ee(t){var e=Z;t.__c=t.__(),Z=e}var Re={isLoading:!0,t:()=>""},br=st(Re),we=class extends Y{state=Re;pendingFetch;componentDidMount(){this.fetchLocale()}componentDidUpdate(e){let r=this.props;e.url!==r.url&&this.fetchLocale()}componentWillUnmount(){this.pendingFetch?.abort()}render(){return I(br.Provider,{children:this.props.children,value:this.state})}async fetchLocale(){try{this.setState(Re),this.pendingFetch=new AbortController;let{credentials:e,headers:r,url:o}=this.props,n=await fetch(o,{credentials:e,headers:r,method:"GET",signal:this.pendingFetch.signal});if(!n.ok)throw new Error(`unexpected HTTP response ${n.status} - ${n.statusText}`);let i=await n.json(),a=oe.fromLocale(i,this.props.formats);this.setState({isLoading:!1,t:Pr.bind(null,a)})}catch(e){this.props.onError?.(e),this.setState({isLoading:!1,t:()=>""})}finally{this.pendingFetch=void 0}}};function Pr(t,e,r){try{return typeof e=="string"?t.expand(e,r):t.expand(e.key,e.vars)}catch(o){let n;return n=k.is(o)?o.message:L.is(o)?"ParseError":"UnknownError",`⚠️ ${n}`}}function U(){this.t=[]}function z(){this.i=new Set,this.u=[]}function At(t){return t&&typeof t.then=="function"}function Sr(t,e,r){return new Promise((o,n)=>{let{length:i}=e,a=0,l=()=>{--a==0&&o()};for(let h=0;h<i;++h){let _=e[h].call(t,r);At(_)&&(++a,_.then(l,n))}})}function Tr(t,e,r){return new Promise((o,n)=>{let{length:i}=e,a=0,l=()=>{if(a>=i)return void o();let h=e[a++].call(t,r);At(h)?h.then(l,n):l()};l()})}U.prototype.o=null,U.prototype.h=function(){return this.o||(this.o=this.t.slice()),this.o},U.prototype.l=function(t){this.t.push(t),this.o=null},U.prototype.g=function(){return this.t.length!==0&&(this.t=[],this.o=null,!0)},U.prototype.m=function(){return this.t.length},U.prototype.P=function(t){let{t:e}=this,r,o=e.length-1;for(;o>=0&&(r=e[o],r!==t&&r.p!==t);)--o;return o!==-1&&(this.t.splice(o,1),this.o=null,!0)},U.prototype.v=function(t){let e=this.t.lastIndexOf(t);e!==-1&&(this.t.splice(e,1),this.o=null)},z.prototype.o=null,z.prototype.h=function(){return this.o||(this.o=Array.from(this.i.values()).concat(this.u)),this.o},z.prototype.l=function(t){if(t.p){if(this.i.has(t.p))return;this.u.push(t)}else this.i.add(t),this.A(t);this.o=null},z.prototype.g=function(){return!!this.m()&&(this.i.clear(),this.u=[],this.o=null,!0)},z.prototype.m=function(){return this.i.size+this.u.length},z.prototype.P=function(t){return this.i.delete(t)?(this.o=null,!0):this.A(t)},z.prototype.v=function(t){let e=this.u.lastIndexOf(t);e!==-1&&(this.u.splice(e,1),this.o=null)},z.prototype.A=function(t){let e=this.u.length-1;for(;e>=0;){if(this.u[e].p===t)return this.u.splice(e,1),this.o=null,!0;--e}return!1};var Ar={array:U,set:z};function $(t={}){let e=new(Ar[t.backend]??U),r=t.async===!0,o=r?function(n,i){let a=i?.parallel?Sr:Tr;return function(l){return a(this,n.h(),l)}}(e,t):function(n,i){return function(a){let l=n.h(),{length:h}=l;for(let _=0;_<h;++_)l[_].call(this,a)}}(e);return o.S=e,o.isAsync=r,o}function Er(t,e){let r=!1,o=function(n){if(!r)return t.S.v(o),r=!0,e.call(this,n)};o.p=e,t.S.l(o)}function ge(t,e,r){r?.once?Er(t,e):t.S.l(e)}var M={x:0,y:0};function ne(t,e){let r=t.x-e.x,o=t.y-e.y;return Math.sqrt(r*r+o*o)}function K(t,e=0,r=1){return t<e?e:t>r?r:t}function B(t){return Math.abs(t)<Number.EPSILON}var ie=class{longPress=$();multiClick=$();press=$();acceptsNewPointers=!0;longPressDelay;maxPressDistance;multiClickDelay;isPressValid=!1;longPressTimeout;multiClickCount=0;multiClickTime=0;constructor(e){this.longPressDelay=e?.longPressDelay??800,this.maxPressDistance=e?.maxPressDistance??10,this.multiClickDelay=e?.multiClickDelay??400}handlePointerDown(e,r){if(r.length>1){this.cancelPress();return}switch(this.isPressValid=!0,e.type){case"mouse":this.multiClickTick(!1);break;case"touch":case"pen":this.longPressTimeout=setTimeout(()=>this.onLongPress(),this.longPressDelay);break}}handlePointerMove(e,r){ne(e.start,e)>this.maxPressDistance&&this.cancelPress()}handlePointerUp(e,r){this.isPressValid&&(this.press(),e.type==="mouse"&&this.multiClickTick(!0)),this.cancelPress()}cancelPress(){this.longPressTimeout!==void 0&&(clearTimeout(this.longPressTimeout),this.longPressTimeout=void 0),this.isPressValid=!1}onLongPress(){this.longPressTimeout=void 0,this.longPress()}multiClickTick(e){let r=performance.now();r-this.multiClickTime>this.multiClickDelay?this.multiClickCount=0:e&&++this.multiClickCount>=2&&this.multiClick(),this.multiClickTime=r}};var Me=class extends ie{drag=$();drop=$();isDragging=!1;offset={...M};acceptsNewPointers=!0;edgeProximity;editor;pushSpeedBasis;pushSpeed={...M};start={...M};animationHandle;lastTimestamp;lastPoint={...M};constructor(e){super(e);this.editor=e.editor,this.edgeProximity=e.edgeProximity??64,this.pushSpeedBasis=e.pushSpeed??.5}handlePointerDown(e,r){super.handlePointerDown(e,r),this.acceptsNewPointers=!1,this.isDragging=!0,this.lastPoint=e,this.start=this.editor.clientToEditorSpace(e),this.offset={...M},this.startPushAnimation(e)}handlePointerMove(e,r){super.handlePointerMove(e,r),this.lastPoint=e,this.offset=this.editor.clientToEditorSpace(e),this.offset.x-=this.start.x,this.offset.y-=this.start.y,this.drag(this.offset),this.startPushAnimation(e)}handlePointerUp(e,r){super.handlePointerUp(e,r),this.acceptsNewPointers=!0,this.isDragging=!1,this.stopPushAnimation(),this.drop(this.offset)}startPushAnimation(e){this.pushSpeed.x=this.pushSpeedBasis*(K(1-(e.x-this.editor.edgeTopLeft.x)/this.edgeProximity)-K(1-(this.editor.edgeBottomRight.x-e.x)/this.edgeProximity)),this.pushSpeed.y=this.pushSpeedBasis*(K(1-(e.y-this.editor.edgeTopLeft.y)/this.edgeProximity)-K(1-(this.editor.edgeBottomRight.y-e.y)/this.edgeProximity)),!B(this.pushSpeed.x)||!B(this.pushSpeed.y)?this.animationHandle===void 0&&(this.lastTimestamp=void 0,this.animationHandle=requestAnimationFrame(this.onTick)):this.stopPushAnimation()}stopPushAnimation(){this.animationHandle!==void 0&&(cancelAnimationFrame(this.animationHandle),this.animationHandle=void 0)}onTick=e=>{let r=0;this.lastTimestamp!==void 0&&(r=e-this.lastTimestamp),this.editor.setOffset({x:this.pushSpeed.x*r,y:this.pushSpeed.y*r}),this.offset=this.editor.clientToEditorSpace(this.lastPoint),this.offset.x-=this.start.x,this.offset.y-=this.start.y,this.drag(this.offset),this.lastTimestamp=e,this.animationHandle=requestAnimationFrame(this.onTick)}};var ke=class extends ie{acceptsNewPointers=!0;editor;usePointerLock;pinchInitDistance=0;pinchInitZoom=1;didLongPress=!1;isPointerLocked=!1;constructor(e){super(e);this.editor=e.editor,this.usePointerLock=e.usePointerLock??!1,this.usePointerLock&&document.addEventListener("pointerlockchange",this.onPointerLockChange)}dispose(){this.usePointerLock&&document.removeEventListener("pointerlockchange",this.onPointerLockChange)}handlePointerDown(e,r){if(super.handlePointerDown(e,r),this.usePointerLock&&r.length===1&&e.type==="mouse"&&this.editor.canvas?.requestPointerLock(),r.length===2){let[o,n]=r;this.pinchInitDistance=ne(o,n),this.pinchInitZoom=this.editor.zoom,this.acceptsNewPointers=!1}}handlePointerMove(e,r){if(super.handlePointerMove(e,r),!this.didLongPress)if(r.length===2){let o=r[1]===e?r[0]:r[1],n=ne(e,o);this.editor.setZoom(this.pinchInitZoom*n/this.pinchInitDistance,{x:(e.x+o.x)/2,y:(e.y+o.y)/2},!1),this.editor.setOffset({x:(e.x+o.x)/2-(e.x-e.delta.x+o.x)/2,y:(e.y+o.y)/2-(e.y-e.delta.y+o.y)/2})}else this.editor.setOffset({x:e.delta.x,y:e.delta.y})}handlePointerUp(e,r){super.handlePointerUp(e,r),this.acceptsNewPointers=!0,r.length===1&&(this.didLongPress=!1),this.isPointerLocked&&document.exitPointerLock()}onLongPress(){super.onLongPress(),this.didLongPress=!0}onPointerLockChange=()=>{this.isPointerLocked=document.pointerLockElement===this.editor.canvas}};var Et=window.devicePixelRatio||1,De=class extends Y{zoom;offset={...M};canvas=null;edgeTopLeft={...M};edgeBottomRight={...M};canvasCssClass;pointers=[];rawOffset={...M};rawZoom;gesture=null;frameHandle;observer;constructor(e,r){super(e,r);let o=Math.max((e.minZoom+e.maxZoom)/2,Number.EPSILON);this.zoom=o,this.rawZoom=o}componentDidMount(){let e={passive:!0};window.addEventListener("pointermove",this.onPointerMove,e),window.addEventListener("pointerup",this.onPointerLost,e),window.addEventListener("pointercancel",this.onPointerLost,e)}componentWillUnmount(){window.removeEventListener("pointermove",this.onPointerMove),window.removeEventListener("pointerup",this.onPointerLost),window.removeEventListener("pointercancel",this.onPointerLost),this.observer?.disconnect(),this.observer=void 0,this.frameHandle!==void 0&&(cancelAnimationFrame(this.frameHandle),this.frameHandle=void 0)}shouldComponentUpdate(){return!1}render(){return I("canvas",{class:this.canvasCssClass,onContextMenu:Rt,onLostPointerCapture:this.onPointerLost,onPointerDown:this.onPointerDown,onWheel:this.onWheel,ref:this.onCanvasRef})}updateView(){this.frameHandle??=requestAnimationFrame(this.onFrame)}clientToEditorSpace(e){return{x:(e.x-(this.edgeTopLeft.x+this.edgeBottomRight.x)/2-this.offset.x)/this.zoom,y:(e.y-(this.edgeTopLeft.y+this.edgeBottomRight.y)/2-this.offset.y)/this.zoom}}getVisibleRect(){return{topLeft:this.clientToEditorSpace(this.edgeTopLeft),bottomRight:this.clientToEditorSpace(this.edgeBottomRight)}}setOffset(e,r=!0){this.rawOffset.x=(r?this.rawOffset.x:0)+e.x,this.rawOffset.y=(r?this.rawOffset.y:0)+e.y;let o=this.getOffsetAdjustment(this.rawOffset);(!B(o.x-this.offset.x)||!B(o.y-this.offset.y))&&(this.offset.x=o.x,this.offset.y=o.y,this.updateView())}setZoom(e,r,o=!0){this.rawZoom=K((o?this.rawZoom:0)+e,Math.max(this.props.minZoom,Number.EPSILON),this.props.maxZoom);let n=this.getZoomAdjustment(this.rawZoom),i=this.zoom-n;if(B(i))return;let a=this.clientToEditorSpace(r);this.setOffset({x:i*a.x,y:i*a.y}),this.zoom=n,this.updateView()}getOffsetAdjustment(e){return e}getZoomAdjustment(e){return e}getWheelDeltaAdjustment(e){return 1}updateLayout(e=this.canvas.getBoundingClientRect()){this.edgeTopLeft.y=e.top,this.edgeTopLeft.x=e.left,this.edgeBottomRight.y=e.bottom,this.edgeBottomRight.x=e.right}onPointerDown=e=>{if(this.gesture===null&&(this.updateLayout(),this.gesture=this.hitTest(this.clientToEditorSpace(e),e)),this.gesture?.acceptsNewPointers===!0){let r={id:e.pointerId,type:e.pointerType,delta:{...M},start:{x:e.x,y:e.y},x:e.x,y:e.y};this.pointers.push(r),this.gesture.handlePointerDown(r,this.pointers)}};onPointerMove=e=>{let r=this.pointers.find(({id:o})=>e.pointerId===o);!r||(r.delta.x=e.movementX/Et,r.delta.y=e.movementY/Et,B(r.x-e.x)&&B(r.y-e.y)?(r.sumMovement??={...M},r.sumMovement.x+=r.delta.x,r.sumMovement.y+=r.delta.y,r.x=r.start.x+r.sumMovement.x,r.y=r.start.y+r.sumMovement.y):(r.x=e.x,r.y=e.y),this.gesture.handlePointerMove(r,this.pointers))};onPointerLost=e=>{let r=this.pointers.findIndex(({id:n})=>e.pointerId===n);if(r===-1)return;let o=this.pointers[r];o.x=e.x,o.y=e.y,this.gesture.handlePointerUp(o,this.pointers),this.pointers.splice(r,1),this.pointers.length===0&&(this.gesture=null)};onWheel=e=>{Rt(e);let r=-this.getWheelDeltaAdjustment(e);e.ctrlKey?(r/=(this.edgeBottomRight.y-this.edgeTopLeft.y)/3,this.setZoom(e.deltaY*r,e)):this.setOffset({x:(e.shiftKey?e.deltaY:e.deltaX)*r,y:(e.shiftKey?e.deltaX:e.deltaY)*r})};onCanvasRef=e=>{let r=this.canvas;r&&this.observer.unobserve(r),e&&(this.canvasAcquired(e),this.observer??=new ResizeObserver(this.onResizeObserved),this.observer.observe(e,{box:"content-box"})),this.canvas=e};onResizeObserved=e=>{let r=e[0].contentRect;this.updateLayout(r),this.canvasResized(r.width,r.height),this.updateView()};onFrame=()=>{this.frameHandle=this.canvasRender()?requestAnimationFrame(this.onFrame):void 0}};function Rt(t){t.preventDefault(),t.stopImmediatePropagation()}function X(t){return[(t>>16&255)/255,(t>>8&255)/255,(t&255)/255]}function Q(t,e){let r=t.createProgram();for(let o of e.shaders){let n=wr(t,o);t.attachShader(r,n)}if(t.linkProgram(r),!t.getProgramParameter(r,t.LINK_STATUS))throw new Error(`Error linking program:
`+t.getProgramInfoLog(r));return{ref:r,attributes:wt(e.attributes,o=>t.getAttribLocation(r,o)),uniforms:wt(e.uniforms,o=>t.getUniformLocation(r,o))}}function wr(t,e){let r=t.createShader(e.type);if(t.shaderSource(r,e.source),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS)){let o={[t.VERTEX_SHADER]:"vertex",[t.FRAGMENT_SHADER]:"fragment"}[e.type]||"a";throw new Error(`Error compiling ${o} shader:
${t.getShaderInfoLog(r)}`)}return r}function wt(t,e){let r={};for(let o of t)r[o]=e(o);return r}var Ct=`#version 300 es
precision mediump float;

in vec2 vGridPosition;

layout(location = 0) out vec4 fragColor;

uniform float uGridSize;
uniform vec3 uBackgroundColor;
uniform vec3 uGridlineColor;

void main() {
	// Flooring to strictly align to one side, avoiding double-width or disjoint gridlines.
	float halfSize = floor(uGridSize / 2.0);
	float gridlineDist = min(
		abs(floor(mod(vGridPosition[0], uGridSize) - halfSize)),
		abs(floor(mod(vGridPosition[1], uGridSize) - halfSize))
	);

	fragColor = vec4(mix(uBackgroundColor, uGridlineColor, float(gridlineDist == 0.0)), 1.0);
}
`;var Mt=`#version 300 es

in vec2 aClipPosition;

out vec2 vGridPosition;

uniform vec2 uScreenSize;
uniform vec2 uGridOffset;

void main() {
	gl_Position = vec4(aClipPosition, 0.0, 1.0);

	// Assuming that aClipPosition is +1 xor -1 and uGridOffset is an integer,
	// the final vGridPosition vector will have integer coordinates.
	vec2 mapping = vec2(
		(aClipPosition[0] * -0.5) + 0.5,
		(aClipPosition[1] *  0.5) + 0.5
	);

	vec2 offset = vec2(
		floor(uScreenSize[0] * 0.5),
		floor(uScreenSize[1] * 0.5)
	);

	vGridPosition = uScreenSize * mapping - offset + uGridOffset;
}
`;function kt(t,e){let r=Q(t,{shaders:[{source:Mt,type:t.VERTEX_SHADER},{source:Ct,type:t.FRAGMENT_SHADER}],attributes:["aClipPosition"],uniforms:["uScreenSize","uGridOffset","uGridSize","uBackgroundColor","uGridlineColor"]}),o=t.createVertexArray();t.bindVertexArray(o);let n=t.createBuffer(),i=new Int8Array([-1,-1,1,-1,-1,1,1,1]);t.bindBuffer(t.ARRAY_BUFFER,n),t.bufferData(t.ARRAY_BUFFER,i,t.STATIC_READ),t.enableVertexAttribArray(r.attributes.aClipPosition),t.vertexAttribPointer(r.attributes.aClipPosition,2,t.BYTE,!1,0,0);let a=X(e.backgroundColor),l=X(e.gridlineColor);return{render(h){t.useProgram(r.ref),t.bindVertexArray(o),t.uniform2fv(r.uniforms.uScreenSize,[t.drawingBufferWidth,t.drawingBufferHeight]),t.uniform2fv(r.uniforms.uGridOffset,[h.gridOffset.x,h.gridOffset.y]),t.uniform1f(r.uniforms.uGridSize,h.gridSize),t.uniform3fv(r.uniforms.uBackgroundColor,a),t.uniform3fv(r.uniforms.uGridlineColor,l),t.drawArrays(t.TRIANGLE_STRIP,0,4)}}}var W=class{duration;easing;keys;map=new Map;zeroState;transitionCount=0;constructor(e){let r={};for(let o=0;o<e.keys.length;++o)r[e.keys[o]]=0;Object.assign(this,e),this.zeroState=r}get hasTransitions(){return this.transitionCount>0}add(e,r,o=W.now(),n){let i=0;for(;i<this.keys.length&&B(r[this.keys[i]]);)++i;if(i===this.keys.length)return;let a=this.map.get(e);a||this.map.set(e,a=[]),++this.transitionCount,a.push({...r,$duration:n??this.duration,$startTime:o})}getFrame(e,r=W.now()){let o=this.map.get(e);if(!o)return this.zeroState;let{keys:n}=this,i={};for(let l=0;l<n.length;++l)i[n[l]]=0;let a=0;for(;a<o.length;){let l=o[a],h=1-(r-l.$startTime)/l.$duration;if(h<=0){o.splice(a,1),--this.transitionCount;continue}h=this.easing(h);for(let _=0;_<n.length;++_){let c=n[_];i[c]+=l[c]*h}++a}return o.length===0&&this.map.delete(e),i}static now(){return performance.now()}};function Dt(t){return{ref:t.createBuffer(),size:0}}var se=class{constructor(e,r){this.alloc=e;this.growthFactor=r?.growthFactor??1.618034,this.data=e(r?.initialCapacity??0)}data;growthFactor;usedCapacity=0;resize(e,r=!0){this.usedCapacity=e;let o=Math.max(this.data.length,1);if(e<o)return!1;let n=Math.ceil(Math.log(e/o)/Math.log(this.growthFactor)),i=Math.trunc(o*this.growthFactor**n),a=this.data;return this.data=this.alloc(i),r&&this.data.set(a),!0}commit(e,r){let o=r;o?.ref||(o={ref:r,size:e.getBufferParameter(e.ARRAY_BUFFER,e.BUFFER_SIZE)}),e.bindBuffer(e.ARRAY_BUFFER,o.ref);let n=this.usedCapacity*this.data.BYTES_PER_ELEMENT;o.size<n?(e.bufferData(e.ARRAY_BUFFER,this.data,e.DYNAMIC_READ),o.size=this.data.byteLength):e.bufferSubData(e.ARRAY_BUFFER,0,this.data,0,this.usedCapacity)}static createFloat32(e){return new se(r=>new Float32Array(r),e)}};var Gt=`#version 300 es
precision mediump float;

in vec2 vTexPos;
in vec4 vColor;

layout(location = 0) out vec4 fragColor;

uniform sampler2D uShapes;
uniform vec3 uDefaultStrokeColor;
uniform vec3 uSelectedStrokeColor;

void main() {
	vec4 shape = texture(uShapes, vTexPos);
	vec3 stroke = mix(uDefaultStrokeColor, uSelectedStrokeColor, vColor.w);

	fragColor = vec4(
		mix(stroke, vColor.xyz, shape.y),
		shape.x
	);
}
`;var Lt=`#version 300 es

// shared:
in vec2 aCellPos;

// per-instance:
in vec2 aGridPos;
in float aColor;
in float aTexIndex;

out vec2 vTexPos;
out vec4 vColor;

uniform mat3x2 uViewMatrix;
uniform float uTexDiv;

void main() {
	gl_Position = vec4(
		uViewMatrix * vec3(
			aCellPos[0] + aGridPos[0],
			aCellPos[1] - aGridPos[1],
			1.0
		),
		0.0,
		1.0
	);

	float size = 1.0 / uTexDiv;
	float halfSize = size * 0.5;
	vTexPos = vec2(
		  mod(aTexIndex,  uTexDiv) / uTexDiv + aCellPos[0] * size + halfSize,
		floor(aTexIndex / uTexDiv) / uTexDiv - aCellPos[1] * size + halfSize
	);

	highp uint rgb = uint(aColor);
	vColor = vec4(
		float((rgb >> 16u) & 255u) / 255.0,
		float((rgb >>  8u) & 255u) / 255.0,
		float( rgb         & 255u) / 255.0,

		// w is used to swap between stroke colors
		float((rgb >> 24u) & 255u) / 255.0
	);
}
`;function Gr(t,e){let r=Math.ceil(Math.sqrt(t.length)),o=r*e,n=new OffscreenCanvas(o,o),i=n.getContext("2d",{alpha:!1,desynchronized:!0,willReadFrequently:!1});if(!i)throw new Error("Could not obtain offscreen 2D rendering context.");i.clearRect(0,0,o,o);let a=e/2;for(let l=0;l<t.length;++l)t[l](i,a+l%r*e,a+Math.trunc(l/r)*e,a);return{source:n,divisions:r}}function Lr(t,e,r,o,n){e.fillStyle="#ffff00",e.strokeStyle="#ff0000",e.lineWidth=Math.max(1,n/12),e.beginPath(),e.moveTo(Math.round(r+t[0]*n),Math.round(o+t[1]*n));let i=2;for(;i<t.length;)e.lineTo(Math.round(r+t[i++]*n),Math.round(o+t[i++]*n));e.closePath(),e.fill(),e.stroke()}function Bt(t,e){let r=[];for(let o=0;o<t.length;++o)r.push(Lr.bind(null,t[o]));return Gr(r,e)}function Nt(t,e){let r=Q(t,{shaders:[{source:Lt,type:t.VERTEX_SHADER},{source:Gt,type:t.FRAGMENT_SHADER}],attributes:["aCellPos","aGridPos","aColor","aTexIndex"],uniforms:["uViewMatrix","uTexDiv","uShapes","uDefaultStrokeColor","uSelectedStrokeColor"]}),o=t.createVertexArray();t.bindVertexArray(o);let n=t.createBuffer(),i=new Float32Array([-.5,-.5,.5,-.5,-.5,.5,.5,.5]);t.bindBuffer(t.ARRAY_BUFFER,n),t.bufferData(t.ARRAY_BUFFER,i,t.STATIC_READ),t.enableVertexAttribArray(r.attributes.aCellPos),t.vertexAttribPointer(r.attributes.aCellPos,2,t.FLOAT,!1,0,0),t.vertexAttribDivisor(r.attributes.aCellPos,0);let a=Dt(t),l=se.createFloat32();t.bindBuffer(t.ARRAY_BUFFER,a.ref),t.enableVertexAttribArray(r.attributes.aGridPos),t.vertexAttribPointer(r.attributes.aGridPos,2,t.FLOAT,!1,16,0),t.vertexAttribDivisor(r.attributes.aGridPos,1),t.enableVertexAttribArray(r.attributes.aColor),t.vertexAttribPointer(r.attributes.aColor,1,t.FLOAT,!1,16,8),t.vertexAttribDivisor(r.attributes.aColor,1),t.enableVertexAttribArray(r.attributes.aTexIndex),t.vertexAttribPointer(r.attributes.aTexIndex,1,t.FLOAT,!1,16,12),t.vertexAttribDivisor(r.attributes.aTexIndex,1);let h=Bt(e.shapes,e.shapeResolution),_=t.createTexture();t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,_),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.RGB,t.RGB,t.UNSIGNED_BYTE,h.source);let c=X(e.defaultStrokeColor),A=X(e.selectedStrokeColor);return{render(x){let{dragging:p,nodes:g,selectedIds:D,transitions:s}=x,u=p?.mode===1,d=g.length+(u?p.nodes.length:0);if(d===0)return;t.useProgram(r.ref),t.bindVertexArray(o),l.resize(d*4,!1);let{data:y}=l,f=W.now(),m=0,v=(C,N,O=M)=>{let F=s.getFrame(C.id,f);y[m++]=C.x+O.x+F.x,y[m++]=C.y+O.y+F.y,y[m++]=(C.color??16777215)+(N?4278190080:0),y[m++]=C.shapeIndex??0};for(let C=0;C<g.length;++C)v(g[C],!u&&D.has(g[C].id));u&&p.nodes.forEach(C=>v(C,!0,p.offset)),l.commit(t,a);let b=t.drawingBufferWidth/2,S=t.drawingBufferHeight/2,T=x.gridSize/b,R=x.gridSize/S,E=x.gridOffset.x/b,w=-x.gridOffset.y/S;t.uniform1i(r.uniforms.uShapes,0),t.uniform1f(r.uniforms.uTexDiv,h.divisions),t.uniform3fv(r.uniforms.uDefaultStrokeColor,c),t.uniform3fv(r.uniforms.uSelectedStrokeColor,A),t.uniformMatrix3x2fv(r.uniforms.uViewMatrix,!1,[T,0,0,R,E,w]),t.drawArraysInstanced(t.TRIANGLE_STRIP,0,4,d)}}}var Ot=`#version 300 es
precision mediump float;

layout(location = 0) out vec4 fragColor;

uniform vec3 uSelectedStrokeColor;
uniform float uDashSize;

void main() {
	float xMod = mod(gl_FragCoord[0], 2.0 * uDashSize);
	float yMod = mod(gl_FragCoord[1], 2.0 * uDashSize);
	float alpha = float(
		(xMod < uDashSize && yMod < uDashSize) ||
		(xMod > uDashSize && yMod > uDashSize)
	);

	fragColor = vec4(uSelectedStrokeColor, alpha);
}
`;var Ft=`#version 300 es

in vec2 aClipPos;

void main() {
	gl_Position = vec4(aClipPos, 0.0, 1.0);
}
`;function zt(t,e){let r=Q(t,{shaders:[{source:Ft,type:t.VERTEX_SHADER},{source:Ot,type:t.FRAGMENT_SHADER}],attributes:["aClipPos"],uniforms:["uSelectedStrokeColor","uDashSize"]}),o=t.createVertexArray();t.bindVertexArray(o);let n=t.createBuffer(),i=new Float32Array(8);t.bindBuffer(t.ARRAY_BUFFER,n),t.bufferData(t.ARRAY_BUFFER,i,t.STATIC_READ),t.enableVertexAttribArray(r.attributes.aClipPos),t.vertexAttribPointer(r.attributes.aClipPos,2,t.FLOAT,!1,0,0);let a=X(e.selectedStrokeColor);return{render({gridOffset:l,gridSize:h,dragging:_}){if(_?.mode!==0)return;t.useProgram(r.ref),t.bindVertexArray(o);let c=t.drawingBufferWidth/2,A=t.drawingBufferHeight/2,x=(D,s,u)=>{i[u]=(D*h+l.x)/c,i[u+1]=-(s*h+l.y)/A},p=_.start,g=_.offset;x(p.x,p.y,0),x(p.x+g.x,p.y,2),x(p.x+g.x,p.y+g.y,4),x(p.x,p.y+g.y,6),t.bindBuffer(t.ARRAY_BUFFER,n),t.bufferSubData(t.ARRAY_BUFFER,0,i),t.uniform1f(r.uniforms.uDashSize,h/4),t.uniform3fv(r.uniforms.uSelectedStrokeColor,a),t.drawArrays(t.LINE_LOOP,0,4)}}}function Ut(t,e){let r=t.getContext("webgl2",{alpha:!1,antialias:!1,depth:!1,desynchronized:!0,failIfMajorPerformanceCaveat:!0,powerPreference:"high-performance",premultipliedAlpha:!1,preserveDrawingBuffer:!1,stencil:!1});if(!r)throw new Error("Could not obtain WebGL rendering context.");r.enable(r.BLEND),r.blendFunc(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA);let o=kt(r,e),n=Nt(r,e),i=zt(r,e);return{render(a){o.render(a),n.render(a),i.render(a)},resize(a,l){t.width===a&&t.height===l||(t.width=a,t.height=l,r.viewport(0,0,r.drawingBufferWidth,r.drawingBufferHeight))}}}var j=window.devicePixelRatio||1,Ge=class extends De{canvasCssClass="graph-editor";dragGesture;panAndZoomGesture;selectedIds=new Set;transitions=new W({duration:300,easing:e=>e**5,keys:["x","y"]});dragging;renderer;constructor(e){super(e);this.dragGesture=new Me({editor:this}),this.panAndZoomGesture=new ke({editor:this,usePointerLock:!0}),ge(this.dragGesture.drag,this.onDragMove),ge(this.dragGesture.drop,this.onDragDrop),ge(this.panAndZoomGesture.press,this.onVoidPress)}componentWillUnmount(){super.componentWillUnmount(),this.renderer=void 0}canvasAcquired(e){this.renderer=Ut(e,{backgroundColor:this.props.backgroundColor,gridlineColor:this.props.gridlineColor,defaultStrokeColor:this.props.defaultStrokeColor,selectedStrokeColor:this.props.selectedStrokeColor,shapes:this.props.shapes,shapeResolution:Math.round(this.props.maxZoom*this.props.gridSize*j)})}canvasResized(e,r){this.renderer.resize(Math.round(e*j),Math.round(r*j))}canvasRender(){let e=this.getVisibleRect(),r=this.editorToGridSpace(e.topLeft),o=this.editorToGridSpace(e.bottomRight);return this.renderer.render({gridSize:Math.round(this.zoom*this.props.gridSize*j),gridOffset:{x:Math.round(this.offset.x*j),y:Math.round(this.offset.y*j)},nodes:this.props.graph.getNodesWithin(r.x,r.y,o.x,o.y),selectedIds:this.selectedIds,transitions:this.transitions,dragging:this.dragging}),this.transitions.hasTransitions}hitTest(e,r){let o=this.editorToGridSpace(e),{graph:n}=this.props;if(r.ctrlKey)return this.dragging={mode:0,start:o.raw,offset:{...M}},this.updateView(),this.dragGesture;let i=n.getNodeAt(o.x,o.y);if(i){let a;return this.selectedIds.has(i.id)?a=Array.from(this.selectedIds).map(l=>n.getNodeById(l)):(a=[i],this.selectedIds.clear(),this.selectedIds.add(i.id)),this.dragging={mode:1,offset:{...M},nodes:a},a.forEach(l=>n.beginMoveNode(l)),this.dragGesture}return this.panAndZoomGesture}getZoomAdjustment(e){let r=this.props.gridSize*j/2;return Math.round(e*r)/r}getWheelDeltaAdjustment(e){switch(e.deltaMode){case WheelEvent.DOM_DELTA_PAGE:return this.edgeBottomRight.y-this.edgeTopLeft.y;case WheelEvent.DOM_DELTA_LINE:return this.props.gridSize;default:return 1}}editorToGridSpace(e){let r={x:e.x/this.props.gridSize,y:e.y/this.props.gridSize},o=Math.round(r.x),n=Math.round(r.y);return{x:o,y:n,raw:r,frac:{x:r.x-o,y:r.y-n}}}onVoidPress=()=>{this.selectedIds.size>0&&(this.selectedIds.clear(),this.updateView())};onDragMove=e=>{this.dragging.offset=this.editorToGridSpace(e).raw,this.updateView()};onDragDrop=e=>{let r=this.editorToGridSpace(e),o=this.dragging;switch(o.mode){case 1:o.nodes.forEach(n=>this.moveNode(n,r));break;case 0:{let{start:n,offset:i}=o,a=this.props.graph.getNodesWithin(Math.round(Math.min(n.x,n.x+i.x)),Math.round(Math.min(n.y,n.y+i.y)),Math.round(Math.max(n.x,n.x+i.x)),Math.round(Math.max(n.y,n.y+i.y)));this.selectedIds.clear(),a.forEach(l=>this.selectedIds.add(l.id));break}}this.dragging=void 0,this.updateView()};moveNode(e,r){let{graph:o}=this.props;o.getClearance(e.x+r.x,e.y+r.y).forEach(n=>{o.beginMoveNode(n.node),o.endMoveNodeUnsafe(n.node,n.node.x+n.movementX,n.node.y+n.movementY),this.transitions.add(n.node.id,{x:-n.movementX,y:-n.movementY})}),o.endMoveNodeUnsafe(e,e.x+r.x,e.y+r.y),this.transitions.add(e.id,r.frac)}};var Nr=[.68,0,.657,-.176,.589,-.34,.481,-.481,.34,-.589,.176,-.657,0,-.68,-.176,-.657,-.34,-.589,-.481,-.481,-.589,-.34,-.657,-.176,-.68,-0,-.657,.176,-.589,.34,-.481,.481,-.34,.589,-.176,.657,-0,.68,.176,.657,.34,.589,.481,.481,.589,.34,.657,.176],Or=[.68,-.68,-.68,-.68,-.68,.68,.68,.68],Fr=[.8,0,0,-.8,-.8,-0,-0,.8],zr=[.8,-.68,-.8,-.68,-0,.68],Ur=[.462,0,.693,-.4,.231,-.4,0,-.8,-.231,-.4,-.693,-.4,-.462,-0,-.693,.4,-.231,.4,-0,.8,.231,.4,.693,.4],Le=[Nr,Or,Fr,zr,Ur];var ae=class{constructor(e){this.alphabet=e;let r=e.length;if(r===0)throw new Error("Alphabet cannot be empty.");if((r&r-1)!==0)throw new Error("Alphabet length must be a power of two.");this.shift=Math.trunc(Math.log(r)/Math.LN2),this.mask=Math.trunc(r-1)}shift;mask;index=0;next(){let e="",r=this.index++;do e=this.alphabet[r&this.mask]+e,r>>=this.shift;while(r>0);return e}static createBase32(){return new ae("0123456789abcdefghijklmnopqrstuv")}};var Ne=rr(Vt());var Oe=class extends Ne.default{toBBox({x:e,y:r}){return{minX:e,minY:r,maxX:e,maxY:r}}compareMinX(e,r){return e.x-r.x}compareMinY(e,r){return e.y-r.y}};var Fe=[[1,0],[0,-1],[-1,0],[0,1]];function ue(t,e){if(!t)return!1;let r=t.indexOf(e);return r===-1?!1:(t.splice(r,1),!0)}function ze(t,e,r,o){return{maxX:r+Number.EPSILON,minX:t-Number.EPSILON,maxY:o+Number.EPSILON,minY:e-Number.EPSILON}}var Ue=class{identity;edges=new Set;nodes=new Map;space=new Oe;constructor(e){this.identity=e.identity}createNodeUnsafe(e,r){let o={id:this.identity.next(),x:e,y:r};return this.nodes.set(o.id,o),this.space.insert(o),o}beginMoveNode(e){this.space.remove(e)}endMoveNodeUnsafe(e,r,o){e.x=r,e.y=o,this.space.insert(e)}removeNode(e){if(!this.nodes.delete(e.id))return!1;if(e.incoming)for(let r of e.incoming)this.edges.delete(r),ue(r.source.outgoing,r);if(e.outgoing)for(let r of e.outgoing)this.edges.delete(r),ue(r.destination.incoming,r);return this.space.remove(e),!0}connect(e,r){let o=e.outgoing,n=r.incoming,i=o&&n&&(o.length<n.length?o.find(a=>a.destination===r):n.find(a=>a.source===e));return i||(i={source:e,destination:r},(e.outgoing??=[]).push(i),(r.incoming??=[]).push(i),this.edges.add(i)),i}removeEdge(e){return this.edges.delete(e)?(ue(e.source.outgoing,e),ue(e.destination.incoming,e),!0):!1}getNodeById(e){return this.nodes.get(e)??null}getNodeAt(e,r){let o=this.space.search(ze(e,r,e,r));return o.length>0?o[0]:null}getNodesWithin(e,r,o,n){return this.space.search(ze(e,r,o,n))}getClearance(e,r){let o=this.getNodeAt(e,r);if(!o)return[];let n=Fe.length,i=new Array(n);for(let c=0;c<n;++c)i[c]=[o];let a,l=1,h,_;do{a=0;do h=Fe[a],_=this.getNodeAt(e+h[0]*l,r+h[1]*l);while(_&&(i[a].push(_),++a<n));++l}while(_);return i[a].reverse().map(c=>({node:c,movementX:h[0],movementY:h[1]}))}};var Ve=new Ue({identity:ae.createBase32()});function xe(t,e){return Math.round(t+Math.random()*(e-t))}var Ht=1e5,be=Math.sqrt(Ht)*2,Yt=0;for(;Yt<Ht;){let t=xe(-be,be),e=xe(-be,be);if(Ve.getNodeAt(t,e))continue;let r=Ve.createNodeUnsafe(t,e);r.color=xe(0,16777215),r.shapeIndex=xe(0,Le.length),++Yt}var Xt=()=>I(we,{url:"./locale/en.json"},I(Ge,{graph:Ve,gridSize:32,backgroundColor:2763306,gridlineColor:3815994,defaultStrokeColor:0,selectedStrokeColor:16777215,shapes:Le,minZoom:.5,maxZoom:2}));it(I(Xt,null),document.getElementById("root"));})();
//# sourceMappingURL=index.js.map
